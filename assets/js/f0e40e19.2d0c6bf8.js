"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[97697],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>d});var t=s(96540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}},97817:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"skills/admin_dashboard/index","title":"\ud83d\ude80 Admin Dashboard","description":"Extend and modify the admin dashboard, developer portal, and operations console. Use when adding new admin tabs, metrics, monitoring features, or internal tools. Activates for dashboard development, analytics, user management, and internal tooling.","source":"@site/docs/skills/admin_dashboard/index.md","sourceDirName":"skills/admin_dashboard","slug":"/skills/admin_dashboard/","permalink":"/docs/skills/admin_dashboard/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Admin Dashboard","sidebar_position":1}}');var r=s(74848),i=s(28453);const a={sidebar_label:"Admin Dashboard",sidebar_position:1},d="\ud83d\ude80 Admin Dashboard",l={},c=[{value:"Allowed Tools",id:"allowed-tools",level:2},{value:"Tags",id:"tags",level:2},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Current Admin Dashboard Structure",id:"current-admin-dashboard-structure",level:2},{value:"Existing Tabs",id:"existing-tabs",level:3},{value:"Planned Tabs (from design)",id:"planned-tabs-from-design",level:3},{value:"Adding a New Admin Tab",id:"adding-a-new-admin-tab",level:2},{value:"1. Create the Tab Content Component",id:"1-create-the-tab-content-component",level:3},{value:"2. Add the Tab to the Tab List",id:"2-add-the-tab-to-the-tab-list",level:3},{value:"3. Add the Tab Content Renderer",id:"3-add-the-tab-content-renderer",level:3},{value:"Creating Admin API Endpoints",id:"creating-admin-api-endpoints",level:2},{value:"Pattern: Admin Stats Endpoint",id:"pattern-admin-stats-endpoint",level:3},{value:"Key Patterns",id:"key-patterns",level:2},{value:"StatCard Component",id:"statcard-component",level:3},{value:"Data Fetching Pattern",id:"data-fetching-pattern",level:3},{value:"HIPAA-Safe Error Display",id:"hipaa-safe-error-display",level:3},{value:"Database Tables for Admin Features",id:"database-tables-for-admin-features",level:2},{value:"Access Control",id:"access-control",level:2},{value:"Testing Admin Features",id:"testing-admin-features",level:2},{value:"Design Resources",id:"design-resources",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"-admin-dashboard",children:"\ud83d\ude80 Admin Dashboard"})}),"\n",(0,r.jsx)(n.p,{children:"Extend and modify the admin dashboard, developer portal, and operations console. Use when adding new admin tabs, metrics, monitoring features, or internal tools. Activates for dashboard development, analytics, user management, and internal tooling."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"allowed-tools",children:"Allowed Tools"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Read, Write, Edit, Bash(npm:*, npx:*)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"tags",children:"Tags"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"dashboard"})," ",(0,r.jsx)(n.code,{children:"admin"})," ",(0,r.jsx)(n.code,{children:"internal-tools"})]}),"\n",(0,r.jsx)(n.h1,{id:"admin--developer-suite-development",children:"Admin & Developer Suite Development"}),"\n",(0,r.jsx)(n.p,{children:"This skill helps you extend the admin dashboard and build internal tools following the established patterns."}),"\n",(0,r.jsx)(n.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"/admin     - Admin Dashboard (user metrics, access control, audit)\n/dev       - Developer Portal (docs, code browser, feature map) [PLANNED]\n/ops       - Operations Console (infrastructure, logs, incidents) [PLANNED]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.code,{children:"docs/ADMIN-DEVELOPER-SUITE.md"})," for the full design specification."]}),"\n",(0,r.jsx)(n.h2,{id:"current-admin-dashboard-structure",children:"Current Admin Dashboard Structure"}),"\n",(0,r.jsxs)(n.p,{children:["Location: ",(0,r.jsx)(n.code,{children:"src/app/admin/page.tsx"})]}),"\n",(0,r.jsx)(n.h3,{id:"existing-tabs",children:"Existing Tabs"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Tab"}),(0,r.jsx)(n.th,{children:"Purpose"}),(0,r.jsx)(n.th,{children:"Data Source"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Overview"}),(0,r.jsx)(n.td,{children:"Quick stats (users, check-ins, messages)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/admin/stats"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Funnel"}),(0,r.jsx)(n.td,{children:"User engagement waterfall"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/admin/stats"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Page Views"}),(0,r.jsx)(n.td,{children:"Analytics by page path"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/admin/stats"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Users"}),(0,r.jsx)(n.td,{children:"User roster with activity"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/admin/stats"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Access Requests"}),(0,r.jsx)(n.td,{children:"Pending/approved/denied requests"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/admin/access-requests"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Allowed Emails"}),(0,r.jsx)(n.td,{children:"Email whitelist management"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/admin/allowed-emails"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Email Templates"}),(0,r.jsx)(n.td,{children:"Preview system emails"}),(0,r.jsx)(n.td,{children:"Local data"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"planned-tabs-from-design",children:"Planned Tabs (from design)"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Tab"}),(0,r.jsx)(n.th,{children:"Purpose"}),(0,r.jsx)(n.th,{children:"Status"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Production Health"}),(0,r.jsx)(n.td,{children:"API latency, Core Web Vitals"}),(0,r.jsx)(n.td,{children:"Pending"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Error Tracking"}),(0,r.jsx)(n.td,{children:"HIPAA-safe error aggregation"}),(0,r.jsx)(n.td,{children:"Pending"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"External Services"}),(0,r.jsx)(n.td,{children:"Anthropic, DB, Push status"}),(0,r.jsx)(n.td,{children:"Pending"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"AI Analytics"}),(0,r.jsx)(n.td,{children:"Conversation metrics, tokens"}),(0,r.jsx)(n.td,{children:"Pending"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Audit Logs"}),(0,r.jsx)(n.td,{children:"HIPAA compliance viewer"}),(0,r.jsx)(n.td,{children:"Pending"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"adding-a-new-admin-tab",children:"Adding a New Admin Tab"}),"\n",(0,r.jsx)(n.h3,{id:"1-create-the-tab-content-component",children:"1. Create the Tab Content Component"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// In src/app/admin/page.tsx, add a new tab component\n\nfunction ProductionHealthTab() {\n  const [metrics, setMetrics] = useState<APIMetrics | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    async function fetchMetrics() {\n      const res = await fetch(\'/api/admin/metrics\');\n      const data = await res.json();\n      setMetrics(data);\n      setLoading(false);\n    }\n    fetchMetrics();\n  }, []);\n\n  if (loading) return <div>Loading...</div>;\n\n  return (\n    <div className="space-y-6">\n      <div className="grid grid-cols-4 gap-4">\n        <StatCard label="Uptime" value={metrics.uptime} />\n        <StatCard label="Avg Latency" value={`${metrics.avgLatency}ms`} />\n        <StatCard label="Errors (24h)" value={metrics.errorCount} />\n        <StatCard label="Active Users" value={metrics.activeUsers} />\n      </div>\n      {/* More content */}\n    </div>\n  );\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"2-add-the-tab-to-the-tab-list",children:"2. Add the Tab to the Tab List"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const tabs = [\n  { id: 'overview', label: 'Overview' },\n  { id: 'health', label: 'Production Health' }, // NEW\n  { id: 'funnel', label: 'Funnel' },\n  // ...\n];\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-add-the-tab-content-renderer",children:"3. Add the Tab Content Renderer"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"function renderTabContent(tabId: string) {\n  switch (tabId) {\n    case 'overview':\n      return <OverviewTab stats={stats} />;\n    case 'health':\n      return <ProductionHealthTab />; // NEW\n    // ...\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"creating-admin-api-endpoints",children:"Creating Admin API Endpoints"}),"\n",(0,r.jsx)(n.h3,{id:"pattern-admin-stats-endpoint",children:"Pattern: Admin Stats Endpoint"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// src/app/api/admin/metrics/route.ts\nimport { requireAdmin } from '@/db/secure-db';\nimport { createRateLimiter } from '@/lib/rate-limit';\nimport { logAdminAction } from '@/lib/hipaa/audit';\n\nconst rateLimiter = createRateLimiter({\n  windowMs: 60000,\n  maxRequests: 60,\n  keyPrefix: 'admin:metrics'\n});\n\nexport async function GET(request: Request) {\n  // 1. Check admin access\n  const admin = await requireAdmin();\n  if (!admin) {\n    return Response.json({ error: 'Forbidden' }, { status: 403 });\n  }\n\n  // 2. Apply rate limiting\n  const rateLimitResult = await rateLimiter.check(admin.id);\n  if (!rateLimitResult.allowed) {\n    return Response.json(\n      { error: 'Rate limit exceeded' },\n      { status: 429, headers: rateLimitResult.headers }\n    );\n  }\n\n  // 3. Log admin action\n  await logAdminAction(\n    admin.id,\n    AuditAction.ADMIN_STATS_VIEW,\n    'metrics',\n    null\n  );\n\n  // 4. Fetch and return data\n  const metrics = await getAPIMetrics();\n  return Response.json(metrics);\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"key-patterns",children:"Key Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"statcard-component",children:"StatCard Component"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"function StatCard({\n  label,\n  value,\n  trend,\n  status\n}: {\n  label: string;\n  value: string | number;\n  trend?: 'up' | 'down' | 'neutral';\n  status?: 'good' | 'warning' | 'error';\n}) {\n  return (\n    <div className=\"rounded-lg border bg-card p-4\">\n      <div className=\"text-sm text-muted-foreground\">{label}</div>\n      <div className=\"text-2xl font-bold\">{value}</div>\n      {trend && <TrendIndicator direction={trend} />}\n      {status && <StatusBadge status={status} />}\n    </div>\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"data-fetching-pattern",children:"Data Fetching Pattern"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Use SWR or React Query for real-time updates\nimport useSWR from 'swr';\n\nfunction useAdminMetrics() {\n  const { data, error, isLoading } = useSWR(\n    '/api/admin/metrics',\n    fetcher,\n    { refreshInterval: 30000 } // Refresh every 30s\n  );\n\n  return { metrics: data, error, isLoading };\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"hipaa-safe-error-display",children:"HIPAA-Safe Error Display"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Never show user-specific error details\nfunction ErrorList({ errors }: { errors: AggregatedError[] }) {\n  return (\n    <div>\n      {errors.map(error => (\n        <div key={error.hash}>\n          <span className="font-mono">{error.type}</span>\n          <span>{error.path}</span>\n          <span>{error.count} occurrences</span>\n          <span>{error.affectedUsers} users</span>\n          {/* NO user IDs, NO error messages with PHI */}\n        </div>\n      ))}\n    </div>\n  );\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"database-tables-for-admin-features",children:"Database Tables for Admin Features"}),"\n",(0,r.jsx)(n.p,{children:"Existing tables:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adminUsers"})," - Admin role assignments"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"allowedEmails"})," - Email whitelist"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"accessRequests"})," - Access request queue"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"auditLog"})," - HIPAA audit trail"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pageViews"})," - Navigation analytics"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Planned tables (from design):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"api_metrics"})," - API timing data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"app_errors"})," - Aggregated errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"service_health"})," - External service status"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"conversation_analytics"})," - AI chat metadata"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"incidents"})," - Incident tracking"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"access-control",children:"Access Control"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Always use requireAdmin() for admin routes\nimport { requireAdmin } from '@/db/secure-db';\n\n// For super-admin only features\nconst admin = await requireAdmin();\nif (admin.role !== 'super_admin') {\n  return Response.json({ error: 'Super admin required' }, { status: 403 });\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"testing-admin-features",children:"Testing Admin Features"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Mock admin authentication for tests\nvi.mock('@/db/secure-db', () => ({\n  requireAdmin: vi.fn().mockResolvedValue({\n    id: 'test-admin',\n    role: 'admin'\n  })\n}));\n\ndescribe('Admin Metrics Endpoint', () => {\n  it('returns metrics for authenticated admin', async () => {\n    const response = await GET(mockRequest);\n    expect(response.status).toBe(200);\n  });\n\n  it('returns 403 for non-admin', async () => {\n    vi.mocked(requireAdmin).mockResolvedValueOnce(null);\n    const response = await GET(mockRequest);\n    expect(response.status).toBe(403);\n  });\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"design-resources",children:"Design Resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Full design spec: ",(0,r.jsx)(n.code,{children:"docs/ADMIN-DEVELOPER-SUITE.md"})]}),"\n",(0,r.jsxs)(n.li,{children:["Design system: Use existing components from ",(0,r.jsx)(n.code,{children:"src/components/ui/"})]}),"\n",(0,r.jsx)(n.li,{children:"Colors: Follow therapeutic palette (navy, teal, coral, cream)"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);