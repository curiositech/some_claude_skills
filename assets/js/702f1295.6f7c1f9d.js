"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[6853],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var r=t(96540);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}},38428:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>m,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"skills/data_pipeline_engineer/references/dbt-project-structure","title":"dbt Project Structure Reference","description":"Staging Model Example","source":"@site/docs/skills/data_pipeline_engineer/references/dbt-project-structure.md","sourceDirName":"skills/data_pipeline_engineer/references","slug":"/skills/data_pipeline_engineer/references/dbt-project-structure","permalink":"/docs/skills/data_pipeline_engineer/references/dbt-project-structure","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"dbt Project Structure Reference","sidebar_label":"dbt Project Structure Refer...","sidebar_position":1}}');var s=t(74848),o=t(28453);const a={title:"dbt Project Structure Reference",sidebar_label:"dbt Project Structure Refer...",sidebar_position:1},l="dbt Project Structure Reference",i={},c=[{value:"Staging Model Example",id:"staging-model-example",level:2},{value:"Fact Table Example",id:"fact-table-example",level:2},{value:"Schema YAML Example",id:"schema-yaml-example",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"dbt-project-structure-reference",children:"dbt Project Structure Reference"})}),"\n",(0,s.jsx)(n.h1,{id:"complete-project-layout-with-staging-intermediate-and-marts-layers",children:"Complete project layout with staging, intermediate, and marts layers"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"dbt_project/\n\u251c\u2500\u2500 dbt_project.yml\n\u251c\u2500\u2500 profiles.yml\n\u251c\u2500\u2500 models/\n\u2502   \u251c\u2500\u2500 staging/           # Bronze \u2192 Silver\n\u2502   \u2502   \u251c\u2500\u2500 _staging.yml\n\u2502   \u2502   \u251c\u2500\u2500 stg_orders.sql\n\u2502   \u2502   \u251c\u2500\u2500 stg_customers.sql\n\u2502   \u2502   \u2514\u2500\u2500 stg_products.sql\n\u2502   \u251c\u2500\u2500 intermediate/      # Business logic\n\u2502   \u2502   \u251c\u2500\u2500 _intermediate.yml\n\u2502   \u2502   \u251c\u2500\u2500 int_orders_enriched.sql\n\u2502   \u2502   \u2514\u2500\u2500 int_customer_orders.sql\n\u2502   \u2514\u2500\u2500 marts/             # Gold layer\n\u2502       \u251c\u2500\u2500 core/\n\u2502       \u2502   \u251c\u2500\u2500 _core.yml\n\u2502       \u2502   \u251c\u2500\u2500 dim_customers.sql\n\u2502       \u2502   \u251c\u2500\u2500 dim_products.sql\n\u2502       \u2502   \u2514\u2500\u2500 fct_orders.sql\n\u2502       \u2514\u2500\u2500 marketing/\n\u2502           \u251c\u2500\u2500 _marketing.yml\n\u2502           \u2514\u2500\u2500 mrt_customer_ltv.sql\n\u251c\u2500\u2500 tests/\n\u2502   \u251c\u2500\u2500 generic/\n\u2502   \u2502   \u2514\u2500\u2500 test_positive_value.sql\n\u2502   \u2514\u2500\u2500 singular/\n\u2502       \u2514\u2500\u2500 assert_total_revenue_positive.sql\n\u251c\u2500\u2500 macros/\n\u2502   \u251c\u2500\u2500 generate_schema_name.sql\n\u2502   \u2514\u2500\u2500 cents_to_dollars.sql\n\u251c\u2500\u2500 seeds/\n\u2502   \u2514\u2500\u2500 country_codes.csv\n\u2514\u2500\u2500 snapshots/\n    \u2514\u2500\u2500 snap_customers.sql\n"})}),"\n",(0,s.jsx)(n.h2,{id:"staging-model-example",children:"Staging Model Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:'-- models/staging/stg_orders.sql\n{{\n  config(\n    materialized=\'incremental\',\n    unique_key=\'order_id\',\n    partition_by={\n      "field": "order_date",\n      "data_type": "date",\n      "granularity": "day"\n    }\n  )\n}}\n\nwith source as (\n    select * from {{ source(\'raw\', \'orders\') }}\n    {% if is_incremental() %}\n    where _loaded_at > (select max(_loaded_at) from {{ this }})\n    {% endif %}\n),\n\ncleaned as (\n    select\n        order_id,\n        customer_id,\n        cast(order_date as date) as order_date,\n        cast(total_cents as numeric) / 100 as total_amount,\n        status,\n        _loaded_at\n    from source\n    where order_id is not null\n)\n\nselect * from cleaned\n'})}),"\n",(0,s.jsx)(n.h2,{id:"fact-table-example",children:"Fact Table Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- models/marts/core/fct_orders.sql\n{{\n  config(\n    materialized='table',\n    cluster_by=['customer_id', 'order_date']\n  )\n}}\n\nwith orders as (\n    select * from {{ ref('stg_orders') }}\n),\n\ncustomers as (\n    select * from {{ ref('dim_customers') }}\n),\n\nproducts as (\n    select * from {{ ref('int_order_items_enriched') }}\n),\n\nfinal as (\n    select\n        o.order_id,\n        o.order_date,\n        c.customer_key,\n        c.customer_segment,\n        p.total_items,\n        p.total_quantity,\n        o.total_amount,\n        o.status,\n        datediff('day', c.first_order_date, o.order_date) as days_since_first_order,\n        row_number() over (\n            partition by o.customer_id\n            order by o.order_date\n        ) as order_sequence_number\n    from orders o\n    left join customers c on o.customer_id = c.customer_id\n    left join products p on o.order_id = p.order_id\n)\n\nselect * from final\n"})}),"\n",(0,s.jsx)(n.h2,{id:"schema-yaml-example",children:"Schema YAML Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# models/staging/_staging.yml\nversion: 2\n\nmodels:\n  - name: stg_orders\n    description: Cleaned orders from source system\n    columns:\n      - name: order_id\n        description: Primary key\n        tests:\n          - unique\n          - not_null\n      - name: customer_id\n        tests:\n          - not_null\n          - relationships:\n              to: ref('stg_customers')\n              field: customer_id\n      - name: total_amount\n        tests:\n          - not_null\n          - dbt_utils.accepted_range:\n              min_value: 0\n              max_value: 100000\n"})})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);