"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[9641],{28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var r=t(96540);const s={},a=r.createContext(s);function i(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:n},e.children)}},91059:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"skills/pwa_expert/references/nextjs-integration","title":"Next.js PWA Integration","description":"Using next-pwa","source":"@site/docs/skills/pwa_expert/references/nextjs-integration.md","sourceDirName":"skills/pwa_expert/references","slug":"/skills/pwa_expert/references/nextjs-integration","permalink":"/docs/skills/pwa_expert/references/nextjs-integration","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Next.js PWA Integration","sidebar_label":"Next.js PWA Integration","sidebar_position":3}}');var s=t(74848),a=t(28453);const i={title:"Next.js PWA Integration",sidebar_label:"Next.js PWA Integration",sidebar_position:3},o="Next.js PWA Integration",l={},c=[{value:"Using next-pwa",id:"using-next-pwa",level:2},{value:"next.config.js Configuration",id:"nextconfigjs-configuration",level:3},{value:"Static Export (Cloudflare Pages)",id:"static-export-cloudflare-pages",level:2},{value:"1. Create Custom Service Worker",id:"1-create-custom-service-worker",level:3},{value:"2. Register Manually",id:"2-register-manually",level:3},{value:"3. Call in Layout",id:"3-call-in-layout",level:3},{value:"Workbox CLI Alternative",id:"workbox-cli-alternative",level:2},{value:"Manifest in Next.js App Router",id:"manifest-in-nextjs-app-router",level:2}];function p(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"nextjs-pwa-integration",children:"Next.js PWA Integration"})}),"\n",(0,s.jsx)(n.h2,{id:"using-next-pwa",children:"Using next-pwa"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install next-pwa\n"})}),"\n",(0,s.jsx)(n.h3,{id:"nextconfigjs-configuration",children:"next.config.js Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// next.config.js\nconst withPWA = require('next-pwa')({\n  dest: 'public',\n  register: true,\n  skipWaiting: true,\n  disable: process.env.NODE_ENV === 'development',\n  runtimeCaching: [\n    {\n      urlPattern: /^https:\\/\\/api\\./,\n      handler: 'NetworkFirst',\n      options: {\n        cacheName: 'api-cache',\n        expiration: { maxEntries: 50, maxAgeSeconds: 3600 },\n      },\n    },\n    {\n      urlPattern: /\\.(png|jpg|jpeg|svg|gif|webp)$/,\n      handler: 'CacheFirst',\n      options: {\n        cacheName: 'image-cache',\n        expiration: { maxEntries: 100, maxAgeSeconds: 86400 * 30 },\n      },\n    },\n  ],\n});\n\nmodule.exports = withPWA({\n  // Your Next.js config\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"static-export-cloudflare-pages",children:"Static Export (Cloudflare Pages)"}),"\n",(0,s.jsxs)(n.p,{children:["For ",(0,s.jsx)(n.code,{children:"output: 'export'"}),", next-pwa can't generate SW at build time. Use manual approach:"]}),"\n",(0,s.jsx)(n.h3,{id:"1-create-custom-service-worker",children:"1. Create Custom Service Worker"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// public/sw.js\nconst CACHE_NAME = 'myapp-v1';\n\n// ... (use patterns from service-worker-patterns.md)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-register-manually",children:"2. Register Manually"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// lib/pwa.ts\nexport async function registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    try {\n      await navigator.serviceWorker.register('/sw.js', { scope: '/' });\n    } catch (error) {\n      console.error('SW registration failed:', error);\n    }\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-call-in-layout",children:"3. Call in Layout"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// app/layout.tsx\n'use client';\n\nimport { useEffect } from 'react';\nimport { registerServiceWorker } from '@/lib/pwa';\n\nexport default function RootLayout({ children }) {\n  useEffect(() => {\n    registerServiceWorker();\n  }, []);\n\n  return <html>{/* ... */}</html>;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"workbox-cli-alternative",children:"Workbox CLI Alternative"}),"\n",(0,s.jsx)(n.p,{children:"For more control with static exports:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install workbox-cli --save-dev\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// workbox-config.js\nmodule.exports = {\n  globDirectory: 'out/',\n  globPatterns: ['**/*.{html,js,css,png,jpg,svg}'],\n  swDest: 'out/sw.js',\n  runtimeCaching: [\n    {\n      urlPattern: /^https:\\/\\/api\\./,\n      handler: 'NetworkFirst',\n    },\n  ],\n};\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'// package.json\n{\n  "scripts": {\n    "build": "next build && npx workbox generateSW workbox-config.js"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"manifest-in-nextjs-app-router",children:"Manifest in Next.js App Router"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"// app/manifest.ts\nimport type { MetadataRoute } from 'next';\n\nexport default function manifest(): MetadataRoute.Manifest {\n  return {\n    name: 'My App',\n    short_name: 'App',\n    start_url: '/',\n    display: 'standalone',\n    background_color: '#1a1410',\n    theme_color: '#1a1410',\n    icons: [\n      { src: '/icons/icon-192.png', sizes: '192x192', type: 'image/png' },\n      { src: '/icons/icon-512.png', sizes: '512x512', type: 'image/png' },\n    ],\n  };\n}\n"})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}}}]);