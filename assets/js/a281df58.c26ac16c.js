"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[31718],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>i});var o=s(96540);const t={},r=o.createContext(t);function a(e){const n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(r.Provider,{value:n},e.children)}},97400:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"skills/recovery_social_features/references/sponsor-sponsee","title":"Sponsor/Sponsee Implementation","description":"Full implementation patterns for invite-based sponsor relationships.","source":"@site/docs/skills/recovery_social_features/references/sponsor-sponsee.md","sourceDirName":"skills/recovery_social_features/references","slug":"/skills/recovery_social_features/references/sponsor-sponsee","permalink":"/docs/skills/recovery_social_features/references/sponsor-sponsee","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Sponsor/Sponsee Implementation","sidebar_label":"Sponsor/Sponsee Implementation","sidebar_position":6}}');var t=s(74848),r=s(28453);const a={title:"Sponsor/Sponsee Implementation",sidebar_label:"Sponsor/Sponsee Implementation",sidebar_position:6},i="Sponsor/Sponsee Implementation",p={},c=[{value:"useSponsorInvite Hook",id:"usesponsorinvite-hook",level:2},{value:"Generate Sponsor Invite Component",id:"generate-sponsor-invite-component",level:2},{value:"Accept Sponsor Invite Component",id:"accept-sponsor-invite-component",level:2},{value:"Sponsor Dashboard Component",id:"sponsor-dashboard-component",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"sponsorsponsee-implementation",children:"Sponsor/Sponsee Implementation"})}),"\n",(0,t.jsx)(n.p,{children:"Full implementation patterns for invite-based sponsor relationships."}),"\n",(0,t.jsx)(n.h2,{id:"usesponsorinvite-hook",children:"useSponsorInvite Hook"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"// hooks/useSponsorInvite.ts\n'use client';\n\nimport { useState } from 'react';\nimport { supabase } from '@/lib/supabase';\n\ninterface SponsorInvite {\n  code: string;\n  expiresAt: Date;\n  program: string;\n}\n\nexport function useSponsorInvite() {\n  const [invite, setInvite] = useState<SponsorInvite | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Sponsor generates invite code\n  const createInvite = async (program: string): Promise<string> => {\n    setIsLoading(true);\n    try {\n      const { data, error } = await supabase.rpc('create_sponsor_invite', {\n        program_type: program,\n      });\n\n      if (error) throw error;\n\n      setInvite({\n        code: data.code,\n        expiresAt: new Date(data.expires_at),\n        program,\n      });\n\n      return data.code;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Sponsee accepts invite\n  const acceptInvite = async (code: string): Promise<boolean> => {\n    setIsLoading(true);\n    try {\n      const { data, error } = await supabase.rpc('accept_sponsor_invite', {\n        invite_code: code,\n      });\n\n      if (error) {\n        if (error.message.includes('expired')) {\n          throw new Error('This invite has expired. Ask your sponsor for a new one.');\n        }\n        if (error.message.includes('Invalid')) {\n          throw new Error('Invalid invite code. Please check and try again.');\n        }\n        throw error;\n      }\n\n      return true;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return { invite, createInvite, acceptInvite, isLoading };\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"generate-sponsor-invite-component",children:"Generate Sponsor Invite Component"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"// components/SponsorInvite.tsx\n'use client';\n\nimport { useState } from 'react';\nimport { useSponsorInvite } from '@/hooks/useSponsorInvite';\n\nexport function GenerateSponsorInvite({ program }: { program: string }) {\n  const { invite, createInvite, isLoading } = useSponsorInvite();\n  const [copied, setCopied] = useState(false);\n\n  const handleCreate = async () => {\n    await createInvite(program);\n  };\n\n  const copyCode = async () => {\n    if (invite) {\n      await navigator.clipboard.writeText(invite.code);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    }\n  };\n\n  if (invite) {\n    return (\n      <div className=\"p-4 bg-leather-800 rounded-lg\">\n        <p className=\"text-sm text-leather-400 mb-2\">\n          Share this code with your sponsee:\n        </p>\n        <div className=\"flex items-center gap-2\">\n          <code className=\"flex-1 px-4 py-3 bg-leather-900 rounded text-xl font-mono tracking-wider\">\n            {invite.code}\n          </code>\n          <button\n            onClick={copyCode}\n            className=\"px-4 py-3 bg-ember-500 rounded min-h-[44px]\"\n          >\n            {copied ? 'Copied!' : 'Copy'}\n          </button>\n        </div>\n        <p className=\"text-xs text-leather-500 mt-2\">\n          Expires in 24 hours\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <button\n      onClick={handleCreate}\n      disabled={isLoading}\n      className=\"w-full py-3 bg-ember-500 rounded min-h-[44px]\"\n    >\n      {isLoading ? 'Generating...' : 'Generate Sponsee Invite'}\n    </button>\n  );\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"accept-sponsor-invite-component",children:"Accept Sponsor Invite Component"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'export function AcceptSponsorInvite() {\n  const { acceptInvite, isLoading } = useSponsorInvite();\n  const [code, setCode] = useState(\'\');\n  const [error, setError] = useState(\'\');\n  const [success, setSuccess] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(\'\');\n\n    try {\n      await acceptInvite(code.toUpperCase().trim());\n      setSuccess(true);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \'Failed to accept invite\');\n    }\n  };\n\n  if (success) {\n    return (\n      <div className="p-4 bg-green-900/30 border border-green-700 rounded-lg">\n        <p className="text-green-400">Connected with your sponsor!</p>\n      </div>\n    );\n  }\n\n  return (\n    <form onSubmit={handleSubmit} className="space-y-4">\n      <div>\n        <label className="block text-sm text-leather-400 mb-1">\n          Enter invite code from your sponsor\n        </label>\n        <input\n          type="text"\n          value={code}\n          onChange={(e) => setCode(e.target.value.toUpperCase())}\n          placeholder="ABCD1234"\n          className="w-full px-4 py-3 bg-leather-900 rounded font-mono tracking-wider uppercase"\n          maxLength={8}\n        />\n      </div>\n\n      {error && (\n        <p className="text-red-400 text-sm">{error}</p>\n      )}\n\n      <button\n        type="submit"\n        disabled={isLoading || code.length < 8}\n        className="w-full py-3 bg-ember-500 rounded min-h-[44px] disabled:opacity-50"\n      >\n        {isLoading ? \'Connecting...\' : \'Connect with Sponsor\'}\n      </button>\n    </form>\n  );\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"sponsor-dashboard-component",children:"Sponsor Dashboard Component"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:'// components/SponsorDashboard.tsx\n\'use client\';\n\nimport { useSponsorRelationships } from \'@/hooks/useSponsorRelationships\';\n\nexport function SponsorDashboard() {\n  const { sponsees, sponsors, isLoading } = useSponsorRelationships();\n\n  return (\n    <div className="space-y-6">\n      {/* My Sponsors */}\n      <section>\n        <h2 className="text-lg font-semibold mb-3">My Sponsors</h2>\n        {sponsors.length === 0 ? (\n          <p className="text-leather-400">No sponsors yet</p>\n        ) : (\n          <ul className="space-y-2">\n            {sponsors.map((sponsor) => (\n              <SponsorCard\n                key={sponsor.id}\n                profile={sponsor.profile}\n                program={sponsor.program}\n                connectedAt={sponsor.startedAt}\n              />\n            ))}\n          </ul>\n        )}\n      </section>\n\n      {/* My Sponsees */}\n      <section>\n        <h2 className="text-lg font-semibold mb-3">My Sponsees</h2>\n        {sponsees.length === 0 ? (\n          <p className="text-leather-400">No sponsees yet</p>\n        ) : (\n          <ul className="space-y-2">\n            {sponsees.map((sponsee) => (\n              <SponseeCard\n                key={sponsee.id}\n                profile={sponsee.profile}\n                program={sponsee.program}\n                connectedAt={sponsee.startedAt}\n                lastCheckIn={sponsee.lastCheckIn}\n              />\n            ))}\n          </ul>\n        )}\n      </section>\n    </div>\n  );\n}\n'})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}}}]);