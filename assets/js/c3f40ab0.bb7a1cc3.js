"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[13740],{28453:(e,i,s)=>{s.d(i,{R:()=>t,x:()=>d});var n=s(96540);const l={},r=n.createContext(l);function t(e){const i=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),n.createElement(r.Provider,{value:i},e.children)}},45374:(e,i,s)=>{s.r(i),s.d(i,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"skills/mdx_sanitizer/index","title":"\ud83d\udce6 Mdx Sanitizer","description":"Comprehensive MDX content sanitizer that escapes angle brackets, generics, and other JSX-conflicting patterns to prevent build failures","source":"@site/docs/skills/mdx_sanitizer/index.md","sourceDirName":"skills/mdx_sanitizer","slug":"/skills/mdx_sanitizer/","permalink":"/docs/skills/mdx_sanitizer/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Mdx Sanitizer","sidebar_position":1}}');var l=s(74848),r=s(28453);const t={sidebar_label:"Mdx Sanitizer",sidebar_position:1},d="\ud83d\udce6 Mdx Sanitizer",c={},a=[{value:"Allowed Tools",id:"allowed-tools",level:2},{value:"Tags",id:"tags",level:2},{value:"The Problem",id:"the-problem",level:2},{value:"Solution Architecture",id:"solution-architecture",level:2},{value:"1. Sync-Time Sanitization (Proactive)",id:"1-sync-time-sanitization-proactive",level:3},{value:"2. Pre-Commit Validation (Reactive)",id:"2-pre-commit-validation-reactive",level:3},{value:"3. Build-Time Validation (Final Check)",id:"3-build-time-validation-final-check",level:3},{value:"Usage",id:"usage",level:2},{value:"Check for Issues (Dry Run)",id:"check-for-issues-dry-run",level:3},{value:"Fix All Issues",id:"fix-all-issues",level:3},{value:"Programmatic API",id:"programmatic-api",level:3},{value:"Escaping Strategies",id:"escaping-strategies",level:2},{value:"Files Modified",id:"files-modified",level:2},{value:"Patterns Detected",id:"patterns-detected",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Build Still Fails After Running Sanitizer",id:"build-still-fails-after-running-sanitizer",level:3},{value:"False Positives",id:"false-positives",level:3},{value:"Manual Escaping",id:"manual-escaping",level:3},{value:"Sources",id:"sources",level:2}];function o(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.header,{children:(0,l.jsx)(i.h1,{id:"-mdx-sanitizer",children:"\ud83d\udce6 Mdx Sanitizer"})}),"\n",(0,l.jsx)(i.p,{children:"Comprehensive MDX content sanitizer that escapes angle brackets, generics, and other JSX-conflicting patterns to prevent build failures"}),"\n",(0,l.jsx)(i.hr,{}),"\n",(0,l.jsx)(i.h2,{id:"allowed-tools",children:"Allowed Tools"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{children:"Read, Write, Edit, Bash, Glob, Grep\n"})}),"\n",(0,l.jsx)(i.h2,{id:"tags",children:"Tags"}),"\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.code,{children:"mdx"})," ",(0,l.jsx)(i.code,{children:"docusaurus"})," ",(0,l.jsx)(i.code,{children:"markdown"})," ",(0,l.jsx)(i.code,{children:"build-tools"})," ",(0,l.jsx)(i.code,{children:"sanitization"})]}),"\n",(0,l.jsx)(i.h1,{id:"mdx-sanitizer",children:"MDX Sanitizer"}),"\n",(0,l.jsx)(i.p,{children:"Comprehensive MDX content sanitizer that prevents JSX parsing errors caused by angle brackets, generics, and other conflicting patterns."}),"\n",(0,l.jsx)(i.h2,{id:"the-problem",children:"The Problem"}),"\n",(0,l.jsxs)(i.p,{children:["MDX 2.x treats unescaped ",(0,l.jsx)(i.code,{children:"<"})," and ",(0,l.jsx)(i.code,{children:"{"})," as JSX syntax. This causes build failures when content contains:"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"TypeScript generics"}),": ",(0,l.jsx)(i.code,{children:"Promise&lt;T&gt;"}),", ",(0,l.jsx)(i.code,{children:"Array&lt;string&gt;"}),", ",(0,l.jsx)(i.code,{children:"Map&lt;K, V&gt;"})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Comparisons"}),": ",(0,l.jsx)(i.code,{children:"&lt;100ms"}),", ",(0,l.jsx)(i.code,{children:"&lt;="}),", ",(0,l.jsx)(i.code,{children:"&gt;="})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Arrows"}),": ",(0,l.jsx)(i.code,{children:"--&gt;"}),", ",(0,l.jsx)(i.code,{children:"&lt;--"}),", ",(0,l.jsx)(i.code,{children:"-&gt;"})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Invalid tags"}),": ",(0,l.jsx)(i.code,{children:"&lt;link&gt;"})," in prose, ",(0,l.jsx)(i.code,{children:"&lt;tag&gt;"})," placeholders"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Empty brackets"}),": ",(0,l.jsx)(i.code,{children:"&lt;&gt;"})]}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"solution-architecture",children:"Solution Architecture"}),"\n",(0,l.jsx)(i.p,{children:"This skill implements a three-layer defense:"}),"\n",(0,l.jsx)(i.h3,{id:"1-sync-time-sanitization-proactive",children:"1. Sync-Time Sanitization (Proactive)"}),"\n",(0,l.jsxs)(i.p,{children:["Content is sanitized when syncing from ",(0,l.jsx)(i.code,{children:".claude/skills/"})," to ",(0,l.jsx)(i.code,{children:"website/docs/"}),":"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"syncSkillDocs.ts"})," - Main skill files"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"syncSkillSubpages.ts"})," - Reference files"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"doc-generator.ts"})," - Generated docs"]}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"2-pre-commit-validation-reactive",children:"2. Pre-Commit Validation (Reactive)"}),"\n",(0,l.jsxs)(i.p,{children:["The git pre-commit hook validates files before commit using ",(0,l.jsx)(i.code,{children:"validate-brackets.js"}),"."]}),"\n",(0,l.jsx)(i.h3,{id:"3-build-time-validation-final-check",children:"3. Build-Time Validation (Final Check)"}),"\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.code,{children:"npm run validate:all"})," runs as part of ",(0,l.jsx)(i.code,{children:"prebuild"})," to catch any issues."]}),"\n",(0,l.jsx)(i.h2,{id:"usage",children:"Usage"}),"\n",(0,l.jsx)(i.h3,{id:"check-for-issues-dry-run",children:"Check for Issues (Dry Run)"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-bash",children:"cd website\nnpm run sanitize:mdx\n# or with verbose output\nnpm run sanitize:mdx -- --verbose\n"})}),"\n",(0,l.jsx)(i.h3,{id:"fix-all-issues",children:"Fix All Issues"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-bash",children:"cd website\nnpm run sanitize:mdx -- --fix\n# or shorthand\nnpm run fix:mdx\n"})}),"\n",(0,l.jsx)(i.h3,{id:"programmatic-api",children:"Programmatic API"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-typescript",children:"import { sanitizeForMdx, validateMdxSafety, isMdxSafe } from './lib/mdx-sanitizer';\n\n// Sanitize content\nconst result = sanitizeForMdx(content, { useHtmlEntities: true });\nif (result.modified) {\n  console.log(`Fixed ${result.issues.length} issues`);\n  fs.writeFileSync(path, result.content);\n}\n\n// Validate without modifying\nconst issues = validateMdxSafety(content, 'path/to/file.md');\n\n// Quick check\nif (!isMdxSafe(content)) {\n  // Handle issues\n}\n"})}),"\n",(0,l.jsx)(i.h2,{id:"escaping-strategies",children:"Escaping Strategies"}),"\n",(0,l.jsx)(i.p,{children:"The sanitizer uses HTML entities for maximum compatibility:"}),"\n",(0,l.jsxs)(i.table,{children:[(0,l.jsx)(i.thead,{children:(0,l.jsxs)(i.tr,{children:[(0,l.jsx)(i.th,{children:"Pattern"}),(0,l.jsx)(i.th,{children:"Original"}),(0,l.jsx)(i.th,{children:"Escaped"})]})}),(0,l.jsxs)(i.tbody,{children:[(0,l.jsxs)(i.tr,{children:[(0,l.jsx)(i.td,{children:"Less-than"}),(0,l.jsx)(i.td,{children:(0,l.jsx)(i.code,{children:"<"})}),(0,l.jsx)(i.td,{children:(0,l.jsx)(i.code,{children:"&lt;"})})]}),(0,l.jsxs)(i.tr,{children:[(0,l.jsx)(i.td,{children:"Greater-than"}),(0,l.jsx)(i.td,{children:(0,l.jsx)(i.code,{children:">"})}),(0,l.jsx)(i.td,{children:(0,l.jsx)(i.code,{children:"&gt;"})})]}),(0,l.jsxs)(i.tr,{children:[(0,l.jsx)(i.td,{children:"Generics"}),(0,l.jsx)(i.td,{children:(0,l.jsx)(i.code,{children:"&lt;T&gt;"})}),(0,l.jsx)(i.td,{children:(0,l.jsx)(i.code,{children:"&amp;lt;T&amp;gt;"})})]}),(0,l.jsxs)(i.tr,{children:[(0,l.jsx)(i.td,{children:"Comparison"}),(0,l.jsx)(i.td,{children:(0,l.jsx)(i.code,{children:"&lt;="})}),(0,l.jsx)(i.td,{children:(0,l.jsx)(i.code,{children:"&amp;lt;="})})]})]})]}),"\n",(0,l.jsxs)(i.p,{children:["Content inside code blocks (",(0,l.jsx)(i.code,{children:"```"})," or ",(0,l.jsx)(i.code,{children:"`"}),") is automatically protected and never escaped."]}),"\n",(0,l.jsx)(i.h2,{id:"files-modified",children:"Files Modified"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"website/scripts/lib/mdx-sanitizer.ts"})," - Core sanitizer module"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"website/scripts/sanitize-mdx.ts"})," - CLI wrapper"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"website/scripts/syncSkillDocs.ts"})," - Integration"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"website/scripts/syncSkillSubpages.ts"})," - Integration"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"website/scripts/lib/doc-generator.ts"})," - Integration"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"website/package.json"})," - npm scripts"]}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"patterns-detected",children:"Patterns Detected"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Less-than before digit"}),": ",(0,l.jsx)(i.code,{children:"&lt;100"}),", ",(0,l.jsx)(i.code,{children:"&lt;0.5ms"})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Comparison operators"}),": ",(0,l.jsx)(i.code,{children:"&lt;="}),", ",(0,l.jsx)(i.code,{children:"&gt;="})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Empty brackets"}),": ",(0,l.jsx)(i.code,{children:"&lt;&gt;"})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Arrows"}),": ",(0,l.jsx)(i.code,{children:"&lt;--"}),", ",(0,l.jsx)(i.code,{children:"--&gt;"})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Generic types"}),": ",(0,l.jsx)(i.code,{children:"Promise&lt;T&gt;"}),", ",(0,l.jsx)(i.code,{children:"Array&lt;string&gt;"})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Space after less-than"}),": ",(0,l.jsx)(i.code,{children:"&lt; value"})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Invalid pseudo-tags"}),": ",(0,l.jsx)(i.code,{children:"&lt;link&gt;"}),", ",(0,l.jsx)(i.code,{children:"&lt;tag&gt;"})," (not valid HTML)"]}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(i.h3,{id:"build-still-fails-after-running-sanitizer",children:"Build Still Fails After Running Sanitizer"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:["Clear Docusaurus cache: ",(0,l.jsx)(i.code,{children:"npm run clear"})]}),"\n",(0,l.jsxs)(i.li,{children:["Re-run sanitizer: ",(0,l.jsx)(i.code,{children:"npm run sanitize:mdx -- --fix"})]}),"\n",(0,l.jsxs)(i.li,{children:["Rebuild: ",(0,l.jsx)(i.code,{children:"npm run build"})]}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"false-positives",children:"False Positives"}),"\n",(0,l.jsx)(i.p,{children:"If valid JSX components are being escaped:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["Ensure they use PascalCase (e.g., ",(0,l.jsx)(i.code,{children:"&lt;MyComponent&gt;"}),")"]}),"\n",(0,l.jsx)(i.li,{children:"Check they're valid HTML5 elements"}),"\n"]}),"\n",(0,l.jsx)(i.h3,{id:"manual-escaping",children:"Manual Escaping"}),"\n",(0,l.jsx)(i.p,{children:"For edge cases, manually escape in source:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["Use backticks for inline code: ",(0,l.jsx)(i.code,{children:"`&lt;T&gt;`"})]}),"\n",(0,l.jsx)(i.li,{children:"Use fenced code blocks for multi-line"}),"\n",(0,l.jsxs)(i.li,{children:["Use HTML entities: ",(0,l.jsx)(i.code,{children:"&lt;"})," and ",(0,l.jsx)(i.code,{children:"&gt;"})]}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"sources",children:"Sources"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:(0,l.jsx)(i.a,{href:"https://mdxjs.com/docs/troubleshooting-mdx/",children:"MDX Troubleshooting"})}),"\n",(0,l.jsx)(i.li,{children:(0,l.jsx)(i.a,{href:"https://github.com/tgreyuk/typedoc-plugin-markdown/issues/167",children:"TypeDoc MDX Issues"})}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,l.jsx)(i,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}}}]);