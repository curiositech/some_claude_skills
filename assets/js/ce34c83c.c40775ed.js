"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[61773],{28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>i});var s=t(96540);const r={},a=s.createContext(r);function c(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(a.Provider,{value:n},e.children)}},75843:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>c,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"skills/pwa_expert/references/service-worker-patterns","title":"Service Worker Patterns","description":"Basic Service Worker Structure","source":"@site/docs/skills/pwa_expert/references/service-worker-patterns.md","sourceDirName":"skills/pwa_expert/references","slug":"/skills/pwa_expert/references/service-worker-patterns","permalink":"/docs/skills/pwa_expert/references/service-worker-patterns","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Service Worker Patterns","sidebar_label":"Service Worker Patterns","sidebar_position":5}}');var r=t(74848),a=t(28453);const c={title:"Service Worker Patterns",sidebar_label:"Service Worker Patterns",sidebar_position:5},i="Service Worker Patterns",o={},l=[{value:"Basic Service Worker Structure",id:"basic-service-worker-structure",level:2},{value:"Caching Strategy Implementations",id:"caching-strategy-implementations",level:2},{value:"Cache-First",id:"cache-first",level:3},{value:"Network-First",id:"network-first",level:3},{value:"Stale-While-Revalidate",id:"stale-while-revalidate",level:3},{value:"Route-Based Strategy Selection",id:"route-based-strategy-selection",level:2},{value:"Handle Skip Waiting Message",id:"handle-skip-waiting-message",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"service-worker-patterns",children:"Service Worker Patterns"})}),"\n",(0,r.jsx)(n.h2,{id:"basic-service-worker-structure",children:"Basic Service Worker Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// public/sw.js\nconst CACHE_NAME = 'jb4l-v1';\nconst STATIC_ASSETS = [\n  '/',\n  '/offline',\n  '/manifest.json',\n  '/icons/icon-192.png',\n  '/icons/icon-512.png',\n];\n\n// Install: Cache static assets\nself.addEventListener('install', (event) => {\n  event.waitUntil(\n    caches.open(CACHE_NAME).then((cache) => {\n      return cache.addAll(STATIC_ASSETS);\n    })\n  );\n  self.skipWaiting(); // Activate immediately\n});\n\n// Activate: Clean old caches\nself.addEventListener('activate', (event) => {\n  event.waitUntil(\n    caches.keys().then((keys) => {\n      return Promise.all(\n        keys\n          .filter((key) => key !== CACHE_NAME)\n          .map((key) => caches.delete(key))\n      );\n    })\n  );\n  self.clients.claim(); // Take control immediately\n});\n\n// Fetch: Handle requests\nself.addEventListener('fetch', (event) => {\n  event.respondWith(handleFetch(event.request));\n});\n\nasync function handleFetch(request) {\n  // Network-first for API requests\n  if (request.url.includes('/api/')) {\n    return networkFirst(request);\n  }\n\n  // Cache-first for static assets\n  return cacheFirst(request);\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"caching-strategy-implementations",children:"Caching Strategy Implementations"}),"\n",(0,r.jsx)(n.h3,{id:"cache-first",children:"Cache-First"}),"\n",(0,r.jsx)(n.p,{children:"Try cache, fallback to network. Best for static assets."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"async function cacheFirst(request) {\n  const cached = await caches.match(request);\n  if (cached) return cached;\n\n  try {\n    const response = await fetch(request);\n    // Cache successful responses\n    if (response.ok) {\n      const cache = await caches.open(CACHE_NAME);\n      cache.put(request, response.clone());\n    }\n    return response;\n  } catch (error) {\n    // Return offline page for navigation\n    if (request.mode === 'navigate') {\n      return caches.match('/offline');\n    }\n    throw error;\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"network-first",children:"Network-First"}),"\n",(0,r.jsx)(n.p,{children:"Try network, fallback to cache. Best for API data."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"async function networkFirst(request) {\n  try {\n    const response = await fetch(request);\n    // Cache successful API responses\n    if (response.ok) {\n      const cache = await caches.open(CACHE_NAME);\n      cache.put(request, response.clone());\n    }\n    return response;\n  } catch (error) {\n    const cached = await caches.match(request);\n    if (cached) return cached;\n\n    // Return error response for API\n    return new Response(\n      JSON.stringify({ error: 'Offline', cached: false }),\n      { status: 503, headers: { 'Content-Type': 'application/json' } }\n    );\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stale-while-revalidate",children:"Stale-While-Revalidate"}),"\n",(0,r.jsx)(n.p,{children:"Return cache immediately, update in background. Best balance of speed and freshness."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"async function staleWhileRevalidate(request) {\n  const cache = await caches.open(CACHE_NAME);\n  const cached = await cache.match(request);\n\n  const fetchPromise = fetch(request).then((response) => {\n    if (response.ok) {\n      cache.put(request, response.clone());\n    }\n    return response;\n  });\n\n  return cached || fetchPromise;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"route-based-strategy-selection",children:"Route-Based Strategy Selection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"self.addEventListener('fetch', (event) => {\n  const { request } = event;\n  const url = new URL(request.url);\n\n  // Skip non-GET requests\n  if (request.method !== 'GET') return;\n\n  // API routes: Network-first with cache fallback\n  if (url.pathname.startsWith('/api/')) {\n    event.respondWith(networkFirst(request));\n    return;\n  }\n\n  // Static assets: Cache-first\n  if (url.pathname.match(/\\.(js|css|png|jpg|svg|woff2?)$/)) {\n    event.respondWith(cacheFirst(request));\n    return;\n  }\n\n  // HTML pages: Stale-while-revalidate\n  if (request.mode === 'navigate') {\n    event.respondWith(staleWhileRevalidate(request));\n    return;\n  }\n\n  // Default: Network-first\n  event.respondWith(networkFirst(request));\n});\n"})}),"\n",(0,r.jsx)(n.h2,{id:"handle-skip-waiting-message",children:"Handle Skip Waiting Message"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"self.addEventListener('message', (event) => {\n  if (event.data?.type === 'SKIP_WAITING') {\n    self.skipWaiting();\n  }\n});\n"})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);