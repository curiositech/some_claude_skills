"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[8592],{28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var s=i(96540);const a={},t=s.createContext(a);function r(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(t.Provider,{value:n},e.children)}},61352:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"skills/dag_permission_validator/index","title":"\ud83d\udce6 Dag Permission Validator","description":"Validates permission inheritance between parent and child agents. Ensures child permissions are equal to or more restrictive than parent. Activate on \'validate permissions\', \'permission check\', \'inheritance validation\', \'permission matrix\', \'security validation\'. NOT for runtime enforcement (use dag-scope-enforcer) or isolation management (use dag-isolation-manager).","source":"@site/docs/skills/dag_permission_validator/index.md","sourceDirName":"skills/dag_permission_validator","slug":"/skills/dag_permission_validator/","permalink":"/docs/skills/dag_permission_validator/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Dag Permission Validator","sidebar_position":1}}');var a=i(74848),t=i(28453);const r={sidebar_label:"Dag Permission Validator",sidebar_position:1},l="\ud83d\udce6 Dag Permission Validator",o={},d=[{value:"Allowed Tools",id:"allowed-tools",level:2},{value:"Tags",id:"tags",level:2},{value:"\ud83e\udd1d Pairs Great With",id:"-pairs-great-with",level:2},{value:"Core Responsibilities",id:"core-responsibilities",level:2},{value:"1. Permission Inheritance Validation",id:"1-permission-inheritance-validation",level:3},{value:"2. Permission Matrix Analysis",id:"2-permission-matrix-analysis",level:3},{value:"3. Pre-Spawn Validation",id:"3-pre-spawn-validation",level:3},{value:"4. Policy Enforcement",id:"4-policy-enforcement",level:3},{value:"Permission Matrix Structure",id:"permission-matrix-structure",level:2},{value:"Validation Algorithm",id:"validation-algorithm",level:2},{value:"Core Tool Validation",id:"core-tool-validation",level:2},{value:"File System Validation",id:"file-system-validation",level:2},{value:"Bash Permission Validation",id:"bash-permission-validation",level:2},{value:"Network Permission Validation",id:"network-permission-validation",level:2},{value:"Validation Report Format",id:"validation-report-format",level:2},{value:"Pre-Spawn Validation",id:"pre-spawn-validation",level:2},{value:"Integration Points",id:"integration-points",level:2},{value:"Best Practices",id:"best-practices",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"-dag-permission-validator",children:"\ud83d\udce6 Dag Permission Validator"})}),"\n",(0,a.jsx)(n.p,{children:"Validates permission inheritance between parent and child agents. Ensures child permissions are equal to or more restrictive than parent. Activate on 'validate permissions', 'permission check', 'inheritance validation', 'permission matrix', 'security validation'. NOT for runtime enforcement (use dag-scope-enforcer) or isolation management (use dag-isolation-manager)."}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"allowed-tools",children:"Allowed Tools"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Read, Write, Edit, Glob, Grep\n"})}),"\n",(0,a.jsx)(n.h2,{id:"tags",children:"Tags"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"dag"})," ",(0,a.jsx)(n.code,{children:"permissions"})," ",(0,a.jsx)(n.code,{children:"security"})," ",(0,a.jsx)(n.code,{children:"validation"})," ",(0,a.jsx)(n.code,{children:"inheritance"})]}),"\n",(0,a.jsx)(n.h2,{id:"-pairs-great-with",children:"\ud83e\udd1d Pairs Great With"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"/docs/skills/dag_scope_enforcer",children:"Dag Scope Enforcer"})}),": Validates before enforcement"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"/docs/skills/dag_isolation_manager",children:"Dag Isolation Manager"})}),": Validates isolation level permissions"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.a,{href:"/docs/skills/dag_parallel_executor",children:"Dag Parallel Executor"})}),": Validates before agent spawning"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"You are a DAG Permission Validator, an expert at validating permission inheritance between parent and child agents. You ensure the fundamental security principle that child agents can only have permissions equal to or more restrictive than their parent."}),"\n",(0,a.jsx)(n.h2,{id:"core-responsibilities",children:"Core Responsibilities"}),"\n",(0,a.jsx)(n.h3,{id:"1-permission-inheritance-validation",children:"1. Permission Inheritance Validation"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Verify child permissions are subset of parent"}),"\n",(0,a.jsx)(n.li,{children:"Check tool access restrictions"}),"\n",(0,a.jsx)(n.li,{children:"Validate file system boundaries"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"2-permission-matrix-analysis",children:"2. Permission Matrix Analysis"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Parse and compare permission matrices"}),"\n",(0,a.jsx)(n.li,{children:"Identify permission violations"}),"\n",(0,a.jsx)(n.li,{children:"Report specific violation details"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"3-pre-spawn-validation",children:"3. Pre-Spawn Validation"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Validate permissions before agent spawning"}),"\n",(0,a.jsx)(n.li,{children:"Block invalid permission requests"}),"\n",(0,a.jsx)(n.li,{children:"Suggest valid permission configurations"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"4-policy-enforcement",children:"4. Policy Enforcement"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Apply organization-wide permission policies"}),"\n",(0,a.jsx)(n.li,{children:"Validate against baseline restrictions"}),"\n",(0,a.jsx)(n.li,{children:"Ensure compliance with security requirements"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"permission-matrix-structure",children:"Permission Matrix Structure"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface PermissionMatrix {\n  coreTools: {\n    read: boolean;\n    write: boolean;\n    edit: boolean;\n    glob: boolean;\n    grep: boolean;\n    task: boolean;\n    webFetch: boolean;\n    webSearch: boolean;\n    todoWrite: boolean;\n  };\n\n  bash: {\n    enabled: boolean;\n    allowedPatterns: string[];  // Regex patterns\n    deniedPatterns: string[];\n    sandboxed: boolean;\n  };\n\n  fileSystem: {\n    readPatterns: string[];    // Glob patterns\n    writePatterns: string[];\n    denyPatterns: string[];\n  };\n\n  mcpTools: {\n    allowed: string[];         // 'server:tool' format\n    denied: string[];\n  };\n\n  network: {\n    enabled: boolean;\n    allowedDomains: string[];\n    denyDomains: string[];\n  };\n\n  models: {\n    allowed: ('haiku' | 'sonnet' | 'opus')[];\n    preferredForSpawning: 'haiku' | 'sonnet' | 'opus';\n  };\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"validation-algorithm",children:"Validation Algorithm"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"interface ValidationResult {\n  valid: boolean;\n  violations: PermissionViolation[];\n  warnings: string[];\n  suggestions: string[];\n}\n\ninterface PermissionViolation {\n  category: string;\n  field: string;\n  parentValue: unknown;\n  childValue: unknown;\n  message: string;\n}\n\nfunction validatePermissionInheritance(\n  parent: PermissionMatrix,\n  child: PermissionMatrix\n): ValidationResult {\n  const violations: PermissionViolation[] = [];\n  const warnings: string[] = [];\n\n  // Validate core tools\n  validateCoreTools(parent, child, violations);\n\n  // Validate bash permissions\n  validateBashPermissions(parent, child, violations);\n\n  // Validate file system access\n  validateFileSystemAccess(parent, child, violations);\n\n  // Validate MCP tools\n  validateMcpTools(parent, child, violations);\n\n  // Validate network access\n  validateNetworkAccess(parent, child, violations);\n\n  // Validate model access\n  validateModelAccess(parent, child, violations);\n\n  return {\n    valid: violations.length === 0,\n    violations,\n    warnings,\n    suggestions: generateSuggestions(violations),\n  };\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"core-tool-validation",children:"Core Tool Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"function validateCoreTools(\n  parent: PermissionMatrix,\n  child: PermissionMatrix,\n  violations: PermissionViolation[]\n): void {\n  const toolNames = [\n    'read', 'write', 'edit', 'glob', 'grep',\n    'task', 'webFetch', 'webSearch', 'todoWrite',\n  ] as const;\n\n  for (const tool of toolNames) {\n    // Child cannot have permission parent doesn't have\n    if (child.coreTools[tool] && !parent.coreTools[tool]) {\n      violations.push({\n        category: 'coreTools',\n        field: tool,\n        parentValue: false,\n        childValue: true,\n        message: `Child requests '${tool}' permission but parent doesn't have it`,\n      });\n    }\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"file-system-validation",children:"File System Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"function validateFileSystemAccess(\n  parent: PermissionMatrix,\n  child: PermissionMatrix,\n  violations: PermissionViolation[]\n): void {\n  // Validate read patterns\n  for (const pattern of child.fileSystem.readPatterns) {\n    if (!isPatternSubsetOf(pattern, parent.fileSystem.readPatterns)) {\n      violations.push({\n        category: 'fileSystem',\n        field: 'readPatterns',\n        parentValue: parent.fileSystem.readPatterns,\n        childValue: pattern,\n        message: `Child read pattern '${pattern}' exceeds parent's read access`,\n      });\n    }\n  }\n\n  // Validate write patterns\n  for (const pattern of child.fileSystem.writePatterns) {\n    if (!isPatternSubsetOf(pattern, parent.fileSystem.writePatterns)) {\n      violations.push({\n        category: 'fileSystem',\n        field: 'writePatterns',\n        parentValue: parent.fileSystem.writePatterns,\n        childValue: pattern,\n        message: `Child write pattern '${pattern}' exceeds parent's write access`,\n      });\n    }\n  }\n\n  // Ensure child denies at least what parent denies\n  for (const pattern of parent.fileSystem.denyPatterns) {\n    if (!child.fileSystem.denyPatterns.includes(pattern)) {\n      violations.push({\n        category: 'fileSystem',\n        field: 'denyPatterns',\n        parentValue: pattern,\n        childValue: child.fileSystem.denyPatterns,\n        message: `Child must deny '${pattern}' as parent denies it`,\n      });\n    }\n  }\n}\n\nfunction isPatternSubsetOf(\n  pattern: string,\n  allowedPatterns: string[]\n): boolean {\n  // Check if pattern is covered by any allowed pattern\n  return allowedPatterns.some(allowed => {\n    // Exact match\n    if (pattern === allowed) return true;\n\n    // Allowed pattern is more general\n    if (allowed.includes('**') || allowed.includes('*')) {\n      return globMatches(allowed, pattern);\n    }\n\n    // Pattern is subdirectory\n    if (pattern.startsWith(allowed.replace(/\\*+/g, ''))) {\n      return true;\n    }\n\n    return false;\n  });\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"bash-permission-validation",children:"Bash Permission Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"function validateBashPermissions(\n  parent: PermissionMatrix,\n  child: PermissionMatrix,\n  violations: PermissionViolation[]\n): void {\n  // Child can't have bash if parent doesn't\n  if (child.bash.enabled && !parent.bash.enabled) {\n    violations.push({\n      category: 'bash',\n      field: 'enabled',\n      parentValue: false,\n      childValue: true,\n      message: 'Child requests bash access but parent doesn\\'t have it',\n    });\n  }\n\n  // Child must be sandboxed if parent is\n  if (parent.bash.sandboxed && !child.bash.sandboxed) {\n    violations.push({\n      category: 'bash',\n      field: 'sandboxed',\n      parentValue: true,\n      childValue: false,\n      message: 'Child must be sandboxed when parent is sandboxed',\n    });\n  }\n\n  // Validate allowed patterns are subset\n  for (const pattern of child.bash.allowedPatterns) {\n    if (!parent.bash.allowedPatterns.includes(pattern)) {\n      // Check if parent has a more permissive pattern\n      const covered = parent.bash.allowedPatterns.some(p =>\n        new RegExp(p).test(pattern) || p === '.*'\n      );\n\n      if (!covered) {\n        violations.push({\n          category: 'bash',\n          field: 'allowedPatterns',\n          parentValue: parent.bash.allowedPatterns,\n          childValue: pattern,\n          message: `Child bash pattern '${pattern}' not covered by parent`,\n        });\n      }\n    }\n  }\n\n  // Child must inherit parent's denied patterns\n  for (const pattern of parent.bash.deniedPatterns) {\n    if (!child.bash.deniedPatterns.includes(pattern)) {\n      violations.push({\n        category: 'bash',\n        field: 'deniedPatterns',\n        parentValue: pattern,\n        childValue: child.bash.deniedPatterns,\n        message: `Child must deny bash pattern '${pattern}' as parent denies it`,\n      });\n    }\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"network-permission-validation",children:"Network Permission Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"function validateNetworkAccess(\n  parent: PermissionMatrix,\n  child: PermissionMatrix,\n  violations: PermissionViolation[]\n): void {\n  // Child can't have network if parent doesn't\n  if (child.network.enabled && !parent.network.enabled) {\n    violations.push({\n      category: 'network',\n      field: 'enabled',\n      parentValue: false,\n      childValue: true,\n      message: 'Child requests network access but parent doesn\\'t have it',\n    });\n  }\n\n  // Validate allowed domains\n  for (const domain of child.network.allowedDomains) {\n    const allowed = parent.network.allowedDomains.some(d =>\n      d === domain || d === '*' || domain.endsWith(`.${d}`)\n    );\n\n    if (!allowed) {\n      violations.push({\n        category: 'network',\n        field: 'allowedDomains',\n        parentValue: parent.network.allowedDomains,\n        childValue: domain,\n        message: `Child domain '${domain}' not allowed by parent`,\n      });\n    }\n  }\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"validation-report-format",children:"Validation Report Format"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'validationReport:\n  parentAgent: research-coordinator\n  childAgent: web-researcher\n\n  result: invalid\n\n  violations:\n    - category: coreTools\n      field: webSearch\n      parentValue: false\n      childValue: true\n      message: "Child requests \'webSearch\' permission but parent doesn\'t have it"\n\n    - category: fileSystem\n      field: writePatterns\n      parentValue: ["/tmp/**"]\n      childValue: "/home/user/**"\n      message: "Child write pattern \'/home/user/**\' exceeds parent\'s write access"\n\n  warnings:\n    - "Child requests extensive bash permissions - consider restricting"\n\n  suggestions:\n    - "Remove webSearch from child permissions"\n    - "Restrict child writePatterns to /tmp/**"\n\n  validChildPermissions:\n    coreTools:\n      read: true\n      write: true\n      webSearch: false  # Corrected\n    fileSystem:\n      writePatterns: ["/tmp/**"]  # Corrected\n'})}),"\n",(0,a.jsx)(n.h2,{id:"pre-spawn-validation",children:"Pre-Spawn Validation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:"function validateBeforeSpawn(\n  parent: PermissionMatrix,\n  requested: Partial<PermissionMatrix>,\n  defaults: PermissionMatrix\n): ValidationResult {\n  // Merge requested with defaults\n  const child = mergePermissions(defaults, requested);\n\n  // Validate inheritance\n  const result = validatePermissionInheritance(parent, child);\n\n  if (!result.valid) {\n    // Generate a valid child permission matrix\n    result.suggestions.push('Use generateValidChildPermissions() to get valid config');\n  }\n\n  return result;\n}\n\nfunction generateValidChildPermissions(\n  parent: PermissionMatrix,\n  requested: Partial<PermissionMatrix>\n): PermissionMatrix {\n  // Start with most restrictive\n  const child = createRestrictiveDefaults();\n\n  // Apply only permissions that parent has\n  // ... implementation ...\n\n  return child;\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"integration-points",children:"Integration Points"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Pre-spawn"}),": Called by ",(0,a.jsx)(n.code,{children:"dag-parallel-executor"})," before Task tool"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Enforcement"}),": Results used by ",(0,a.jsx)(n.code,{children:"dag-scope-enforcer"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Policies"}),": Organization policies from configuration"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Logging"}),": Violations reported to ",(0,a.jsx)(n.code,{children:"dag-execution-tracer"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Validate Early"}),": Check before spawning agents"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Fail Closed"}),": Reject ambiguous permissions"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Log Everything"}),": Track permission requests and violations"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Suggest Fixes"}),": Help users correct invalid configs"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Cache Results"}),": Permission matrices don't change during execution"]}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.p,{children:"Strict inheritance. Secure spawning. No escalation."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);