"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[3964],{28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var s=r(96540);const t={},i=s.createContext(t);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:n},e.children)}},34406:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"skills/background_job_orchestrator/index","title":"Background Job Orchestrator","description":"Expert in background job processing with Bull/BullMQ (Redis), Celery, and cloud queues. Implements retries, scheduling, priority queues, and worker management. Use for async task processing, email campaigns, report generation, batch operations. Activate on \\"background job\\", \\"async task\\", \\"queue\\", \\"worker\\", \\"BullMQ\\", \\"Celery\\". NOT for real-time WebSocket communication, synchronous API calls, or simple setTimeout operations.","source":"@site/docs/skills/background_job_orchestrator/index.md","sourceDirName":"skills/background_job_orchestrator","slug":"/skills/background_job_orchestrator","permalink":"/docs/skills/background_job_orchestrator","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"name":"background-job-orchestrator","description":"Expert in background job processing with Bull/BullMQ (Redis), Celery, and cloud queues. Implements retries, scheduling, priority queues, and worker management. Use for async task processing, email campaigns, report generation, batch operations. Activate on \\"background job\\", \\"async task\\", \\"queue\\", \\"worker\\", \\"BullMQ\\", \\"Celery\\". NOT for real-time WebSocket communication, synchronous API calls, or simple setTimeout operations.","allowed-tools":"Read,Write,Edit,Bash(npm:*,pip:*)","slug":"/skills/background_job_orchestrator"}}');var t=r(74848),i=r(28453);const o={name:"background-job-orchestrator",description:'Expert in background job processing with Bull/BullMQ (Redis), Celery, and cloud queues. Implements retries, scheduling, priority queues, and worker management. Use for async task processing, email campaigns, report generation, batch operations. Activate on "background job", "async task", "queue", "worker", "BullMQ", "Celery". NOT for real-time WebSocket communication, synchronous API calls, or simple setTimeout operations.',"allowed-tools":"Read,Write,Edit,Bash(npm:*,pip:*)",slug:"/skills/background_job_orchestrator"},l="Background Job Orchestrator",d={},a=[{value:"When to Use",id:"when-to-use",level:2},{value:"Quick Decision Tree",id:"quick-decision-tree",level:2},{value:"Technology Selection",id:"technology-selection",level:2},{value:"Node.js: BullMQ (Recommended 2024+)",id:"nodejs-bullmq-recommended-2024",level:3},{value:"Python: Celery",id:"python-celery",level:3},{value:"Cloud-Native: AWS SQS, Google Cloud Tasks",id:"cloud-native-aws-sqs-google-cloud-tasks",level:3},{value:"Common Anti-Patterns",id:"common-anti-patterns",level:2},{value:"Anti-Pattern 1: No Dead Letter Queue",id:"anti-pattern-1-no-dead-letter-queue",level:3},{value:"Anti-Pattern 2: Synchronous Job Processing",id:"anti-pattern-2-synchronous-job-processing",level:3},{value:"Anti-Pattern 3: No Idempotency",id:"anti-pattern-3-no-idempotency",level:3},{value:"Anti-Pattern 4: No Rate Limiting",id:"anti-pattern-4-no-rate-limiting",level:3},{value:"Anti-Pattern 5: Forgetting Worker Scaling",id:"anti-pattern-5-forgetting-worker-scaling",level:3},{value:"Implementation Patterns",id:"implementation-patterns",level:2},{value:"Pattern 1: Email Campaigns",id:"pattern-1-email-campaigns",level:3},{value:"Pattern 2: Scheduled Reports",id:"pattern-2-scheduled-reports",level:3},{value:"Pattern 3: Video Transcoding Pipeline",id:"pattern-3-video-transcoding-pipeline",level:3},{value:"Monitoring &amp; Observability",id:"monitoring--observability",level:2},{value:"Essential Metrics",id:"essential-metrics",level:3},{value:"BullMQ Board (UI)",id:"bullmq-board-ui",level:3},{value:"Production Checklist",id:"production-checklist",level:2},{value:"When to Use vs Avoid",id:"when-to-use-vs-avoid",level:2},{value:"Technology Comparison",id:"technology-comparison",level:2},{value:"References",id:"references",level:2},{value:"Scripts",id:"scripts",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"background-job-orchestrator",children:"Background Job Orchestrator"})}),"\n",(0,t.jsx)(n.p,{children:"Expert in designing and implementing production-grade background job systems that handle long-running tasks without blocking API responses."}),"\n",(0,t.jsx)(n.h2,{id:"when-to-use",children:"When to Use"}),"\n",(0,t.jsxs)(n.p,{children:["\u2705 ",(0,t.jsx)(n.strong,{children:"Use for"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Long-running tasks (email sends, report generation, image processing)"}),"\n",(0,t.jsx)(n.li,{children:"Batch operations (bulk imports, exports, data migrations)"}),"\n",(0,t.jsx)(n.li,{children:"Scheduled tasks (daily digests, cleanup jobs, recurring reports)"}),"\n",(0,t.jsx)(n.li,{children:"Tasks requiring retry logic (external API calls, flaky operations)"}),"\n",(0,t.jsx)(n.li,{children:"Priority-based processing (premium users first, critical alerts)"}),"\n",(0,t.jsx)(n.li,{children:"Rate-limited operations (API quotas, third-party service limits)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u274c ",(0,t.jsx)(n.strong,{children:"NOT for"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Real-time bidirectional communication (use WebSockets)"}),"\n",(0,t.jsx)(n.li,{children:"Sub-second latency requirements (use in-memory caching)"}),"\n",(0,t.jsx)(n.li,{children:"Simple delays (setTimeout is fine for <5 seconds)"}),"\n",(0,t.jsx)(n.li,{children:"Synchronous API responses (keep logic in request handler)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"quick-decision-tree",children:"Quick Decision Tree"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Does this task:\n\u251c\u2500\u2500 Take &gt;5 seconds? \u2192 Background job\n\u251c\u2500\u2500 Need to retry on failure? \u2192 Background job\n\u251c\u2500\u2500 Run on a schedule? \u2192 Background job (cron pattern)\n\u251c\u2500\u2500 Block user interaction? \u2192 Background job\n\u251c\u2500\u2500 Process in batches? \u2192 Background job\n\u2514\u2500\u2500 Return immediately? \u2192 Keep synchronous\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"technology-selection",children:"Technology Selection"}),"\n",(0,t.jsx)(n.h3,{id:"nodejs-bullmq-recommended-2024",children:"Node.js: BullMQ (Recommended 2024+)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"When to use"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"TypeScript project"}),"\n",(0,t.jsx)(n.li,{children:"Redis already in stack"}),"\n",(0,t.jsx)(n.li,{children:"Need advanced features (rate limiting, priorities, repeatable jobs)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why BullMQ over Bull"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Bull (v3) \u2192 BullMQ (v4+): Complete rewrite in TypeScript"}),"\n",(0,t.jsx)(n.li,{children:"Better Redis connection handling"}),"\n",(0,t.jsx)(n.li,{children:"Improved concurrency and performance"}),"\n",(0,t.jsx)(n.li,{children:"Active maintenance (Bull is in maintenance mode)"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"python-celery",children:"Python: Celery"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"When to use"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Python/Django project"}),"\n",(0,t.jsx)(n.li,{children:"Need distributed task execution"}),"\n",(0,t.jsx)(n.li,{children:"Complex workflows (chains, groups, chords)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Alternatives"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"RQ"})," (Redis Queue): Simpler, fewer features"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Dramatiq"}),": Modern, less ecosystem"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Huey"}),": Lightweight, good for small projects"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"cloud-native-aws-sqs-google-cloud-tasks",children:"Cloud-Native: AWS SQS, Google Cloud Tasks"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"When to use"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Serverless architecture"}),"\n",(0,t.jsx)(n.li,{children:"Don't want to manage Redis/RabbitMQ"}),"\n",(0,t.jsx)(n.li,{children:"Need guaranteed delivery and dead-letter queues"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"common-anti-patterns",children:"Common Anti-Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"anti-pattern-1-no-dead-letter-queue",children:"Anti-Pattern 1: No Dead Letter Queue"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Novice thinking"}),': "Retry 3 times, then fail silently"']}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),": Failed jobs disappear with no visibility or recovery path."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// BullMQ with dead letter queue\nconst queue = new Queue('email-queue', {\n  connection: redis,\n  defaultJobOptions: {\n    attempts: 3,\n    backoff: {\n      type: 'exponential',\n      delay: 2000\n    },\n    removeOnComplete: 100, // Keep last 100 successful\n    removeOnFail: false     // Keep all failed for inspection\n  }\n});\n\n// Monitor failed jobs\nconst failedJobs = await queue.getFailed();\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Timeline"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Pre-2020: Retry and forget"}),"\n",(0,t.jsx)(n.li,{children:"2020+: Dead letter queues standard"}),"\n",(0,t.jsx)(n.li,{children:"2024+: Observability for job failures required"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"anti-pattern-2-synchronous-job-processing",children:"Anti-Pattern 2: Synchronous Job Processing"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Symptom"}),": API endpoint waits for job completion"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u274c WRONG - Blocks API response\napp.post('/send-email', async (req, res) => {\n  await sendEmail(req.body.to, req.body.subject);\n  res.json({ success: true });\n});\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why wrong"}),": Timeout, poor UX, wastes server resources"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u2705 RIGHT - Queue and return immediately\napp.post('/send-email', async (req, res) => {\n  const job = await emailQueue.add('send', {\n    to: req.body.to,\n    subject: req.body.subject\n  });\n\n  res.json({\n    success: true,\n    jobId: job.id,\n    status: 'queued'\n  });\n});\n\n// Separate worker processes the job\nworker.process('send', async (job) => {\n  await sendEmail(job.data.to, job.data.subject);\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"anti-pattern-3-no-idempotency",children:"Anti-Pattern 3: No Idempotency"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),": Job runs twice \u2192 duplicate charges, double emails"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why it happens"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Redis connection drops mid-processing"}),"\n",(0,t.jsx)(n.li,{children:"Worker crashes before job completion"}),"\n",(0,t.jsx)(n.li,{children:"Job timeout triggers retry while still running"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Idempotent job with deduplication key\nawait queue.add('charge-payment', {\n  userId: 123,\n  amount: 50.00\n}, {\n  jobId: `payment-${orderId}`, // Prevents duplicates\n  attempts: 3\n});\n\n// In worker: Check if already processed\nworker.process('charge-payment', async (job) => {\n  const { userId, amount } = job.data;\n\n  // Check idempotency\n  const existing = await db.payments.findOne({\n    jobId: job.id\n  });\n  if (existing) {\n    return existing; // Already processed\n  }\n\n  // Process payment\n  const result = await stripe.charges.create({...});\n\n  // Store idempotency record\n  await db.payments.create({\n    jobId: job.id,\n    result\n  });\n\n  return result;\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"anti-pattern-4-no-rate-limiting",children:"Anti-Pattern 4: No Rate Limiting"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),": Overwhelm third-party APIs or exhaust quotas"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Symptom"}),': "Rate limit exceeded" errors from Sendgrid, Stripe, etc.']}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// BullMQ rate limiting\nconst queue = new Queue('api-calls', {\n  limiter: {\n    max: 100,        // Max 100 jobs\n    duration: 60000  // Per 60 seconds\n  }\n});\n\n// Or: Priority-based rate limits\nawait queue.add('send-email', data, {\n  priority: user.isPremium ? 1 : 10,\n  rateLimiter: {\n    max: user.isPremium ? 1000 : 100,\n    duration: 3600000 // Per hour\n  }\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"anti-pattern-5-forgetting-worker-scaling",children:"Anti-Pattern 5: Forgetting Worker Scaling"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),": Single worker can't keep up with queue depth"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Symptom"}),": Queue backs up, jobs delayed hours/days"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Horizontal scaling with multiple workers\nconst worker = new Worker('email-queue', async (job) => {\n  await processEmail(job.data);\n}, {\n  connection: redis,\n  concurrency: 5  // Process 5 jobs concurrently per worker\n});\n\n// Run multiple worker processes (PM2, Kubernetes, etc.)\n// Each worker processes concurrency * num_workers jobs\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Monitoring"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Set up alerts for queue depth\nsetInterval(async () => {\n  const waiting = await queue.getWaitingCount();\n  if (waiting > 1000) {\n    alert('Queue depth exceeds 1000, scale workers!');\n  }\n}, 60000);\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"implementation-patterns",children:"Implementation Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"pattern-1-email-campaigns",children:"Pattern 1: Email Campaigns"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Queue setup\nconst emailQueue = new Queue('email-campaign', { connection: redis });\n\n// Enqueue batch\nasync function sendCampaign(userIds: number[], template: string) {\n  const jobs = userIds.map(userId => ({\n    name: 'send',\n    data: { userId, template },\n    opts: {\n      attempts: 3,\n      backoff: { type: 'exponential', delay: 5000 }\n    }\n  }));\n\n  await emailQueue.addBulk(jobs);\n}\n\n// Worker with retry logic\nconst worker = new Worker('email-campaign', async (job) => {\n  const { userId, template } = job.data;\n\n  const user = await db.users.findById(userId);\n  const email = renderTemplate(template, user);\n\n  try {\n    await sendgrid.send({\n      to: user.email,\n      subject: email.subject,\n      html: email.body\n    });\n  } catch (error) {\n    if (error.code === 'ECONNREFUSED') {\n      throw error; // Retry\n    }\n    // Invalid email, don't retry\n    console.error(`Invalid email for user ${userId}`);\n  }\n}, {\n  connection: redis,\n  concurrency: 10\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"pattern-2-scheduled-reports",children:"Pattern 2: Scheduled Reports"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Daily report at 9 AM\nawait queue.add('daily-report', {\n  type: 'sales',\n  recipients: ['admin@company.com']\n}, {\n  repeat: {\n    pattern: '0 9 * * *', // Cron syntax\n    tz: 'America/New_York'\n  }\n});\n\n// Worker generates and emails report\nworker.process('daily-report', async (job) => {\n  const { type, recipients } = job.data;\n\n  const data = await generateReport(type);\n  const pdf = await createPDF(data);\n\n  await emailQueue.add('send', {\n    to: recipients,\n    subject: `Daily ${type} Report`,\n    attachments: [{ filename: 'report.pdf', content: pdf }]\n  });\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"pattern-3-video-transcoding-pipeline",children:"Pattern 3: Video Transcoding Pipeline"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Multi-stage job with progress tracking\nawait videoQueue.add('transcode', {\n  videoId: 123,\n  formats: ['720p', '1080p', '4k']\n}, {\n  attempts: 2,\n  timeout: 3600000 // 1 hour timeout\n});\n\nworker.process('transcode', async (job) => {\n  const { videoId, formats } = job.data;\n\n  for (let i = 0; i < formats.length; i++) {\n    const format = formats[i];\n\n    // Update progress\n    await job.updateProgress((i / formats.length) * 100);\n\n    // Transcode\n    await ffmpeg.transcode(videoId, format);\n  }\n\n  await job.updateProgress(100);\n});\n\n// Client polls for progress\napp.get('/videos/:id/status', async (req, res) => {\n  const job = await queue.getJob(req.params.jobId);\n  res.json({\n    state: await job.getState(),\n    progress: job.progress\n  });\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"monitoring--observability",children:"Monitoring & Observability"}),"\n",(0,t.jsx)(n.h3,{id:"essential-metrics",children:"Essential Metrics"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Queue health dashboard\nasync function getQueueMetrics() {\n  const [waiting, active, completed, failed, delayed] = await Promise.all([\n    queue.getWaitingCount(),\n    queue.getActiveCount(),\n    queue.getCompletedCount(),\n    queue.getFailedCount(),\n    queue.getDelayedCount()\n  ]);\n\n  return {\n    waiting,    // Jobs waiting to be processed\n    active,     // Jobs currently processing\n    completed,  // Successfully completed\n    failed,     // Failed after retries\n    delayed,    // Scheduled for future\n    health: waiting < 1000 && failed < 100 ? 'healthy' : 'degraded'\n  };\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"bullmq-board-ui",children:"BullMQ Board (UI)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// Development: Monitor jobs visually\nimport { createBullBoard } from '@bull-board/api';\nimport { BullMQAdapter } from '@bull-board/api/bullMQAdapter';\nimport { ExpressAdapter } from '@bull-board/express';\n\nconst serverAdapter = new ExpressAdapter();\n\ncreateBullBoard({\n  queues: [\n    new BullMQAdapter(emailQueue),\n    new BullMQAdapter(videoQueue)\n  ],\n  serverAdapter\n});\n\napp.use('/admin/queues', serverAdapter.getRouter());\n// Visit http://localhost:3000/admin/queues\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"production-checklist",children:"Production Checklist"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u25a1 Dead letter queue configured\n\u25a1 Retry strategy with exponential backoff\n\u25a1 Job timeout limits set\n\u25a1 Rate limiting for third-party APIs\n\u25a1 Idempotency keys for critical operations\n\u25a1 Worker concurrency tuned (CPU cores * 2)\n\u25a1 Horizontal scaling configured (multiple workers)\n\u25a1 Queue depth monitoring with alerts\n\u25a1 Failed job inspection workflow\n\u25a1 Job data doesn't contain PII in logs\n\u25a1 Redis persistence enabled (AOF or RDB)\n\u25a1 Graceful shutdown handling (SIGTERM)\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"when-to-use-vs-avoid",children:"When to Use vs Avoid"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Scenario"}),(0,t.jsx)(n.th,{children:"Use Background Jobs?"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Send welcome email on signup"}),(0,t.jsx)(n.td,{children:"\u2705 Yes - can take 2-5 seconds"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Charge credit card"}),(0,t.jsx)(n.td,{children:"\u26a0\ufe0f Maybe - depends on payment provider latency"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Generate PDF report (30 seconds)"}),(0,t.jsx)(n.td,{children:"\u2705 Yes - definitely background"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Fetch user profile from DB"}),(0,t.jsx)(n.td,{children:"\u274c No - milliseconds, keep synchronous"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Process video upload (5 minutes)"}),(0,t.jsx)(n.td,{children:"\u2705 Yes - always background"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Validate form input"}),(0,t.jsx)(n.td,{children:"\u274c No - synchronous validation"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Daily cron job"}),(0,t.jsx)(n.td,{children:"\u2705 Yes - use repeatable jobs"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Real-time chat message"}),(0,t.jsx)(n.td,{children:"\u274c No - use WebSockets"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"technology-comparison",children:"Technology Comparison"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Feature"}),(0,t.jsx)(n.th,{children:"BullMQ"}),(0,t.jsx)(n.th,{children:"Celery"}),(0,t.jsx)(n.th,{children:"AWS SQS"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Language"}),(0,t.jsx)(n.td,{children:"Node.js"}),(0,t.jsx)(n.td,{children:"Python"}),(0,t.jsx)(n.td,{children:"Any (HTTP API)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Backend"}),(0,t.jsx)(n.td,{children:"Redis"}),(0,t.jsx)(n.td,{children:"Redis/RabbitMQ/SQS"}),(0,t.jsx)(n.td,{children:"Managed"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Priorities"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Rate Limiting"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705 (via attributes)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Repeat/Cron"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705 (celery-beat)"}),(0,t.jsx)(n.td,{children:"\u274c (use EventBridge)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"UI Dashboard"}),(0,t.jsx)(n.td,{children:"Bull Board"}),(0,t.jsx)(n.td,{children:"Flower"}),(0,t.jsx)(n.td,{children:"CloudWatch"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Workflows"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705 (chains, groups)"}),(0,t.jsx)(n.td,{children:"\u274c"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Learning Curve"}),(0,t.jsx)(n.td,{children:"Medium"}),(0,t.jsx)(n.td,{children:"Medium"}),(0,t.jsx)(n.td,{children:"Low"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Cost"}),(0,t.jsx)(n.td,{children:"Redis hosting"}),(0,t.jsx)(n.td,{children:"Redis hosting"}),(0,t.jsx)(n.td,{children:"$0.40/million requests"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/references/bullmq-patterns.md"})," - Advanced BullMQ patterns and examples"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/references/celery-workflows.md"})," - Celery chains, groups, and chords"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/references/job-observability.md"})," - Monitoring, alerting, and debugging"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"scripts",children:"Scripts"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"scripts/setup_bullmq.sh"})," - Initialize BullMQ with Redis"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"scripts/queue_health_check.ts"})," - Queue metrics dashboard"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"scripts/retry_failed_jobs.ts"})," - Bulk retry failed jobs"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"This skill guides"}),": Background job implementation | Queue architecture | Retry strategies | Worker scaling | Job observability"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);