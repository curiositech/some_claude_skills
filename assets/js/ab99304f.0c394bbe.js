"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[95731],{28453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>l});var s=t(96540);const i={},a=s.createContext(i);function r(n){const e=s.useContext(a);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),s.createElement(a.Provider,{value:e},n.children)}},41189:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"skills/test_automation_expert/references/ci-integration","title":"CI/CD Test Integration","description":"Complete configurations for integrating tests into continuous integration pipelines.","source":"@site/docs/skills/test_automation_expert/references/ci-integration.md","sourceDirName":"skills/test_automation_expert/references","slug":"/skills/test_automation_expert/references/ci-integration","permalink":"/docs/skills/test_automation_expert/references/ci-integration","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"CI/CD Test Integration","sidebar_label":"CI/CD Test Integration","sidebar_position":1}}');var i=t(74848),a=t(28453);const r={title:"CI/CD Test Integration",sidebar_label:"CI/CD Test Integration",sidebar_position:1},l="CI/CD Test Integration",o={},c=[{value:"GitHub Actions",id:"github-actions",level:2},{value:"Complete Test Workflow",id:"complete-test-workflow",level:3},{value:"Matrix Testing (Multiple Versions)",id:"matrix-testing-multiple-versions",level:3},{value:"Parallel E2E with Sharding",id:"parallel-e2e-with-sharding",level:3},{value:"GitLab CI",id:"gitlab-ci",level:2},{value:"Complete Pipeline",id:"complete-pipeline",level:3},{value:"CircleCI",id:"circleci",level:2},{value:"Complete Config",id:"complete-config",level:3},{value:"Jenkins",id:"jenkins",level:2},{value:"Jenkinsfile",id:"jenkinsfile",level:3},{value:"Test Caching Strategies",id:"test-caching-strategies",level:2},{value:"npm/Node.js",id:"npmnodejs",level:3},{value:"pytest",id:"pytest",level:3},{value:"Flaky Test Handling",id:"flaky-test-handling",level:2},{value:"Retry Configuration",id:"retry-configuration",level:3},{value:"Quarantine Flaky Tests",id:"quarantine-flaky-tests",level:3},{value:"Notifications",id:"notifications",level:2},{value:"Slack Integration",id:"slack-integration",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Test Splitting",id:"test-splitting",level:3},{value:"Selective Testing",id:"selective-testing",level:3}];function p(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"cicd-test-integration",children:"CI/CD Test Integration"})}),"\n",(0,i.jsx)(e.p,{children:"Complete configurations for integrating tests into continuous integration pipelines."}),"\n",(0,i.jsx)(e.h2,{id:"github-actions",children:"GitHub Actions"}),"\n",(0,i.jsx)(e.h3,{id:"complete-test-workflow",children:"Complete Test Workflow"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'# .github/workflows/test.yml\nname: Tests\n\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n    branches: [main]\n\nconcurrency:\n  group: ${{ github.workflow }}-${{ github.ref }}\n  cancel-in-progress: true\n\nenv:\n  NODE_VERSION: \'20\'\n  CI: true\n\njobs:\n  # ============================================\n  # Unit & Integration Tests\n  # ============================================\n  unit-tests:\n    name: Unit Tests\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: ${{ env.NODE_VERSION }}\n          cache: \'npm\'\n\n      - name: Install dependencies\n        run: npm ci\n\n      - name: Run unit tests\n        run: npm test -- --coverage --maxWorkers=2\n\n      - name: Upload coverage\n        uses: codecov/codecov-action@v4\n        with:\n          files: ./coverage/lcov.info\n          flags: unittests\n          fail_ci_if_error: true\n\n      - name: Archive coverage report\n        uses: actions/upload-artifact@v4\n        with:\n          name: coverage-report\n          path: coverage/\n          retention-days: 7\n\n  # ============================================\n  # E2E Tests\n  # ============================================\n  e2e-tests:\n    name: E2E Tests\n    runs-on: ubuntu-latest\n    needs: unit-tests # Only run if unit tests pass\n\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: ${{ env.NODE_VERSION }}\n          cache: \'npm\'\n\n      - name: Install dependencies\n        run: npm ci\n\n      - name: Install Playwright browsers\n        run: npx playwright install --with-deps chromium firefox\n\n      - name: Build application\n        run: npm run build\n\n      - name: Run E2E tests\n        run: npx playwright test\n        env:\n          BASE_URL: http://localhost:3000\n\n      - name: Upload Playwright report\n        uses: actions/upload-artifact@v4\n        if: failure()\n        with:\n          name: playwright-report\n          path: playwright-report/\n          retention-days: 7\n\n      - name: Upload test results\n        uses: actions/upload-artifact@v4\n        if: always()\n        with:\n          name: test-results\n          path: test-results/\n          retention-days: 7\n\n  # ============================================\n  # Component Tests (Storybook)\n  # ============================================\n  component-tests:\n    name: Component Tests\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0 # For Chromatic\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: ${{ env.NODE_VERSION }}\n          cache: \'npm\'\n\n      - name: Install dependencies\n        run: npm ci\n\n      - name: Run Chromatic\n        uses: chromaui/action@latest\n        with:\n          projectToken: ${{ secrets.CHROMATIC_PROJECT_TOKEN }}\n          buildScriptName: build-storybook\n          onlyChanged: true\n\n  # ============================================\n  # Test Summary\n  # ============================================\n  test-summary:\n    name: Test Summary\n    runs-on: ubuntu-latest\n    needs: [unit-tests, e2e-tests]\n    if: always()\n\n    steps:\n      - name: Check test results\n        run: |\n          if [ "${{ needs.unit-tests.result }}" == "failure" ] || \\\n             [ "${{ needs.e2e-tests.result }}" == "failure" ]; then\n            echo "Tests failed!"\n            exit 1\n          fi\n          echo "All tests passed!"\n'})}),"\n",(0,i.jsx)(e.h3,{id:"matrix-testing-multiple-versions",children:"Matrix Testing (Multiple Versions)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"jobs:\n  test:\n    runs-on: ${{ matrix.os }}\n    strategy:\n      fail-fast: false\n      matrix:\n        os: [ubuntu-latest, windows-latest, macos-latest]\n        node: [18, 20, 22]\n        exclude:\n          - os: windows-latest\n            node: 18\n\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-node@v4\n        with:\n          node-version: ${{ matrix.node }}\n      - run: npm ci\n      - run: npm test\n"})}),"\n",(0,i.jsx)(e.h3,{id:"parallel-e2e-with-sharding",children:"Parallel E2E with Sharding"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"e2e-tests:\n  runs-on: ubuntu-latest\n  strategy:\n    fail-fast: false\n    matrix:\n      shard: [1, 2, 3, 4]\n\n  steps:\n    - uses: actions/checkout@v4\n    - uses: actions/setup-node@v4\n    - run: npm ci\n    - run: npx playwright install --with-deps\n\n    - name: Run tests (shard ${{ matrix.shard }}/4)\n      run: npx playwright test --shard=${{ matrix.shard }}/4\n"})}),"\n",(0,i.jsx)(e.h2,{id:"gitlab-ci",children:"GitLab CI"}),"\n",(0,i.jsx)(e.h3,{id:"complete-pipeline",children:"Complete Pipeline"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'# .gitlab-ci.yml\nstages:\n  - install\n  - test\n  - e2e\n  - report\n\nvariables:\n  NODE_VERSION: "20"\n  npm_config_cache: "$CI_PROJECT_DIR/.npm"\n\ncache:\n  key:\n    files:\n      - package-lock.json\n  paths:\n    - .npm/\n    - node_modules/\n\n# ============================================\n# Install Stage\n# ============================================\ninstall:\n  stage: install\n  image: node:${NODE_VERSION}\n  script:\n    - npm ci\n  artifacts:\n    paths:\n      - node_modules/\n    expire_in: 1 hour\n\n# ============================================\n# Test Stage\n# ============================================\nunit-tests:\n  stage: test\n  image: node:${NODE_VERSION}\n  needs: [install]\n  script:\n    - npm test -- --coverage\n  coverage: \'/All files[^|]*\\|[^|]*\\s+([\\d\\.]+)/\'\n  artifacts:\n    when: always\n    paths:\n      - coverage/\n    reports:\n      junit: junit.xml\n      coverage_report:\n        coverage_format: cobertura\n        path: coverage/cobertura-coverage.xml\n\nlint:\n  stage: test\n  image: node:${NODE_VERSION}\n  needs: [install]\n  script:\n    - npm run lint\n    - npm run typecheck\n\n# ============================================\n# E2E Stage\n# ============================================\ne2e-tests:\n  stage: e2e\n  image: mcr.microsoft.com/playwright:v1.40.0-jammy\n  needs: [unit-tests]\n  script:\n    - npm ci\n    - npm run build\n    - npx playwright test\n  artifacts:\n    when: always\n    paths:\n      - playwright-report/\n      - test-results/\n    expire_in: 1 week\n\n# ============================================\n# Report Stage\n# ============================================\npages:\n  stage: report\n  needs: [unit-tests, e2e-tests]\n  script:\n    - mkdir public\n    - cp -r coverage/ public/coverage\n    - cp -r playwright-report/ public/e2e\n  artifacts:\n    paths:\n      - public\n  only:\n    - main\n'})}),"\n",(0,i.jsx)(e.h2,{id:"circleci",children:"CircleCI"}),"\n",(0,i.jsx)(e.h3,{id:"complete-config",children:"Complete Config"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'# .circleci/config.yml\nversion: 2.1\n\norbs:\n  node: circleci/node@5.1.0\n  browser-tools: circleci/browser-tools@1.4.6\n\nexecutors:\n  node-executor:\n    docker:\n      - image: cimg/node:20.10\n    working_directory: ~/project\n\ncommands:\n  install-deps:\n    steps:\n      - restore_cache:\n          keys:\n            - npm-deps-{{ checksum "package-lock.json" }}\n      - run: npm ci\n      - save_cache:\n          key: npm-deps-{{ checksum "package-lock.json" }}\n          paths:\n            - node_modules\n\njobs:\n  # ============================================\n  # Unit Tests\n  # ============================================\n  unit-tests:\n    executor: node-executor\n    steps:\n      - checkout\n      - install-deps\n      - run:\n          name: Run unit tests\n          command: npm test -- --coverage --ci\n      - store_test_results:\n          path: test-results\n      - store_artifacts:\n          path: coverage\n          destination: coverage\n      - run:\n          name: Upload coverage\n          command: bash <(curl -s https://codecov.io/bash)\n\n  # ============================================\n  # E2E Tests\n  # ============================================\n  e2e-tests:\n    executor: node-executor\n    parallelism: 4\n    steps:\n      - checkout\n      - install-deps\n      - run:\n          name: Install Playwright\n          command: npx playwright install --with-deps\n      - run:\n          name: Build app\n          command: npm run build\n      - run:\n          name: Run E2E tests\n          command: |\n            SHARD="$((${CIRCLE_NODE_INDEX}+1))"\n            npx playwright test --shard=${SHARD}/${CIRCLE_NODE_TOTAL}\n      - store_artifacts:\n          path: playwright-report\n          destination: playwright-report\n      - store_test_results:\n          path: test-results\n\n  # ============================================\n  # Integration Tests (with services)\n  # ============================================\n  integration-tests:\n    docker:\n      - image: cimg/node:20.10\n      - image: postgres:15\n        environment:\n          POSTGRES_DB: test\n          POSTGRES_USER: test\n          POSTGRES_PASSWORD: test\n      - image: redis:7\n    steps:\n      - checkout\n      - install-deps\n      - run:\n          name: Wait for services\n          command: dockerize -wait tcp://localhost:5432 -wait tcp://localhost:6379 -timeout 30s\n      - run:\n          name: Run integration tests\n          command: npm run test:integration\n          environment:\n            DATABASE_URL: postgres://test:test@localhost:5432/test\n            REDIS_URL: redis://localhost:6379\n\nworkflows:\n  test:\n    jobs:\n      - unit-tests\n      - integration-tests:\n          requires:\n            - unit-tests\n      - e2e-tests:\n          requires:\n            - unit-tests\n'})}),"\n",(0,i.jsx)(e.h2,{id:"jenkins",children:"Jenkins"}),"\n",(0,i.jsx)(e.h3,{id:"jenkinsfile",children:"Jenkinsfile"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-groovy",children:"// Jenkinsfile\npipeline {\n    agent {\n        docker {\n            image 'node:20'\n        }\n    }\n\n    environment {\n        CI = 'true'\n        npm_config_cache = \"${WORKSPACE}/.npm\"\n    }\n\n    stages {\n        stage('Install') {\n            steps {\n                sh 'npm ci'\n            }\n        }\n\n        stage('Test') {\n            parallel {\n                stage('Unit Tests') {\n                    steps {\n                        sh 'npm test -- --coverage --ci'\n                    }\n                    post {\n                        always {\n                            junit 'junit.xml'\n                            publishHTML([\n                                reportDir: 'coverage/lcov-report',\n                                reportFiles: 'index.html',\n                                reportName: 'Coverage Report'\n                            ])\n                        }\n                    }\n                }\n\n                stage('Lint') {\n                    steps {\n                        sh 'npm run lint'\n                    }\n                }\n            }\n        }\n\n        stage('E2E Tests') {\n            agent {\n                docker {\n                    image 'mcr.microsoft.com/playwright:v1.40.0-jammy'\n                }\n            }\n            steps {\n                sh 'npm ci'\n                sh 'npm run build'\n                sh 'npx playwright test'\n            }\n            post {\n                always {\n                    publishHTML([\n                        reportDir: 'playwright-report',\n                        reportFiles: 'index.html',\n                        reportName: 'Playwright Report'\n                    ])\n                }\n            }\n        }\n    }\n\n    post {\n        failure {\n            slackSend(\n                color: 'danger',\n                message: \"Build Failed: ${env.JOB_NAME} #${env.BUILD_NUMBER}\"\n            )\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"test-caching-strategies",children:"Test Caching Strategies"}),"\n",(0,i.jsx)(e.h3,{id:"npmnodejs",children:"npm/Node.js"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# GitHub Actions\n- uses: actions/cache@v4\n  with:\n    path: |\n      ~/.npm\n      node_modules\n    key: npm-${{ hashFiles('package-lock.json') }}\n    restore-keys: npm-\n\n# Playwright browsers\n- uses: actions/cache@v4\n  with:\n    path: ~/.cache/ms-playwright\n    key: playwright-${{ hashFiles('package-lock.json') }}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"pytest",children:"pytest"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"- uses: actions/cache@v4\n  with:\n    path: |\n      ~/.cache/pip\n      .pytest_cache\n    key: pytest-${{ hashFiles('requirements.txt') }}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"flaky-test-handling",children:"Flaky Test Handling"}),"\n",(0,i.jsx)(e.h3,{id:"retry-configuration",children:"Retry Configuration"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# GitHub Actions\n- name: Run tests with retry\n  uses: nick-fields/retry@v2\n  with:\n    max_attempts: 3\n    timeout_minutes: 10\n    command: npm test\n\n# Playwright built-in\n- name: Run E2E with retries\n  run: npx playwright test --retries=2\n"})}),"\n",(0,i.jsx)(e.h3,{id:"quarantine-flaky-tests",children:"Quarantine Flaky Tests"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-javascript",children:"// Mark flaky tests for tracking\ntest.describe('Flaky Feature', () => {\n  test.fixme('sometimes fails due to race condition', async () => {\n    // Test code\n  });\n});\n\n// Or skip in CI only\ntest('flaky test', async () => {\n  test.skip(process.env.CI, 'Flaky in CI - JIRA-123');\n});\n"})}),"\n",(0,i.jsx)(e.h2,{id:"notifications",children:"Notifications"}),"\n",(0,i.jsx)(e.h3,{id:"slack-integration",children:"Slack Integration"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'# GitHub Actions\n- name: Notify Slack on failure\n  if: failure()\n  uses: slackapi/slack-github-action@v1\n  with:\n    payload: |\n      {\n        "text": "\u274c Tests failed on ${{ github.ref }}",\n        "blocks": [\n          {\n            "type": "section",\n            "text": {\n              "type": "mrkdwn",\n              "text": "*Test Failure*\\n\u2022 Repository: ${{ github.repository }}\\n\u2022 Branch: ${{ github.ref }}\\n\u2022 Commit: ${{ github.sha }}"\n            }\n          }\n        ]\n      }\n  env:\n    SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,i.jsx)(e.h3,{id:"test-splitting",children:"Test Splitting"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# Dynamic test splitting based on timing\n- name: Run tests with timing\n  run: |\n    npx jest --listTests --json > tests.json\n    npx jest $(cat tests.json | jq -r '.[] | select(. | test(\"unit\"))' | head -n $(($(cat tests.json | jq length) / 4)))\n"})}),"\n",(0,i.jsx)(e.h3,{id:"selective-testing",children:"Selective Testing"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# Only run affected tests\n- uses: dorny/paths-filter@v2\n  id: changes\n  with:\n    filters: |\n      src:\n        - 'src/**'\n      tests:\n        - 'tests/**'\n\n- name: Run tests if source changed\n  if: steps.changes.outputs.src == 'true'\n  run: npm test\n"})})]})}function u(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(p,{...n})}):p(n)}}}]);