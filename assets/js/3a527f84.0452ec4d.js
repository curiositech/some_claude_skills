"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[16117],{28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var r=s(96540);const i={},l=r.createContext(i);function t(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(l.Provider,{value:n},e.children)}},72124:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"skills/fullstack_debugger/index","title":"Fullstack Debugger","description":"Expert debugger for Next.js + Cloudflare Workers + Supabase stacks. Systematic troubleshooting for auth, caching, workers, RLS, CORS, and build issues. Activate on: \'debug\', \'not working\', \'error\', \'broken\', \'500\', \'401\', \'403\', \'cache issue\', \'RLS\', \'CORS\'. NOT for: feature development (use language skills), architecture design (use system-architect).","source":"@site/docs/skills/fullstack_debugger/index.md","sourceDirName":"skills/fullstack_debugger","slug":"/skills/fullstack_debugger/","permalink":"/docs/skills/fullstack_debugger/","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"debugging","permalink":"/docs/tags/debugging"},{"inline":true,"label":"nextjs","permalink":"/docs/tags/nextjs"},{"inline":true,"label":"cloudflare-workers","permalink":"/docs/tags/cloudflare-workers"},{"inline":true,"label":"supabase","permalink":"/docs/tags/supabase"},{"inline":true,"label":"troubleshooting","permalink":"/docs/tags/troubleshooting"}],"version":"current","frontMatter":{"name":"fullstack-debugger","description":"Expert debugger for Next.js + Cloudflare Workers + Supabase stacks. Systematic troubleshooting for auth, caching, workers, RLS, CORS, and build issues. Activate on: \'debug\', \'not working\', \'error\', \'broken\', \'500\', \'401\', \'403\', \'cache issue\', \'RLS\', \'CORS\'. NOT for: feature development (use language skills), architecture design (use system-architect).","allowed-tools":"Read,Write,Edit,Bash,Grep,Glob,WebFetch,mcp__supabase__*,mcp__playwright__*","category":"Debugging & Troubleshooting","tags":["debugging","nextjs","cloudflare-workers","supabase","troubleshooting"],"pairs-with":[{"skill":"devops-automator","reason":"Deployment and infrastructure issues"},{"skill":"site-reliability-engineer","reason":"Production incidents"}]}}');var i=s(74848),l=s(28453);const t={name:"fullstack-debugger",description:"Expert debugger for Next.js + Cloudflare Workers + Supabase stacks. Systematic troubleshooting for auth, caching, workers, RLS, CORS, and build issues. Activate on: 'debug', 'not working', 'error', 'broken', '500', '401', '403', 'cache issue', 'RLS', 'CORS'. NOT for: feature development (use language skills), architecture design (use system-architect).","allowed-tools":"Read,Write,Edit,Bash,Grep,Glob,WebFetch,mcp__supabase__*,mcp__playwright__*",category:"Debugging & Troubleshooting",tags:["debugging","nextjs","cloudflare-workers","supabase","troubleshooting"],"pairs-with":[{skill:"devops-automator",reason:"Deployment and infrastructure issues"},{skill:"site-reliability-engineer",reason:"Production incidents"}]},o="Fullstack Debugger",a={},c=[{value:"Activation Triggers",id:"activation-triggers",level:2},{value:"Debug Philosophy",id:"debug-philosophy",level:2},{value:"Architecture Layers",id:"architecture-layers",level:2},{value:"Quick Diagnosis Commands",id:"quick-diagnosis-commands",level:2},{value:"Check Everything At Once",id:"check-everything-at-once",level:3},{value:"Supabase RLS Diagnosis",id:"supabase-rls-diagnosis",level:3},{value:"Worker Health Check",id:"worker-health-check",level:3},{value:"Cache Inspection",id:"cache-inspection",level:3},{value:"Common Issues &amp; Solutions",id:"common-issues--solutions",level:2},{value:"1. RLS Policy Blocking Data (Most Common!)",id:"1-rls-policy-blocking-data-most-common",level:3},{value:"2. CORS Errors",id:"2-cors-errors",level:3},{value:"3. Auth State Not Persisting",id:"3-auth-state-not-persisting",level:3},{value:"4. Hydration Mismatch",id:"4-hydration-mismatch",level:3},{value:"5. Worker Not Deploying",id:"5-worker-not-deploying",level:3},{value:"6. TypeScript Cache Haunting",id:"6-typescript-cache-haunting",level:3},{value:"7. Static Export Issues",id:"7-static-export-issues",level:3},{value:"8. Rate Limiting Issues",id:"8-rate-limiting-issues",level:3},{value:"9. Meeting/Location Data Issues",id:"9-meetinglocation-data-issues",level:3},{value:"10. Build Fails on Cloudflare Pages",id:"10-build-fails-on-cloudflare-pages",level:3},{value:"Debug Scripts",id:"debug-scripts",level:2},{value:"<code>scripts/diagnose.sh</code>",id:"scriptsdiagnosesh",level:3},{value:"<code>scripts/check-rls.js</code>",id:"scriptscheck-rlsjs",level:3},{value:"Validation Checklist",id:"validation-checklist",level:2},{value:"Output",id:"output",level:2},{value:"Tools Available",id:"tools-available",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"fullstack-debugger",children:"Fullstack Debugger"})}),"\n",(0,i.jsx)(n.p,{children:"Expert debugger for modern web stacks: Next.js 15, Cloudflare Workers, Supabase, and edge deployments. Systematic, evidence-based troubleshooting."}),"\n",(0,i.jsx)(n.h2,{id:"activation-triggers",children:"Activation Triggers"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Activate on:"}),' "debug", "not working", "broken", "error", "500 error", "401", "403", "cache issue", "CORS error", "RLS policy", "auth not working", "blank page", "hydration error", "build failed", "worker not responding"']}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"NOT for:"})," Feature development \u2192 language skills | Architecture \u2192 ",(0,i.jsx)(n.code,{children:"system-architect"})," | Performance optimization \u2192 ",(0,i.jsx)(n.code,{children:"performance-engineer"})]}),"\n",(0,i.jsx)(n.h2,{id:"debug-philosophy",children:"Debug Philosophy"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"1. REPRODUCE \u2192 Can you make it fail consistently?\n2. ISOLATE   \u2192 Which layer is broken?\n3. EVIDENCE  \u2192 What do logs/network/state show?\n4. HYPOTHESIZE \u2192 What could cause this?\n5. TEST      \u2192 Validate one hypothesis at a time\n6. FIX       \u2192 Minimal change that resolves issue\n7. VERIFY    \u2192 Confirm fix doesn't break other things\n"})}),"\n",(0,i.jsx)(n.h2,{id:"architecture-layers",children:"Architecture Layers"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    DEBUGGING LAYERS                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                             \u2502\n\u2502  Layer 1: Browser/Client                                    \u2502\n\u2502  \u251c\u2500\u2500 Console errors, network tab, React DevTools           \u2502\n\u2502  \u251c\u2500\u2500 localStorage/sessionStorage state                     \u2502\n\u2502  \u2514\u2500\u2500 React Query cache state                               \u2502\n\u2502                                                             \u2502\n\u2502  Layer 2: Next.js Application                              \u2502\n\u2502  \u251c\u2500\u2500 Server components vs client components                \u2502\n\u2502  \u251c\u2500\u2500 Build output and static generation                    \u2502\n\u2502  \u251c\u2500\u2500 API routes (if any)                                   \u2502\n\u2502  \u2514\u2500\u2500 Hydration mismatches                                  \u2502\n\u2502                                                             \u2502\n\u2502  Layer 3: Cloudflare Workers                               \u2502\n\u2502  \u251c\u2500\u2500 Worker logs (wrangler tail)                           \u2502\n\u2502  \u251c\u2500\u2500 KV cache state                                        \u2502\n\u2502  \u251c\u2500\u2500 CORS headers                                          \u2502\n\u2502  \u2514\u2500\u2500 Rate limiting                                         \u2502\n\u2502                                                             \u2502\n\u2502  Layer 4: Supabase                                         \u2502\n\u2502  \u251c\u2500\u2500 Auth state and JWT tokens                             \u2502\n\u2502  \u251c\u2500\u2500 RLS policies (most common issue!)                     \u2502\n\u2502  \u251c\u2500\u2500 Database queries and indexes                          \u2502\n\u2502  \u2514\u2500\u2500 Realtime subscriptions                                \u2502\n\u2502                                                             \u2502\n\u2502  Layer 5: External APIs                                    \u2502\n\u2502  \u251c\u2500\u2500 Third-party service availability                      \u2502\n\u2502  \u251c\u2500\u2500 API rate limits                                       \u2502\n\u2502  \u2514\u2500\u2500 Response format changes                               \u2502\n\u2502                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(n.h2,{id:"quick-diagnosis-commands",children:"Quick Diagnosis Commands"}),"\n",(0,i.jsx)(n.h3,{id:"check-everything-at-once",children:"Check Everything At Once"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Run from next-app/ directory\necho "=== Build Check ===" && npm run build 2>&1 | tail -20\necho "=== TypeScript ===" && npx tsc --noEmit 2>&1 | head -20\necho "=== Lint ===" && npm run lint 2>&1 | head -20\necho "=== Git Status ===" && git status --short\n'})}),"\n",(0,i.jsx)(n.h3,{id:"supabase-rls-diagnosis",children:"Supabase RLS Diagnosis"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check if RLS is blocking queries (most common issue!)\nnode -e \"\nconst { createClient } = require('@supabase/supabase-js');\nconst supabase = createClient(\n  'YOUR_SUPABASE_URL',\n  'YOUR_ANON_KEY'\n);\n\nasync function diagnose() {\n  // Test as anonymous user\n  const { data, error, count } = await supabase\n    .from('YOUR_TABLE')\n    .select('*', { count: 'exact' })\n    .limit(5);\n\n  console.log('Error:', error);\n  console.log('Count:', count);\n  console.log('Sample:', data);\n}\ndiagnose();\n\"\n"})}),"\n",(0,i.jsx)(n.h3,{id:"worker-health-check",children:"Worker Health Check"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Check if workers are responding\ncurl -s -o /dev/null -w "%{http_code}" https://YOUR-WORKER.workers.dev/health\n\n# Check CORS headers\ncurl -s -D - -o /dev/null -H "Origin: https://yoursite.com" \\\n  https://YOUR-WORKER.workers.dev/api/endpoint | grep -iE "(access-control|x-)"\n\n# Stream worker logs\ncd workers/your-worker && npx wrangler tail\n'})}),"\n",(0,i.jsx)(n.h3,{id:"cache-inspection",children:"Cache Inspection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Check Cloudflare KV cache\nnpx wrangler kv:key list --namespace-id=YOUR_NAMESPACE_ID | head -20\n\n# Get specific cached value\nnpx wrangler kv:key get --namespace-id=YOUR_NAMESPACE_ID "cache:key"\n\n# Clear a cached item\nnpx wrangler kv:key delete --namespace-id=YOUR_NAMESPACE_ID "cache:key"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"common-issues--solutions",children:"Common Issues & Solutions"}),"\n",(0,i.jsx)(n.h3,{id:"1-rls-policy-blocking-data-most-common",children:"1. RLS Policy Blocking Data (Most Common!)"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Query returns empty array but no error"}),"\n",(0,i.jsx)(n.li,{children:"Works in Supabase dashboard but not in app"}),"\n",(0,i.jsx)(n.li,{children:"Works for some users but not others"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Diagnosis:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- In Supabase SQL Editor\n-- Check what policies exist\nSELECT schemaname, tablename, policyname, permissive, roles, cmd, qual\nFROM pg_policies\nWHERE tablename = 'your_table';\n\n-- Test as anonymous user\nSET ROLE anon;\nSELECT * FROM your_table LIMIT 5;\nRESET ROLE;\n\n-- Test as authenticated user\nSET ROLE authenticated;\nSET request.jwt.claims = '{\"sub\": \"user-uuid-here\"}';\nSELECT * FROM your_table LIMIT 5;\nRESET ROLE;\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Common Fixes:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'-- Allow public read access\nCREATE POLICY "Allow public read" ON your_table\n  FOR SELECT USING (true);\n\n-- Allow authenticated users to read\nCREATE POLICY "Allow authenticated read" ON your_table\n  FOR SELECT TO authenticated USING (true);\n\n-- Allow users to read their own data\nCREATE POLICY "Users read own data" ON your_table\n  FOR SELECT USING (auth.uid() = user_id);\n'})}),"\n",(0,i.jsx)(n.h3,{id:"2-cors-errors",children:"2. CORS Errors"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'"Access to fetch blocked by CORS policy"'}),"\n",(0,i.jsx)(n.li,{children:"Works in Postman but not in browser"}),"\n",(0,i.jsx)(n.li,{children:"Preflight request fails"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Diagnosis:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Check what CORS headers are returned\ncurl -s -D - -o /dev/null \\\n  -H "Origin: https://yoursite.com" \\\n  -H "Access-Control-Request-Method: POST" \\\n  -X OPTIONS \\\n  https://your-worker.workers.dev/api/endpoint\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix in Cloudflare Worker:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// In your worker\nconst corsHeaders = {\n  'Access-Control-Allow-Origin': '*', // Or specific domain\n  'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n  'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n};\n\n// Handle preflight\nif (request.method === 'OPTIONS') {\n  return new Response(null, { headers: corsHeaders });\n}\n\n// Add to all responses\nreturn new Response(data, {\n  headers: { ...corsHeaders, 'Content-Type': 'application/json' }\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-auth-state-not-persisting",children:"3. Auth State Not Persisting"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User logged in but shows as logged out on refresh"}),"\n",(0,i.jsx)(n.li,{children:"Auth works locally but not in production"}),"\n",(0,i.jsx)(n.li,{children:"Session disappears randomly"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Diagnosis:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// In browser console\nconsole.log('Session:', await supabase.auth.getSession());\nconsole.log('User:', await supabase.auth.getUser());\nconsole.log('LocalStorage:', Object.keys(localStorage).filter(k => k.includes('supabase')));\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Common Fixes:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Check Supabase URL matches (http vs https, trailing slash)"}),"\n",(0,i.jsx)(n.li,{children:"Verify site URL in Supabase Auth settings"}),"\n",(0,i.jsx)(n.li,{children:"Check for cookie blocking (Safari, incognito)"}),"\n",(0,i.jsx)(n.li,{children:"Ensure AuthContext wraps all components needing auth"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"4-hydration-mismatch",children:"4. Hydration Mismatch"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'"Hydration failed because the initial UI does not match"'}),"\n",(0,i.jsx)(n.li,{children:"Content flashes on page load"}),"\n",(0,i.jsx)(n.li,{children:"Different content on server vs client"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Diagnosis:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Temporarily add to suspect component\nuseEffect(() => {\n  console.log('Client render:', document.body.innerHTML.slice(0, 500));\n}, []);\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Common Fixes:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Use client-only rendering for dynamic content\n'use client';\nimport { useState, useEffect } from 'react';\n\nfunction DynamicContent() {\n  const [mounted, setMounted] = useState(false);\n  useEffect(() => setMounted(true), []);\n  if (!mounted) return null; // or skeleton\n  return <div>{/* dynamic content */}</div>;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"5-worker-not-deploying",children:"5. Worker Not Deploying"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Deploy command succeeds but changes not reflected"}),"\n",(0,i.jsx)(n.li,{children:"Old code still running"}),"\n",(0,i.jsx)(n.li,{children:"Intermittent old/new behavior"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Diagnosis:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check deployment status\nnpx wrangler deployments list\n\n# View current worker code\nnpx wrangler deployments view\n\n# Check for multiple environments\nnpx wrangler whoami\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fixes:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Force redeploy\nnpx wrangler deploy --force\n\n# Clear Cloudflare cache\ncurl -X POST "https://api.cloudflare.com/client/v4/zones/ZONE_ID/purge_cache" \\\n  -H "Authorization: Bearer YOUR_TOKEN" \\\n  -H "Content-Type: application/json" \\\n  --data \'{"purge_everything":true}\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"6-typescript-cache-haunting",children:"6. TypeScript Cache Haunting"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Errors reference deleted/changed code"}),"\n",(0,i.jsx)(n.li,{children:"Types don't match current code"}),"\n",(0,i.jsx)(n.li,{children:'"Cannot find module" for existing files'}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fix:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Nuclear option - clear all caches\nrm -rf .next node_modules/.cache tsconfig.tsbuildinfo\nnpm run build\n\n# Or just TypeScript cache\nrm -rf node_modules/.cache/typescript\nnpx tsc --build --clean\n"})}),"\n",(0,i.jsx)(n.h3,{id:"7-static-export-issues",children:"7. Static Export Issues"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'"Error: Page X couldn\'t be rendered statically"'}),"\n",(0,i.jsx)(n.li,{children:"Dynamic routes fail in static export"}),"\n",(0,i.jsx)(n.li,{children:"API routes don't work after deploy"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Diagnosis:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Check next.config for output mode\ngrep -A5 "output:" next.config.ts\n\n# Find dynamic components\ngrep -r "useSearchParams\\|usePathname\\|cookies()\\|headers()" src/\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fixes:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// For components using dynamic APIs\nexport const dynamic = 'force-dynamic';\n// or wrap in Suspense with fallback\n\n// For generateStaticParams\nexport async function generateStaticParams() {\n  return [{ slug: 'page1' }, { slug: 'page2' }];\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"8-rate-limiting-issues",children:"8. Rate Limiting Issues"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"429 errors after several requests"}),"\n",(0,i.jsx)(n.li,{children:"Works initially then stops"}),"\n",(0,i.jsx)(n.li,{children:"Different behavior per IP"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Diagnosis:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check rate limit headers\ncurl -i https://your-worker.workers.dev/api/endpoint 2>&1 | grep -i ratelimit\n\n# Check KV for rate limit keys\nnpx wrangler kv:key list --namespace-id=RATE_LIMIT_KV_ID | grep rate\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fixes:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Clear rate limit for an IP\nnpx wrangler kv:key delete --namespace-id=RATE_LIMIT_KV_ID "rate:192.168.1.1"\n\n# Adjust limits in wrangler.toml\nRATE_LIMIT_REQUESTS = "100"\nRATE_LIMIT_WINDOW = "3600"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"9-meetinglocation-data-issues",children:"9. Meeting/Location Data Issues"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"No meetings found in certain areas"}),"\n",(0,i.jsx)(n.li,{children:"Stale meeting data"}),"\n",(0,i.jsx)(n.li,{children:"Cache showing wrong data"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Diagnosis:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check cache status for a location\ncurl -s -D - -o /dev/null \\\n  -H \"Origin: https://yoursite.com\" \\\n  \"https://your-proxy.workers.dev/api/all?lat=45.52&lng=-122.68&radius=25\" \\\n  | grep -iE \"(x-cache|x-geohash|x-source)\"\n\n# Force cache refresh\ncurl -H \"Origin: https://yoursite.com\" \\\n  \"https://your-proxy.workers.dev/warm\"\n\n# Check Supabase for meeting count\nnode -e \"\nconst { createClient } = require('@supabase/supabase-js');\nconst supabase = createClient('URL', 'KEY');\nsupabase.from('meetings').select('*', { count: 'exact', head: true })\n  .then(({count}) => console.log('Total meetings:', count));\n\"\n"})}),"\n",(0,i.jsx)(n.h3,{id:"10-build-fails-on-cloudflare-pages",children:"10. Build Fails on Cloudflare Pages"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Symptoms:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Works locally but fails on deploy"}),"\n",(0,i.jsx)(n.li,{children:'"Module not found" errors'}),"\n",(0,i.jsx)(n.li,{children:"Memory exceeded"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Diagnosis:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Check build output locally\nNODE_ENV=production npm run build 2>&1 | tee build.log\n\n# Check for conditional imports\ngrep -r "require(" src/ --include="*.ts" --include="*.tsx"\n\n# Check bundle size\nnpx next-bundle-analyzer\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Fixes:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// next.config.ts - increase memory\nmodule.exports = {\n  experimental: {\n    memoryBasedWorkersCount: true,\n  },\n  // Reduce bundle size\n  webpack: (config) => {\n    config.externals = [...(config.externals || []), 'sharp'];\n    return config;\n  }\n};\n"})}),"\n",(0,i.jsx)(n.h2,{id:"debug-scripts",children:"Debug Scripts"}),"\n",(0,i.jsx)(n.h3,{id:"scriptsdiagnosesh",children:(0,i.jsx)(n.code,{children:"scripts/diagnose.sh"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n# Run all diagnostics\n\necho "=== Environment ==="\nnode -v && npm -v\n\necho "=== Dependencies ==="\nnpm ls --depth=0 2>&1 | grep -E "(UNMET|missing)"\n\necho "=== TypeScript ==="\nnpx tsc --noEmit 2>&1 | head -30\n\necho "=== Build ==="\nnpm run build 2>&1 | tail -30\n\necho "=== Workers ==="\nfor worker in workers/*/; do\n  echo "Worker: $worker"\n  (cd "$worker" && npx wrangler whoami 2>/dev/null)\ndone\n\necho "=== Supabase ==="\nnpx supabase status 2>/dev/null || echo "Supabase CLI not configured"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"scriptscheck-rlsjs",children:(0,i.jsx)(n.code,{children:"scripts/check-rls.js"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// Check RLS policies are working correctly\nconst { createClient } = require('@supabase/supabase-js');\n\nconst supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n);\n\nasync function checkTable(table) {\n  console.log(`\\n=== Checking ${table} ===`);\n  const { data, error, count } = await supabase\n    .from(table)\n    .select('*', { count: 'exact' })\n    .limit(1);\n\n  if (error) {\n    console.log(`ERROR: ${error.message}`);\n  } else {\n    console.log(`OK: ${count} rows accessible`);\n  }\n}\n\n// Check critical tables\n['profiles', 'meetings', 'forum_posts', 'journal_entries'].forEach(checkTable);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"validation-checklist",children:"Validation Checklist"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[ ] Can reproduce the issue consistently\n[ ] Identified which layer is failing (client/Next/Worker/Supabase/API)\n[ ] Checked browser console for errors\n[ ] Checked network tab for failed requests\n[ ] Checked worker logs (wrangler tail)\n[ ] Verified RLS policies allow access\n[ ] Tested with fresh browser/incognito\n[ ] Cleared all caches (browser, React Query, KV, TS)\n[ ] Checked environment variables match production\n[ ] Verified CORS headers are correct\n[ ] Tested on production URL (not just localhost)\n[ ] Created minimal reproduction case\n"})}),"\n",(0,i.jsx)(n.h2,{id:"output",children:"Output"}),"\n",(0,i.jsx)(n.p,{children:"When debugging, always provide:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Root cause"})," - What exactly was wrong"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Evidence"})," - Logs, errors, or queries that proved it"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Fix"})," - Minimal code change to resolve"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Verification"})," - How to confirm it's fixed"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Prevention"})," - How to avoid this in future"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"tools-available",children:"Tools Available"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Read"}),", ",(0,i.jsx)(n.code,{children:"Write"}),", ",(0,i.jsx)(n.code,{children:"Edit"})," - File operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Bash"})," - Run commands, curl, wrangler"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Grep"}),", ",(0,i.jsx)(n.code,{children:"Glob"})," - Search codebase"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WebFetch"})," - Test endpoints"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"mcp__supabase__*"})," - Direct Supabase operations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"mcp__playwright__*"})," - Browser automation for UI testing"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);