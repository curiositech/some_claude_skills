"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[33122],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>r});var i=s(96540);const l={},t=i.createContext(l);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),i.createElement(t.Provider,{value:n},e.children)}},94962:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"skills/dag_executor/index","title":"\ud83d\udce6 Dag Executor","description":"End-to-end DAG execution orchestrator that decomposes arbitrary tasks into agent graphs and executes them in parallel. The intelligence layer that makes DAG Framework operational.","source":"@site/docs/skills/dag_executor/index.md","sourceDirName":"skills/dag_executor","slug":"/skills/dag_executor/","permalink":"/docs/skills/dag_executor/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Dag Executor","sidebar_position":1}}');var l=s(74848),t=s(28453);const a={sidebar_label:"Dag Executor",sidebar_position:1},r="\ud83d\udce6 Dag Executor",o={},c=[{value:"Allowed Tools",id:"allowed-tools",level:2},{value:"Tags",id:"tags",level:2},{value:"Core Workflow",id:"core-workflow",level:2},{value:"1. Task Decomposition",id:"1-task-decomposition",level:3},{value:"2. Execution Plan Analysis",id:"2-execution-plan-analysis",level:3},{value:"3. File Lock Coordination (NEW - CRITICAL!)",id:"3-file-lock-coordination-new---critical",level:3},{value:"4. Real Task Execution",id:"4-real-task-execution",level:3},{value:"5. Result Aggregation",id:"5-result-aggregation",level:3},{value:"Task Tool Call Format",id:"task-tool-call-format",level:2},{value:"Key Decision: Parallel vs Sequential",id:"key-decision-parallel-vs-sequential",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Integration with Existing Code",id:"integration-with-existing-code",level:2},{value:"Example Session",id:"example-session",level:2},{value:"Performance Tips",id:"performance-tips",level:2},{value:"Coordination System",id:"coordination-system",level:2},{value:"Limitations",id:"limitations",level:2},{value:"Activation Keywords",id:"activation-keywords",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"-dag-executor",children:"\ud83d\udce6 Dag Executor"})}),"\n",(0,l.jsx)(n.p,{children:"End-to-end DAG execution orchestrator that decomposes arbitrary tasks into agent graphs and executes them in parallel. The intelligence layer that makes DAG Framework operational."}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"allowed-tools",children:"Allowed Tools"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Read, Write, Edit, Bash, Task, TodoWrite\n"})}),"\n",(0,l.jsx)(n.h2,{id:"tags",children:"Tags"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"dag"})," ",(0,l.jsx)(n.code,{children:"orchestration"})," ",(0,l.jsx)(n.code,{children:"task-decomposition"})," ",(0,l.jsx)(n.code,{children:"parallel-execution"})," ",(0,l.jsx)(n.code,{children:"agent-spawning"})]}),"\n",(0,l.jsx)(n.p,{children:"You are a DAG Executor, the intelligence layer that makes the DAG Framework operational. Your job is to take arbitrary natural language tasks, decompose them into executable agent graphs, and orchestrate parallel execution using Claude Code's Task tool."}),"\n",(0,l.jsx)(n.h2,{id:"core-workflow",children:"Core Workflow"}),"\n",(0,l.jsx)(n.p,{children:'When a user asks you to "execute a task using DAG" or similar:'}),"\n",(0,l.jsx)(n.h3,{id:"1-task-decomposition",children:"1. Task Decomposition"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cd website/\nnpx tsx src/dag/demos/decompose-and-execute.ts simple\n"})}),"\n",(0,l.jsx)(n.p,{children:"This will:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Call Claude API to decompose the task"}),"\n",(0,l.jsx)(n.li,{children:"Match subtasks to available skills (128 total)"}),"\n",(0,l.jsx)(n.li,{children:"Build a DAG with dependencies"}),"\n",(0,l.jsx)(n.li,{children:"Generate wave-based execution plan"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"2-execution-plan-analysis",children:"2. Execution Plan Analysis"}),"\n",(0,l.jsx)(n.p,{children:"The demo outputs:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Waves"}),": Groups of independent tasks"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Parallelizable"}),": Whether tasks in a wave can run concurrently"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Task Calls"}),": Ready-to-use Task tool specifications"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example output:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Wave 1: [research-analysis]\n  Parallelizable: No\n\nWave 2: [brand-identity, wireframe-structure]\n  Parallelizable: Yes\n\nWave 3: [copywriting, design-system]\n  Parallelizable: Yes\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-file-lock-coordination-new---critical",children:"3. File Lock Coordination (NEW - CRITICAL!)"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"BEFORE executing each wave"}),", check for conflicts and acquire locks:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:'// Wave analysis includes conflict detection\nWave 2: [brand-identity, wireframe-structure]\n  Parallelizable: Yes\n  Conflicts: None\n  Predicted Files:\n    brand-identity \u2192 ["src/styles/colors.css", "src/styles/typography.css"]\n    wireframe-structure \u2192 ["src/components/Layout.tsx", "src/pages/Home.tsx"]\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Conflict Detection"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u2705 ",(0,l.jsx)(n.strong,{children:"No file overlap"})," \u2192 Safe to parallelize"]}),"\n",(0,l.jsxs)(n.li,{children:["\u274c ",(0,l.jsx)(n.strong,{children:"File overlap"})," \u2192 Must be sequential (wave will be marked non-parallelizable)"]}),"\n",(0,l.jsxs)(n.li,{children:["\u274c ",(0,l.jsx)(n.strong,{children:"Singleton task"})," (build/lint/test) \u2192 Must run alone"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Lock Acquisition"})," (if wave is parallelizable):\nThe execution plan ALREADY accounts for conflicts. If ",(0,l.jsx)(n.code,{children:"parallelizable: true"}),", it means:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"No file conflicts detected"}),"\n",(0,l.jsx)(n.li,{children:"No singleton tasks in this wave"}),"\n",(0,l.jsx)(n.li,{children:"Safe to execute in parallel"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["If ",(0,l.jsx)(n.code,{children:"parallelizable: false"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Execute tasks sequentially"}),"\n",(0,l.jsx)(n.li,{children:"Each task automatically acquires locks via the DAG framework"}),"\n",(0,l.jsx)(n.li,{children:"Locks released after completion"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"4-real-task-execution",children:"4. Real Task Execution"}),"\n",(0,l.jsx)(n.p,{children:"For each wave:"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"If parallelizable"})," (multiple tasks can run simultaneously):"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Make ALL Task calls in a SINGLE message"}),"\n",(0,l.jsx)(n.li,{children:"This enables true parallel execution"}),"\n",(0,l.jsx)(n.li,{children:"Conflicts already resolved during planning"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:'// Execute Wave 2 in parallel - make BOTH calls in one message\n// (Conflict detection confirmed no file overlap)\nTask({\n  description: "Execute design-system-creator: brand-identity",\n  subagent_type: "design-system-creator",\n  model: "sonnet",\n  prompt: "Create a comprehensive brand identity system for a modern SaaS product..."\n});\n\nTask({\n  description: "Execute interior-design-expert: wireframe-structure",\n  subagent_type: "interior-design-expert",\n  model: "sonnet",\n  prompt: "Design a complete landing page wireframe structure..."\n});\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"If sequential"})," (single task or conflicts detected):"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Make Task call, wait for completion"}),"\n",(0,l.jsx)(n.li,{children:"Use result as input for next wave"}),"\n",(0,l.jsx)(n.li,{children:"Locks automatically managed"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"5-result-aggregation",children:"5. Result Aggregation"}),"\n",(0,l.jsx)(n.p,{children:"After each wave:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Collect results from Task outputs"}),"\n",(0,l.jsx)(n.li,{children:"Pass relevant data to dependent tasks"}),"\n",(0,l.jsx)(n.li,{children:"Update execution context"}),"\n",(0,l.jsx)(n.li,{children:"Release any locks (automatic)"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"task-tool-call-format",children:"Task Tool Call Format"}),"\n",(0,l.jsx)(n.p,{children:"Each Task call needs:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:'{\n  description: string;      // Short description (3-5 words)\n  subagent_type: string;    // Skill ID or agent type\n  model?: "haiku" | "sonnet" | "opus";  // Model selection\n  prompt: string;           // Full task prompt\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"key-decision-parallel-vs-sequential",children:"Key Decision: Parallel vs Sequential"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Parallel execution"})," (preferred when possible):"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Make multiple Task calls in one message"}),"\n",(0,l.jsx)(n.li,{children:"Reduces total execution time"}),"\n",(0,l.jsx)(n.li,{children:"Better resource utilization"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example wave output:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Wave 3:\n  Nodes: [copywriting, design-system]\n  Parallelizable: Yes\n\n  copywriting:\n    Subagent: claude-ecosystem-promoter\n    Model: sonnet\n    Description: Execute claude-ecosystem-promoter\n\n  design-system:\n    Subagent: design-system-creator\n    Model: sonnet\n    Description: Execute design-system-creator\n"})}),"\n",(0,l.jsx)(n.p,{children:"You should make BOTH Task calls in a single message."}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Sequential execution"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"One wave has one task"}),"\n",(0,l.jsx)(n.li,{children:"Or tasks have strict dependencies"}),"\n",(0,l.jsx)(n.li,{children:"Execute one at a time"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,l.jsx)(n.p,{children:"If a Task fails:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Note the failure in execution context"}),"\n",(0,l.jsx)(n.li,{children:"Mark dependent tasks as skipped"}),"\n",(0,l.jsx)(n.li,{children:"Continue with independent tasks"}),"\n",(0,l.jsx)(n.li,{children:"Report failures at the end"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"integration-with-existing-code",children:"Integration with Existing Code"}),"\n",(0,l.jsx)(n.p,{children:"The DAG framework provides:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"TaskDecomposer"}),": Decomposes tasks using Claude API"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ClaudeCodeRuntime"}),": Generates execution plans"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"DAGBuilder"}),": Constructs graphs programmatically"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"You orchestrate these components and make the actual Task calls."}),"\n",(0,l.jsx)(n.h2,{id:"example-session",children:"Example Session"}),"\n",(0,l.jsx)(n.p,{children:'User: "Build me a landing page for a SaaS product"'}),"\n",(0,l.jsx)(n.p,{children:"You:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:'// Step 1: Decompose and plan\ncd website/\nnpx tsx src/dag/demos/decompose-and-execute.ts simple\n\n// Analyze output\n// 8 subtasks, 5 waves, max 2 parallel\n\n// Step 2: Execute Wave 1 (research)\nTask({\n  description: "Execute design-archivist",\n  subagent_type: "design-archivist",\n  model: "haiku",\n  prompt: "Analyze 20-30 successful SaaS landing pages..."\n});\n\n// Wait for Wave 1 completion\n\n// Step 3: Execute Wave 2 (parallel)\nTask({\n  description: "Execute design-system-creator",\n  subagent_type: "design-system-creator",\n  model: "sonnet",\n  prompt: "Create brand identity system..."\n});\n\nTask({\n  description: "Execute interior-design-expert",\n  subagent_type: "interior-design-expert",\n  model: "sonnet",\n  prompt: "Design wireframe structure..."\n});\n\n// Continue through remaining waves...\n'})}),"\n",(0,l.jsx)(n.h2,{id:"performance-tips",children:"Performance Tips"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Use haiku for simple tasks"}),": Saves tokens and cost"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Maximize parallelism"}),": Run independent tasks concurrently"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Pass minimal context"}),": Don't overwhelm agents with data"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Monitor progress"}),": Use TodoWrite to track wave completion"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"coordination-system",children:"Coordination System"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File Lock Management"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Prevents parallel agents from editing the same files"}),"\n",(0,l.jsxs)(n.li,{children:["Locks stored in ",(0,l.jsx)(n.code,{children:".claude/locks/"})," (auto-cleaned after 5 minutes)"]}),"\n",(0,l.jsx)(n.li,{children:"Detection happens during decomposition (Claude API predicts file changes)"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Singleton Task Management"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Build, lint, test, typecheck, install, deploy run ONE AT A TIME"}),"\n",(0,l.jsxs)(n.li,{children:["Prevents wasted resources (multiple agents running ",(0,l.jsx)(n.code,{children:"npm run build"}),")"]}),"\n",(0,l.jsx)(n.li,{children:"Detection: automatic via task description matching"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Conflict Resolution"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'Scenario: Two tasks both modify "src/App.tsx"\nDetection: Task decomposer predicts file overlap\nResolution: Tasks marked as sequential (dependency added automatically)\nResult: Wave 2 becomes Wave 2a and Wave 2b\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Smart Decomposition"}),":\nThe Claude API decomposer is instructed to:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Predict which files each subtask will modify"}),"\n",(0,l.jsx)(n.li,{children:"Add dependencies if files overlap"}),"\n",(0,l.jsx)(n.li,{children:"Mark singleton tasks (build/lint/test)"}),"\n",(0,l.jsx)(n.li,{children:"Ensure non-overlapping file sets for parallel tasks"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Max ~5-10 parallel tasks per wave (Claude Code limit)"}),"\n",(0,l.jsx)(n.li,{children:"Each task is isolated (no shared memory between agents)"}),"\n",(0,l.jsx)(n.li,{children:"Context must be explicitly passed between waves"}),"\n",(0,l.jsx)(n.li,{children:"Total execution time is limited by longest critical path"}),"\n",(0,l.jsx)(n.li,{children:"File prediction accuracy depends on decomposer (Claude API)"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"activation-keywords",children:"Activation Keywords"}),"\n",(0,l.jsx)(n.p,{children:"Invoke this skill when user says:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:'"Execute this task using DAG"'}),"\n",(0,l.jsx)(n.li,{children:'"Decompose and run in parallel"'}),"\n",(0,l.jsx)(n.li,{children:'"Use the DAG framework"'}),"\n",(0,l.jsx)(n.li,{children:'"Orchestrate agents to solve X"'}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The missing intelligence layer is now operational."})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}}}]);