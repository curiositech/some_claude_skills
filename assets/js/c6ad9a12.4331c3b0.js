"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[13556],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>o});var i=t(96540);const r={},a=i.createContext(r);function s(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:n},e.children)}},51681:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"skills/2000s_visualization_expert/references/web-audio-fft","title":"Web Audio API FFT Reference","description":"Comprehensive guide to extracting and using audio frequency data.","source":"@site/docs/skills/2000s_visualization_expert/references/web-audio-fft.md","sourceDirName":"skills/2000s_visualization_expert/references","slug":"/skills/2000s_visualization_expert/references/web-audio-fft","permalink":"/docs/skills/2000s_visualization_expert/references/web-audio-fft","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Web Audio API FFT Reference","sidebar_label":"Web Audio API FFT Reference","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"GLSL Shaders for Audio Visu...","permalink":"/docs/skills/2000s_visualization_expert/references/glsl-shaders"},"next":{"title":"Sound Engineer","permalink":"/docs/skills/sound_engineer/"}}');var r=t(74848),a=t(28453);const s={title:"Web Audio API FFT Reference",sidebar_label:"Web Audio API FFT Reference",sidebar_position:3},o="Web Audio API FFT Reference",l={},c=[{value:"Basic FFT Setup",id:"basic-fft-setup",level:2},{value:"FFT Size Tradeoffs",id:"fft-size-tradeoffs",level:2},{value:"Logarithmic Frequency Bands",id:"logarithmic-frequency-bands",level:2},{value:"Common Frequency Ranges",id:"common-frequency-ranges",level:2},{value:"Beat Detection",id:"beat-detection",level:2},{value:"Smoothing Techniques",id:"smoothing-techniques",level:2},{value:"Built-in Smoothing",id:"built-in-smoothing",level:3},{value:"Manual Exponential Smoothing",id:"manual-exponential-smoothing",level:3},{value:"Attack/Release Smoothing",id:"attackrelease-smoothing",level:3},{value:"Audio Texture for Shaders",id:"audio-texture-for-shaders",level:2},{value:"AudioContext State Handling",id:"audiocontext-state-handling",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"web-audio-api-fft-reference",children:"Web Audio API FFT Reference"})}),"\n",(0,r.jsx)(n.p,{children:"Comprehensive guide to extracting and using audio frequency data."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"basic-fft-setup",children:"Basic FFT Setup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// Create analyser\nconst analyserNode = audioContext.createAnalyser();\nanalyserNode.fftSize = 2048;  // Power of 2, 32-32768\nanalyserNode.smoothingTimeConstant = 0.8;  // 0-1, higher = smoother\n\n// Connect to audio chain\nsource.connect(analyserNode);\nanalyserNode.connect(audioContext.destination);\n\n// Get frequency data (spectrum)\nconst frequencyData = new Uint8Array(analyserNode.frequencyBinCount);\nanalyserNode.getByteFrequencyData(frequencyData);  // 0-255 values\n\n// Get waveform data (time domain)\nconst waveformData = new Uint8Array(analyserNode.fftSize);\nanalyserNode.getByteTimeDomainData(waveformData);  // 128 = silence\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"fft-size-tradeoffs",children:"FFT Size Tradeoffs"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"fftSize"}),(0,r.jsx)(n.th,{children:"Bins"}),(0,r.jsx)(n.th,{children:"Frequency Resolution"}),(0,r.jsx)(n.th,{children:"Time Resolution"}),(0,r.jsx)(n.th,{children:"Use Case"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"256"}),(0,r.jsx)(n.td,{children:"128"}),(0,r.jsx)(n.td,{children:"172 Hz"}),(0,r.jsx)(n.td,{children:"5.8 ms"}),(0,r.jsx)(n.td,{children:"Beat detection"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"512"}),(0,r.jsx)(n.td,{children:"256"}),(0,r.jsx)(n.td,{children:"86 Hz"}),(0,r.jsx)(n.td,{children:"11.6 ms"}),(0,r.jsx)(n.td,{children:"Fast visuals"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"1024"}),(0,r.jsx)(n.td,{children:"512"}),(0,r.jsx)(n.td,{children:"43 Hz"}),(0,r.jsx)(n.td,{children:"23.2 ms"}),(0,r.jsx)(n.td,{children:"Balanced"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"2048"}),(0,r.jsx)(n.td,{children:"1024"}),(0,r.jsx)(n.td,{children:"22 Hz"}),(0,r.jsx)(n.td,{children:"46.4 ms"}),(0,r.jsx)(n.td,{children:"Detailed spectrum"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"4096"}),(0,r.jsx)(n.td,{children:"2048"}),(0,r.jsx)(n.td,{children:"11 Hz"}),(0,r.jsx)(n.td,{children:"92.9 ms"}),(0,r.jsx)(n.td,{children:"High-res analysis"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule of thumb"}),": Higher fftSize = better frequency resolution but slower response."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"logarithmic-frequency-bands",children:"Logarithmic Frequency Bands"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Critical knowledge"}),": FFT bins are linear in frequency, but human hearing is logarithmic!"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"function getLogarithmicBands(\n  frequencyData: Uint8Array,\n  numBands: number,\n  sampleRate: number = 44100\n): number[] {\n  const bands = new Array(numBands).fill(0);\n  const nyquist = sampleRate / 2;\n\n  for (let i = 0; i < numBands; i++) {\n    // Logarithmic frequency mapping (20Hz - Nyquist)\n    const lowFreq = 20 * Math.pow(nyquist / 20, i / numBands);\n    const highFreq = 20 * Math.pow(nyquist / 20, (i + 1) / numBands);\n\n    const lowBin = Math.floor(lowFreq / nyquist * frequencyData.length);\n    const highBin = Math.floor(highFreq / nyquist * frequencyData.length);\n\n    let sum = 0;\n    let count = 0;\n    for (let j = lowBin; j < highBin && j < frequencyData.length; j++) {\n      sum += frequencyData[j];\n      count++;\n    }\n    bands[i] = count > 0 ? sum / count : 0;\n  }\n  return bands;\n}\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"common-frequency-ranges",children:"Common Frequency Ranges"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"function getFrequencyRanges(\n  frequencyData: Uint8Array,\n  sampleRate: number = 44100\n): { bass: number; mid: number; treble: number } {\n  const nyquist = sampleRate / 2;\n  const binWidth = nyquist / frequencyData.length;\n\n  function getRange(lowHz: number, highHz: number): number {\n    const lowBin = Math.floor(lowHz / binWidth);\n    const highBin = Math.min(\n      Math.floor(highHz / binWidth),\n      frequencyData.length - 1\n    );\n\n    let sum = 0;\n    for (let i = lowBin; i <= highBin; i++) {\n      sum += frequencyData[i];\n    }\n    return sum / (highBin - lowBin + 1);\n  }\n\n  return {\n    bass: getRange(20, 250),      // Sub-bass + bass\n    mid: getRange(250, 4000),     // Low-mid + mid + high-mid\n    treble: getRange(4000, 20000) // Presence + brilliance\n  };\n}\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"beat-detection",children:"Beat Detection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"class BeatDetector {\n  private history: number[] = [];\n  private historySize = 43;  // ~1 second at 60fps\n  private threshold = 1.3;\n\n  detect(frequencyData: Uint8Array): boolean {\n    // Focus on bass frequencies (first 1/8 of spectrum)\n    const bassEnd = Math.floor(frequencyData.length / 8);\n    let bassEnergy = 0;\n    for (let i = 0; i < bassEnd; i++) {\n      bassEnergy += frequencyData[i] * frequencyData[i];\n    }\n    bassEnergy = Math.sqrt(bassEnergy / bassEnd);\n\n    // Add to history\n    this.history.push(bassEnergy);\n    if (this.history.length > this.historySize) {\n      this.history.shift();\n    }\n\n    // Compare to average\n    const average = this.history.reduce((a, b) => a + b, 0) / this.history.length;\n\n    // Beat if current energy exceeds threshold * average\n    return bassEnergy > average * this.threshold;\n  }\n}\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"smoothing-techniques",children:"Smoothing Techniques"}),"\n",(0,r.jsx)(n.h3,{id:"built-in-smoothing",children:"Built-in Smoothing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"analyserNode.smoothingTimeConstant = 0.8;  // 0 = no smoothing, 1 = frozen\n"})}),"\n",(0,r.jsx)(n.h3,{id:"manual-exponential-smoothing",children:"Manual Exponential Smoothing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"class SmoothingFilter {\n  private smoothed: Float32Array;\n  private alpha: number;\n\n  constructor(size: number, alpha: number = 0.3) {\n    this.smoothed = new Float32Array(size);\n    this.alpha = alpha;\n  }\n\n  apply(raw: Uint8Array): Float32Array {\n    for (let i = 0; i < raw.length; i++) {\n      this.smoothed[i] = this.smoothed[i] * (1 - this.alpha) + raw[i] * this.alpha;\n    }\n    return this.smoothed;\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"attackrelease-smoothing",children:"Attack/Release Smoothing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"class AttackRelease {\n  private current: number = 0;\n  private attack: number;   // Fast rise\n  private release: number;  // Slow fall\n\n  constructor(attack: number = 0.9, release: number = 0.3) {\n    this.attack = attack;\n    this.release = release;\n  }\n\n  apply(target: number): number {\n    const alpha = target > this.current ? this.attack : this.release;\n    this.current = this.current * (1 - alpha) + target * alpha;\n    return this.current;\n  }\n}\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"audio-texture-for-shaders",children:"Audio Texture for Shaders"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"function createAudioTexture(\n  gl: WebGLRenderingContext,\n  frequencyData: Uint8Array\n): WebGLTexture {\n  const texture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n\n  // Upload as 1D texture (width = data length, height = 1)\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    0,\n    gl.LUMINANCE,\n    frequencyData.length,\n    1,\n    0,\n    gl.LUMINANCE,\n    gl.UNSIGNED_BYTE,\n    frequencyData\n  );\n\n  // Filtering\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n  return texture!;\n}\n\n// Update each frame\nfunction updateAudioTexture(\n  gl: WebGLRenderingContext,\n  texture: WebGLTexture,\n  frequencyData: Uint8Array\n) {\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texSubImage2D(\n    gl.TEXTURE_2D,\n    0,\n    0, 0,\n    frequencyData.length, 1,\n    gl.LUMINANCE,\n    gl.UNSIGNED_BYTE,\n    frequencyData\n  );\n}\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"audiocontext-state-handling",children:"AudioContext State Handling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async function ensureAudioContext(\n  audioContext: AudioContext\n): Promise<void> {\n  if (audioContext.state === 'suspended') {\n    await audioContext.resume();\n  }\n}\n\n// Require user interaction to start\nfunction setupAudioActivation(\n  audioContext: AudioContext,\n  element: HTMLElement\n) {\n  const activate = async () => {\n    await ensureAudioContext(audioContext);\n    element.removeEventListener('click', activate);\n    element.removeEventListener('touchstart', activate);\n  };\n\n  element.addEventListener('click', activate);\n  element.addEventListener('touchstart', activate);\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);