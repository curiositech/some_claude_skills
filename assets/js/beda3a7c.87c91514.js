"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[54635],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var i=s(96540);const t={},r=i.createContext(t);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:n},e.children)}},36817:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"skills/geospatial_data_pipeline/index","title":"\ud83d\udcca Geospatial Data Pipeline","description":"Process, analyze, and visualize geospatial data at scale. Handles drone imagery, GPS tracks, GeoJSON optimization, coordinate transformations, and tile generation. Use for mapping apps, drone data processing, location-based services. Activate on \\"geospatial\\", \\"GIS\\", \\"PostGIS\\", \\"GeoJSON\\", \\"map tiles\\", \\"coordinate systems\\". NOT for simple address validation, basic distance calculations, or static map embeds.","source":"@site/docs/skills/geospatial_data_pipeline/index.md","sourceDirName":"skills/geospatial_data_pipeline","slug":"/skills/geospatial_data_pipeline/","permalink":"/docs/skills/geospatial_data_pipeline/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Geospatial Data Pipeline","sidebar_position":1}}');var t=s(74848),r=s(28453);const a={sidebar_label:"Geospatial Data Pipeline",sidebar_position:1},o="\ud83d\udcca Geospatial Data Pipeline",l={},d=[{value:"Allowed Tools",id:"allowed-tools",level:2},{value:"References",id:"references",level:2},{value:"When to Use",id:"when-to-use",level:2},{value:"Technology Selection",id:"technology-selection",level:2},{value:"Database: PostGIS vs MongoDB Geospatial",id:"database-postgis-vs-mongodb-geospatial",level:3},{value:"Common Anti-Patterns",id:"common-anti-patterns",level:2},{value:"Anti-Pattern 1: Storing Coordinates as Strings",id:"anti-pattern-1-storing-coordinates-as-strings",level:3},{value:"Anti-Pattern 2: Not Using Spatial Indexes",id:"anti-pattern-2-not-using-spatial-indexes",level:3},{value:"Anti-Pattern 3: Mixing Coordinate Systems",id:"anti-pattern-3-mixing-coordinate-systems",level:3},{value:"Anti-Pattern 4: Loading Huge GeoJSON Files",id:"anti-pattern-4-loading-huge-geojson-files",level:3},{value:"Anti-Pattern 5: Euclidean Distance on Spherical Earth",id:"anti-pattern-5-euclidean-distance-on-spherical-earth",level:3},{value:"Production Checklist",id:"production-checklist",level:2},{value:"When to Use vs Avoid",id:"when-to-use-vs-avoid",level:2},{value:"References",id:"references-1",level:2},{value:"Scripts",id:"scripts",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"-geospatial-data-pipeline",children:"\ud83d\udcca Geospatial Data Pipeline"})}),"\n",(0,t.jsx)(n.p,{children:'Process, analyze, and visualize geospatial data at scale. Handles drone imagery, GPS tracks, GeoJSON optimization, coordinate transformations, and tile generation. Use for mapping apps, drone data processing, location-based services. Activate on "geospatial", "GIS", "PostGIS", "GeoJSON", "map tiles", "coordinate systems". NOT for simple address validation, basic distance calculations, or static map embeds.'}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"allowed-tools",children:"Allowed Tools"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Read, Write, Edit, Bash(npm:*, gdal*, postgres*)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"./references/coordinate-systems",children:"Coordinate Systems & Transformations"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"./references/geojson-optimization",children:"GeoJSON Optimization"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"./references/postgis-guide",children:"PostGIS Guide"})}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"geospatial-data-pipeline",children:"Geospatial Data Pipeline"}),"\n",(0,t.jsx)(n.p,{children:"Expert in processing, optimizing, and visualizing geospatial data at scale."}),"\n",(0,t.jsx)(n.h2,{id:"when-to-use",children:"When to Use"}),"\n",(0,t.jsxs)(n.p,{children:["\u2705 ",(0,t.jsx)(n.strong,{children:"Use for"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Drone imagery processing and annotation"}),"\n",(0,t.jsx)(n.li,{children:"GPS track analysis and visualization"}),"\n",(0,t.jsx)(n.li,{children:"Location-based search (find nearby X)"}),"\n",(0,t.jsx)(n.li,{children:"Map tile generation for web/mobile"}),"\n",(0,t.jsx)(n.li,{children:"Coordinate system transformations"}),"\n",(0,t.jsx)(n.li,{children:"Geofencing and spatial queries"}),"\n",(0,t.jsx)(n.li,{children:"GeoJSON optimization for web"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u274c ",(0,t.jsx)(n.strong,{children:"NOT for"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Simple address validation (use address APIs)"}),"\n",(0,t.jsx)(n.li,{children:"Basic distance calculations (use Haversine formula)"}),"\n",(0,t.jsx)(n.li,{children:"Static map embeds (use Mapbox Static API)"}),"\n",(0,t.jsx)(n.li,{children:"Geocoding (use Nominatim or Google Geocoding API)"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"technology-selection",children:"Technology Selection"}),"\n",(0,t.jsx)(n.h3,{id:"database-postgis-vs-mongodb-geospatial",children:"Database: PostGIS vs MongoDB Geospatial"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Feature"}),(0,t.jsx)(n.th,{children:"PostGIS"}),(0,t.jsx)(n.th,{children:"MongoDB"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Spatial indexes"}),(0,t.jsx)(n.td,{children:"GiST, SP-GiST"}),(0,t.jsx)(n.td,{children:"2dsphere"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Query language"}),(0,t.jsx)(n.td,{children:"SQL + spatial functions"}),(0,t.jsx)(n.td,{children:"Aggregation pipeline"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Geometry types"}),(0,t.jsx)(n.td,{children:"20+ (full OGC support)"}),(0,t.jsx)(n.td,{children:"Basic (Point, Line, Polygon)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Coordinate systems"}),(0,t.jsx)(n.td,{children:"6000+ via EPSG"}),(0,t.jsx)(n.td,{children:"WGS84 only"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Performance (10M points)"}),(0,t.jsx)(n.td,{children:"<100ms"}),(0,t.jsx)(n.td,{children:"<200ms"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Best for"}),(0,t.jsx)(n.td,{children:"Complex spatial analysis"}),(0,t.jsx)(n.td,{children:"Document-centric apps"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Timeline"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"2005: PostGIS 1.0 released"}),"\n",(0,t.jsx)(n.li,{children:"2012: MongoDB adds geospatial indexes"}),"\n",(0,t.jsx)(n.li,{children:"2020: PostGIS 3.0 with improved performance"}),"\n",(0,t.jsx)(n.li,{children:"2024: PostGIS remains gold standard for GIS workloads"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"common-anti-patterns",children:"Common Anti-Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"anti-pattern-1-storing-coordinates-as-strings",children:"Anti-Pattern 1: Storing Coordinates as Strings"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Novice thinking"}),": \"I'll just store lat/lon as text, it's simple\""]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),": Can't use spatial indexes, queries are slow, no validation."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Wrong approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'// \u274c String storage, no spatial features\ninterface Location {\n  id: string;\n  name: string;\n  latitude: string;   // "37.7749"\n  longitude: string;  // "-122.4194"\n}\n\n// Linear scan for "nearby" queries\nasync function findNearby(lat: string, lon: string): Promise<Location[]> {\n  const all = await db.locations.findAll();\n\n  return all.filter(loc => {\n    const distance = calculateDistance(\n      parseFloat(lat),\n      parseFloat(lon),\n      parseFloat(loc.latitude),\n      parseFloat(loc.longitude)\n    );\n    return distance < 5000; // 5km\n  });\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why wrong"}),": O(N) linear scan, no spatial index, string parsing overhead."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u2705 PostGIS GEOGRAPHY type with spatial index\nCREATE TABLE locations (\n  id SERIAL PRIMARY KEY,\n  name VARCHAR(255),\n  location GEOGRAPHY(POINT, 4326)  -- WGS84 coordinates\n);\n\n-- Spatial index (GiST)\nCREATE INDEX idx_locations_geography ON locations USING GIST(location);\n\n-- TypeScript query\nasync function findNearby(lat: number, lon: number, radiusMeters: number): Promise<Location[]> {\n  const query = `\n    SELECT id, name, ST_AsGeoJSON(location) as geojson\n    FROM locations\n    WHERE ST_DWithin(\n      location,\n      ST_SetSRID(ST_MakePoint($1, $2), 4326)::geography,\n      $3\n    )\n    ORDER BY location <-> ST_SetSRID(ST_MakePoint($1, $2), 4326)::geography\n    LIMIT 100\n  `;\n\n  return db.query(query, [lon, lat, radiusMeters]);  // &lt;10ms with index\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Timeline context"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"2000s: Stored lat/lon as FLOAT columns, did math in app code"}),"\n",(0,t.jsx)(n.li,{children:"2010s: PostGIS adoption, spatial indexes"}),"\n",(0,t.jsxs)(n.li,{children:["2024: ",(0,t.jsx)(n.code,{children:"GEOGRAPHY"})," type handles Earth curvature automatically"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"anti-pattern-2-not-using-spatial-indexes",children:"Anti-Pattern 2: Not Using Spatial Indexes"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),": Proximity queries do full table scans."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Wrong approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- \u274c No index, sequential scan\nCREATE TABLE drone_images (\n  id SERIAL PRIMARY KEY,\n  image_url VARCHAR(255),\n  location GEOGRAPHY(POINT, 4326)\n);\n\n-- This query scans ALL rows\nSELECT * FROM drone_images\nWHERE ST_DWithin(\n  location,\n  ST_SetSRID(ST_MakePoint(-122.4194, 37.7749), 4326)::geography,\n  1000  -- 1km\n);\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"EXPLAIN output"}),": ",(0,t.jsx)(n.code,{children:"Seq Scan on drone_images (cost=0.00..1234.56 rows=1 width=123)"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- \u2705 GiST index for spatial queries\nCREATE INDEX idx_drone_images_location ON drone_images USING GIST(location);\n\n-- Same query, now uses index\nSELECT * FROM drone_images\nWHERE ST_DWithin(\n  location,\n  ST_SetSRID(ST_MakePoint(-122.4194, 37.7749), 4326)::geography,\n  1000\n);\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"EXPLAIN output"}),": ",(0,t.jsx)(n.code,{children:"Bitmap Index Scan on idx_drone_images_location (cost=4.30..78.30 rows=50 width=123)"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Performance impact"}),": 10M points, 5km radius query"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Without index: 3.2 seconds (full scan)"}),"\n",(0,t.jsx)(n.li,{children:"With GiST index: 12ms (99.6% faster)"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"anti-pattern-3-mixing-coordinate-systems",children:"Anti-Pattern 3: Mixing Coordinate Systems"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Novice thinking"}),': "Coordinates are just numbers, I can mix them"']}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),": Incorrect distances, misaligned map features."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Wrong approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u274c Mixing EPSG:4326 (WGS84) and EPSG:3857 (Web Mercator)\nconst userLocation = {\n  lat: 37.7749,   // WGS84\n  lon: -122.4194\n};\n\nconst droneImage = {\n  x: -13634876,  // Web Mercator (EPSG:3857)\n  y: 4545684\n};\n\n// Comparing apples to oranges!\nconst distance = Math.sqrt(\n  Math.pow(userLocation.lon - droneImage.x, 2) +\n  Math.pow(userLocation.lat - droneImage.y, 2)\n);\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Result"}),': Wildly incorrect distance (millions of "units").']}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- \u2705 Transform to common coordinate system\nSELECT ST_Distance(\n  ST_Transform(\n    ST_SetSRID(ST_MakePoint(-122.4194, 37.7749), 4326),  -- WGS84\n    3857  -- Transform to Web Mercator\n  ),\n  ST_SetSRID(ST_MakePoint(-13634876, 4545684), 3857)  -- Already Web Mercator\n) AS distance_meters;\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Or better"}),": Always store in one system (WGS84), transform on display only."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Timeline"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"2005: Web Mercator (EPSG:3857) introduced by Google Maps"}),"\n",(0,t.jsx)(n.li,{children:"2010: Confusion peaks as apps mix WGS84 data with Web Mercator tiles"}),"\n",(0,t.jsx)(n.li,{children:"2024: Best practice: Store WGS84, transform to 3857 only for tile rendering"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"anti-pattern-4-loading-huge-geojson-files",children:"Anti-Pattern 4: Loading Huge GeoJSON Files"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),": 50MB GeoJSON file crashes browser."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Wrong approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u274c Load entire file into memory\nconst geoJson = await fetch('/drone-survey-data.geojson').then(r => r.json());\n\n// 50MB of GeoJSON = browser freeze\nmap.addSource('drone-data', {\n  type: 'geojson',\n  data: geoJson  // All 10,000 polygons loaded at once\n});\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach 1"}),": Vector tiles (pre-chunked)"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Serve as vector tiles (MBTiles or PMTiles)\nmap.addSource('drone-data', {\n  type: 'vector',\n  tiles: ['https://api.example.com/tiles/{z}/{x}/{y}.pbf'],\n  minzoom: 10,\n  maxzoom: 18\n});\n\n// Browser only loads visible tiles\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach 2"}),": GeoJSON simplification + chunking"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Simplify geometry (reduce points)\nnpm install -g @mapbox/geojson-precision\ngeojson-precision -p 5 input.geojson output.geojson\n\n# Split into tiles\nnpm install -g geojson-vt\n# Generate tiles programmatically (see scripts/tile_generator.ts)\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach 3"}),": Server-side filtering"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Only fetch visible bounds\nasync function fetchVisibleFeatures(bounds: Bounds): Promise<GeoJSON> {\n  const response = await fetch(\n    `/api/features?bbox=${bounds.west},${bounds.south},${bounds.east},${bounds.north}`\n  );\n  return response.json();\n}\n\nmap.on('moveend', async () => {\n  const bounds = map.getBounds();\n  const geojson = await fetchVisibleFeatures(bounds);\n  map.getSource('dynamic-data').setData(geojson);\n});\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"anti-pattern-5-euclidean-distance-on-spherical-earth",children:"Anti-Pattern 5: Euclidean Distance on Spherical Earth"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Novice thinking"}),': "Distance is just Pythagorean theorem"']}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Problem"}),": Incorrect at scale, worse near poles."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Wrong approach"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u274c Flat Earth distance (wrong!)\nfunction distanceKm(lat1: number, lon1: number, lat2: number, lon2: number): number {\n  const dx = lon2 - lon1;\n  const dy = lat2 - lat1;\n\n  return Math.sqrt(dx * dx + dy * dy) * 111.32;  // 111.32 km/degree (WRONG)\n}\n\n// Example: San Francisco to New York\nconst distance = distanceKm(37.7749, -122.4194, 40.7128, -74.0060);\n// Returns: ~55 km (WRONG! Actual: ~4,130 km)\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why wrong"}),": Earth is a sphere, not a flat plane."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach 1"}),": Haversine formula (great circle distance)"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Haversine formula (spherical Earth)\nfunction haversineKm(lat1: number, lon1: number, lat2: number, lon2: number): number {\n  const R = 6371; // Earth radius in km\n\n  const dLat = toRadians(lat2 - lat1);\n  const dLon = toRadians(lon2 - lon1);\n\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(toRadians(lat1)) * Math.cos(toRadians(lat2)) *\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\n\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\n  return R * c;\n}\n\n// San Francisco to New York\nconst distance = haversineKm(37.7749, -122.4194, 40.7128, -74.0060);\n// Returns: ~4,130 km \u2705\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Correct approach 2"}),": PostGIS (handles curvature automatically)"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- \u2705 PostGIS ST_Distance with GEOGRAPHY\nSELECT ST_Distance(\n  ST_SetSRID(ST_MakePoint(-122.4194, 37.7749), 4326)::geography,\n  ST_SetSRID(ST_MakePoint(-74.0060, 40.7128), 4326)::geography\n) / 1000 AS distance_km;\n-- Returns: 4130.137 km \u2705\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Accuracy comparison"}),":"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Method"}),(0,t.jsx)(n.th,{children:"SF to NYC"}),(0,t.jsx)(n.th,{children:"Error"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Euclidean (flat)"}),(0,t.jsx)(n.td,{children:"55 km"}),(0,t.jsx)(n.td,{children:"98.7% wrong"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Haversine (sphere)"}),(0,t.jsx)(n.td,{children:"4,130 km"}),(0,t.jsx)(n.td,{children:"\u2705 Correct"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"PostGIS (ellipsoid)"}),(0,t.jsx)(n.td,{children:"4,135 km"}),(0,t.jsx)(n.td,{children:"Most accurate"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"production-checklist",children:"Production Checklist"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"\u25a1 PostGIS extension installed and spatial indexes created\n\u25a1 All coordinates stored in consistent SRID (recommend: 4326)\n\u25a1 GeoJSON files optimized (&lt;1MB) or served as vector tiles\n\u25a1 Coordinate transformations use ST_Transform, not manual math\n\u25a1 Distance calculations use ST_Distance with GEOGRAPHY type\n\u25a1 Bounding box queries use ST_MakeEnvelope + ST_Intersects\n\u25a1 Large geometries chunked (not &gt;100KB per feature)\n\u25a1 Map tiles pre-generated for common zoom levels\n\u25a1 CORS configured for tile servers\n\u25a1 Rate limiting on geocoding/reverse geocoding endpoints\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"when-to-use-vs-avoid",children:"When to Use vs Avoid"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Scenario"}),(0,t.jsx)(n.th,{children:"Appropriate?"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Drone imagery annotation and search"}),(0,t.jsx)(n.td,{children:"\u2705 Yes - process survey data"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"GPS track visualization"}),(0,t.jsx)(n.td,{children:"\u2705 Yes - optimize paths"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Find nearest coffee shops"}),(0,t.jsx)(n.td,{children:"\u2705 Yes - spatial queries"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Jurisdiction boundary lookups"}),(0,t.jsx)(n.td,{children:"\u2705 Yes - point-in-polygon"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Simple address autocomplete"}),(0,t.jsx)(n.td,{children:"\u274c No - use Mapbox/Google"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Embed static map on page"}),(0,t.jsx)(n.td,{children:"\u274c No - use Static API"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Geocode single address"}),(0,t.jsx)(n.td,{children:"\u274c No - use geocoding API"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"references-1",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/references/coordinate-systems.md"})," - EPSG codes, transformations, Web Mercator vs WGS84"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/references/postgis-guide.md"})," - PostGIS setup, spatial indexes, common queries"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/references/geojson-optimization.md"})," - Simplification, chunking, vector tiles"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"scripts",children:"Scripts"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"scripts/geospatial_processor.ts"})," - Process drone imagery, GPS tracks, GeoJSON validation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"scripts/tile_generator.ts"})," - Generate vector tiles (MBTiles/PMTiles) from GeoJSON"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"This skill guides"}),": Geospatial data | PostGIS | GeoJSON | Map tiles | Coordinate systems | Drone data processing | Spatial queries"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);