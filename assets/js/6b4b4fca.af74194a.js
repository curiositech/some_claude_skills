"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[88675],{28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>o});var s=i(96540);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}},34108:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"skills/code_necromancer/references/archaeology-guide","title":"Code Archaeology Guide","description":"A deep dive into techniques for understanding legacy codebases.","source":"@site/docs/skills/code_necromancer/references/archaeology-guide.md","sourceDirName":"skills/code_necromancer/references","slug":"/skills/code_necromancer/references/archaeology-guide","permalink":"/docs/skills/code_necromancer/references/archaeology-guide","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Code Archaeology Guide","sidebar_label":"Code Archaeology Guide","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Code Necromancer","permalink":"/docs/skills/code_necromancer/"},"next":{"title":"Dependency Detection Patterns","permalink":"/docs/skills/code_necromancer/references/dependency-patterns"}}');var r=i(74848),l=i(28453);const t={title:"Code Archaeology Guide",sidebar_label:"Code Archaeology Guide",sidebar_position:1},o="Code Archaeology Guide",a={},c=[{value:"Philosophy",id:"philosophy",level:2},{value:"The Archaeological Method",id:"the-archaeological-method",level:2},{value:"1. Surface Survey",id:"1-surface-survey",level:3},{value:"2. Stratification",id:"2-stratification",level:3},{value:"3. Excavation",id:"3-excavation",level:3},{value:"README Analysis",id:"readme-analysis",level:4},{value:"Package Manifest Analysis",id:"package-manifest-analysis",level:4},{value:"Configuration Discovery",id:"configuration-discovery",level:4},{value:"Database Schema Discovery",id:"database-schema-discovery",level:4},{value:"API Endpoint Discovery",id:"api-endpoint-discovery",level:4},{value:"4. Dating (Timeline Reconstruction)",id:"4-dating-timeline-reconstruction",level:3},{value:"5. Cross-Referencing",id:"5-cross-referencing",level:3},{value:"Pattern Recognition",id:"pattern-recognition",level:2},{value:"Common Architecture Patterns",id:"common-architecture-patterns",level:3},{value:"Common Problems to Look For",id:"common-problems-to-look-for",level:3},{value:"Tools of the Trade",id:"tools-of-the-trade",level:2},{value:"Essential CLI Tools",id:"essential-cli-tools",level:3},{value:"Visualization Tools",id:"visualization-tools",level:3},{value:"Analysis Scripts",id:"analysis-scripts",level:3},{value:"Documentation Templates",id:"documentation-templates",level:2},{value:"Repo Profile Template",id:"repo-profile-template",level:3},{value:"Anti-Patterns to Avoid",id:"anti-patterns-to-avoid",level:2},{value:"Checklist: Is Archaeology Complete?",id:"checklist-is-archaeology-complete",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"code-archaeology-guide",children:"Code Archaeology Guide"})}),"\n",(0,r.jsx)(n.p,{children:"A deep dive into techniques for understanding legacy codebases."}),"\n",(0,r.jsx)(n.h2,{id:"philosophy",children:"Philosophy"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:'"Understand before you touch."'})}),"\n",(0,r.jsx)(n.p,{children:"The cardinal rule of code archaeology is to fully map and understand a system before making any changes. Premature modification leads to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Breaking unknown dependencies"}),"\n",(0,r.jsx)(n.li,{children:"Introducing regressions in untested code"}),"\n",(0,r.jsx)(n.li,{children:"Missing the actual architecture (vs. assumed architecture)"}),"\n",(0,r.jsx)(n.li,{children:"Wasted effort on deprecated components"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"the-archaeological-method",children:"The Archaeological Method"}),"\n",(0,r.jsx)(n.h3,{id:"1-surface-survey",children:"1. Surface Survey"}),"\n",(0,r.jsx)(n.p,{children:"Start with the broadest possible view:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Get organization overview\ngh repo list ORG --limit 1000 --json name,description,primaryLanguage,pushedAt,isArchived\n\n# Count repos by language\ngh repo list ORG --json primaryLanguage -q '.[].primaryLanguage.name' | sort | uniq -c\n\n# Find most recently active\ngh repo list ORG --json name,pushedAt --jq 'sort_by(.pushedAt) | reverse | .[0:5]'\n\n# Find oldest\ngh repo list ORG --json name,createdAt --jq 'sort_by(.createdAt) | .[0:5]'\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-stratification",children:"2. Stratification"}),"\n",(0,r.jsx)(n.p,{children:"Categorize repos into layers:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Layer 1: User-Facing"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Web frontends"}),"\n",(0,r.jsx)(n.li,{children:"Mobile apps"}),"\n",(0,r.jsx)(n.li,{children:"CLI tools"}),"\n",(0,r.jsx)(n.li,{children:'Signs: "react", "vue", "angular", "flutter", "swift"'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Layer 2: API Gateway"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Main API servers"}),"\n",(0,r.jsx)(n.li,{children:"GraphQL endpoints"}),"\n",(0,r.jsx)(n.li,{children:'Signs: "express", "fastapi", "gin", "/api/", "graphql"'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Layer 3: Services"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Background workers"}),"\n",(0,r.jsx)(n.li,{children:"Microservices"}),"\n",(0,r.jsx)(n.li,{children:'Signs: "worker", "service", "processor", "queue"'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Layer 4: Data"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Database migrations"}),"\n",(0,r.jsx)(n.li,{children:"Data pipelines"}),"\n",(0,r.jsx)(n.li,{children:'Signs: "migrations", "etl", "pipeline", "warehouse"'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Layer 5: Infrastructure"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Deployment configs"}),"\n",(0,r.jsx)(n.li,{children:"Terraform/CDK"}),"\n",(0,r.jsx)(n.li,{children:'Signs: "infra", "terraform", "cdk", "k8s", "deploy"'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Layer 6: Libraries"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Shared code"}),"\n",(0,r.jsx)(n.li,{children:"Internal packages"}),"\n",(0,r.jsx)(n.li,{children:'Signs: "@org/", "common", "shared", "utils", "lib"'}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-excavation",children:"3. Excavation"}),"\n",(0,r.jsx)(n.p,{children:"Deep dive into each significant repo:"}),"\n",(0,r.jsx)(n.h4,{id:"readme-analysis",children:"README Analysis"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Check for README\nls -la README*\n\n# Extract key sections\ngrep -A 10 "^## " README.md\n'})}),"\n",(0,r.jsx)(n.h4,{id:"package-manifest-analysis",children:"Package Manifest Analysis"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Node.js - Find all package.json files\nfind . -name "package.json" -not -path "*/node_modules/*"\n\n# Extract dependencies\njq \'.dependencies, .devDependencies\' package.json\n\n# Find internal dependencies\njq \'.dependencies | keys[] | select(startswith("@org"))\' package.json\n\n# Python - requirements\ncat requirements*.txt\n\n# Go - modules\ncat go.mod\n'})}),"\n",(0,r.jsx)(n.h4,{id:"configuration-discovery",children:"Configuration Discovery"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Find all config files\nfind . -name "*.config.*" -o -name ".env*" -o -name "*.yaml" -o -name "*.yml"\n\n# Extract environment variables from code\ngrep -r "process.env\\." --include="*.js" --include="*.ts" | \\\n  sed \'s/.*process.env.\\([A-Z_]*\\).*/\\1/\' | sort -u\n\n# Python env vars\ngrep -r "os.environ\\|os.getenv" --include="*.py" | \\\n  grep -oE \'"[A-Z_]+"\' | sort -u\n'})}),"\n",(0,r.jsx)(n.h4,{id:"database-schema-discovery",children:"Database Schema Discovery"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Find migration files\nfind . -name "*migration*" -o -name "*schema*" -type f\n\n# Look for ORM models\ngrep -r "class.*Model\\|@Entity\\|db.Model" --include="*.py" --include="*.ts" --include="*.js"\n\n# Find SQL files\nfind . -name "*.sql"\n'})}),"\n",(0,r.jsx)(n.h4,{id:"api-endpoint-discovery",children:"API Endpoint Discovery"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Express routes\ngrep -r "app\\.\\(get\\|post\\|put\\|delete\\|patch\\)" --include="*.js" --include="*.ts"\n\n# FastAPI/Flask routes\ngrep -r "@app\\.\\(get\\|post\\|put\\|delete\\|route\\)" --include="*.py"\n\n# Find OpenAPI/Swagger specs\nfind . -name "swagger*" -o -name "openapi*"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"4-dating-timeline-reconstruction",children:"4. Dating (Timeline Reconstruction)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# First commit ever\ngit log --reverse --format="%H %ai %s" | head -1\n\n# Last commit\ngit log -1 --format="%H %ai %s"\n\n# Commits per month over project lifetime\ngit log --format="%ai" | cut -d\'-\' -f1,2 | sort | uniq -c\n\n# Most active contributors\ngit shortlog -sn --all\n\n# When was each file last modified?\ngit ls-tree -r --name-only HEAD | while read f; do\n  echo "$(git log -1 --format="%ai" -- "$f") $f"\ndone | sort -r\n'})}),"\n",(0,r.jsx)(n.h3,{id:"5-cross-referencing",children:"5. Cross-Referencing"}),"\n",(0,r.jsx)(n.p,{children:"Find how repos connect:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Find internal package references\ngrep -r "@org/" --include="package.json" | grep -v node_modules\n\n# Find API calls between services\ngrep -r "http://\\|https://\\|localhost:" --include="*.js" --include="*.ts" --include="*.py"\n\n# Find shared database names\ngrep -r "DATABASE_URL\\|DB_NAME\\|MONGO_URI" --include="*.env*" --include="*.yaml"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"pattern-recognition",children:"Pattern Recognition"}),"\n",(0,r.jsx)(n.h3,{id:"common-architecture-patterns",children:"Common Architecture Patterns"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Monolith Signs:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Single repo with /api, /frontend, /workers directories"}),"\n",(0,r.jsx)(n.li,{children:"Single package.json with many scripts"}),"\n",(0,r.jsx)(n.li,{children:"Single database connection"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Microservices Signs:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Multiple repos with similar structure"}),"\n",(0,r.jsx)(n.li,{children:"Service discovery config (consul, eureka)"}),"\n",(0,r.jsx)(n.li,{children:"Message queues (RabbitMQ, Kafka, SQS)"}),"\n",(0,r.jsx)(n.li,{children:"API gateway repo"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Monorepo Signs:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Lerna/Nx/Turborepo config"}),"\n",(0,r.jsx)(n.li,{children:"packages/ or apps/ directory"}),"\n",(0,r.jsx)(n.li,{children:"Shared workspace dependencies"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"JAMstack Signs:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Static site generators (Gatsby, Next, Hugo)"}),"\n",(0,r.jsx)(n.li,{children:"Netlify/Vercel configs"}),"\n",(0,r.jsx)(n.li,{children:"Headless CMS references"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"common-problems-to-look-for",children:"Common Problems to Look For"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dependency Hell:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Multiple versions of same package"}),"\n",(0,r.jsx)(n.li,{children:"Circular dependencies between repos"}),"\n",(0,r.jsx)(n.li,{children:"Pinned versions that are EOL"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration Sprawl:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Environment variables everywhere"}),"\n",(0,r.jsx)(n.li,{children:"No .env.example files"}),"\n",(0,r.jsx)(n.li,{children:"Hardcoded values in code"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Documentation Rot:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"README refers to non-existent files"}),"\n",(0,r.jsx)(n.li,{children:"Installation instructions don't work"}),"\n",(0,r.jsx)(n.li,{children:"API docs don't match code"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Test Desert:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"No test files"}),"\n",(0,r.jsx)(n.li,{children:"Empty test directories"}),"\n",(0,r.jsx)(n.li,{children:"Tests that don't run"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"tools-of-the-trade",children:"Tools of the Trade"}),"\n",(0,r.jsx)(n.h3,{id:"essential-cli-tools",children:"Essential CLI Tools"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Code statistics\ncloc .                    # Count lines of code\ntokei .                   # Faster alternative\n\n# Dependency analysis\nnpm ls --all              # Node dependency tree\npipdeptree                # Python dependency tree\ngo mod graph              # Go dependency graph\n\n# Security scanning\nnpm audit                 # Node vulnerabilities\nsafety check              # Python vulnerabilities\ngovulncheck ./...         # Go vulnerabilities\n\n# Git archaeology\ngit-fame                  # Contributor statistics\ngit log --graph --oneline # Visual history\n"})}),"\n",(0,r.jsx)(n.h3,{id:"visualization-tools",children:"Visualization Tools"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Mermaid"}),": For architecture diagrams"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"D2"}),": For more complex diagrams"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Graphviz"}),": For dependency graphs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PlantUML"}),": For UML diagrams"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"analysis-scripts",children:"Analysis Scripts"}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.code,{children:"scripts/"})," directory for automated analysis tools."]}),"\n",(0,r.jsx)(n.h2,{id:"documentation-templates",children:"Documentation Templates"}),"\n",(0,r.jsx)(n.h3,{id:"repo-profile-template",children:"Repo Profile Template"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-markdown",children:"# [Repo Name]\n\n## Purpose\n[One sentence description]\n\n## Category\n[core|support|library|deprecated|unknown]\n\n## Tech Stack\n- Language:\n- Framework:\n- Database:\n- Runtime:\n\n## Dependencies\n- Internal: [@org/lib1, @org/lib2]\n- External critical: [express, mongoose, ...]\n\n## Environment\n- Required vars: [LIST]\n- Config files: [LIST]\n\n## Status\n- Last active: [DATE]\n- Maturity: [1-5]\n- Test coverage: [%]\n\n## Notes\n[Anything notable discovered]\n"})}),"\n",(0,r.jsx)(n.h2,{id:"anti-patterns-to-avoid",children:"Anti-Patterns to Avoid"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Premature Optimization"}),": Don't start fixing things before understanding the whole"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tunnel Vision"}),": Don't focus too long on one interesting repo"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Assumption Bias"}),": Don't assume you know what something does\u2014verify"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Documentation Trust"}),": Don't trust old docs\u2014verify against code"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Recency Bias"}),": Old repos may be more important than recent ones"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"checklist-is-archaeology-complete",children:"Checklist: Is Archaeology Complete?"}),"\n",(0,r.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","All repos identified and cataloged"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Primary language/framework per repo known"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Inter-repo dependencies mapped"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","External service dependencies listed"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Database schemas identified"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","API surfaces documented"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Environment requirements known"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Core vs peripheral repos identified"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Development timeline understood"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Missing pieces documented"]}),"\n",(0,r.jsxs)(n.li,{className:"task-list-item",children:[(0,r.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Architecture diagram created"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);