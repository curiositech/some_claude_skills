"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[27394],{28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var r=i(96540);const t={},s=r.createContext(t);function l(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(s.Provider,{value:n},e.children)}},52965:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"skills/2000s_visualization_expert/references/butterchurn-guide","title":"Butterchurn Integration Guide","description":"Complete guide to implementing Milkdrop-style visualizations with Butterchurn.","source":"@site/docs/skills/2000s_visualization_expert/references/butterchurn-guide.md","sourceDirName":"skills/2000s_visualization_expert/references","slug":"/skills/2000s_visualization_expert/references/butterchurn-guide","permalink":"/docs/skills/2000s_visualization_expert/references/butterchurn-guide","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Butterchurn Integration Guide","sidebar_label":"Butterchurn Integration Guide","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"2000s Visualization Expert","permalink":"/docs/skills/2000s_visualization_expert/"},"next":{"title":"GLSL Shaders for Audio Visu...","permalink":"/docs/skills/2000s_visualization_expert/references/glsl-shaders"}}');var t=i(74848),s=i(28453);const l={title:"Butterchurn Integration Guide",sidebar_label:"Butterchurn Integration Guide",sidebar_position:1},a="Butterchurn Integration Guide",o={},c=[{value:"Basic Setup",id:"basic-setup",level:2},{value:"Preset Recommendations",id:"preset-recommendations",level:2},{value:"Psychedelic/Trippy",id:"psychedelictrippy",level:3},{value:"Smooth/Chill",id:"smoothchill",level:3},{value:"High Energy",id:"high-energy",level:3},{value:"Minimal/Clean",id:"minimalclean",level:3},{value:"Preset Blending",id:"preset-blending",level:2},{value:"Full-Screen Setup",id:"full-screen-setup",level:2},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Lower texture ratio for older GPUs",id:"lower-texture-ratio-for-older-gpus",level:3},{value:"Reduce fftSize if not needed",id:"reduce-fftsize-if-not-needed",level:3},{value:"CSS Performance Hints",id:"css-performance-hints",level:3},{value:"Profile with Chrome DevTools",id:"profile-with-chrome-devtools",level:3},{value:"Cleanup Pattern",id:"cleanup-pattern",level:2},{value:"React Hook",id:"react-hook",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"butterchurn-integration-guide",children:"Butterchurn Integration Guide"})}),"\n",(0,t.jsx)(n.p,{children:"Complete guide to implementing Milkdrop-style visualizations with Butterchurn."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"basic-setup",children:"Basic Setup"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import butterchurn from 'butterchurn';\nimport butterchurnPresets from 'butterchurn-presets';\n\n// Setup\nconst visualizer = butterchurn.createVisualizer(audioContext, canvas, {\n  width: window.innerWidth,\n  height: window.innerHeight,\n  pixelRatio: window.devicePixelRatio || 1,\n  textureRatio: 1,  // Lower for performance\n});\n\n// Connect audio source\nvisualizer.connectAudio(audioNode);  // Can be MediaElementSource, Oscillator, etc.\n\n// Load preset\nconst presets = butterchurnPresets.getPresets();\nconst presetKeys = Object.keys(presets);\nvisualizer.loadPreset(presets[presetKeys[0]], 2.0);  // 2 second blend\n\n// Render loop\nfunction render() {\n  visualizer.render();\n  requestAnimationFrame(render);\n}\nrender();\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"preset-recommendations",children:"Preset Recommendations"}),"\n",(0,t.jsx)(n.h3,{id:"psychedelictrippy",children:"Psychedelic/Trippy"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Flexi, martin + geiss - dedicated to the sherwin maxawow"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Rovastar - Fractopia"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Unchained - Unified Drag"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Zylot - Psychedelic Flower"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"martin - acid warp"})}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"smoothchill",children:"Smooth/Chill"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Flexi - predator-prey-spirals"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Geiss - Cosmic Strings 2"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Martin - liquid science"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Rovastar - Harlequin's Fruit Salad"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"shifter - liquid glass"})}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"high-energy",children:"High Energy"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Flexi + Martin - disconnected"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"shifter - tumbling cubes"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Zylot - Clouds (Tunnel Mix)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"martin - fire storm"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Unchained - Demon's Gate"})}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"minimalclean",children:"Minimal/Clean"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Geiss - Explosion 3"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Martin - Acid Warp Simple"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Rovastar - Twilight"})}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"preset-blending",children:"Preset Blending"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"class PresetManager {\n  private visualizer: any;\n  private presets: Record<string, any>;\n  private presetKeys: string[];\n  private currentIndex: number = 0;\n  private blendTime: number = 2.0;\n\n  constructor(visualizer: any) {\n    this.visualizer = visualizer;\n    this.presets = butterchurnPresets.getPresets();\n    this.presetKeys = Object.keys(this.presets);\n  }\n\n  next() {\n    this.currentIndex = (this.currentIndex + 1) % this.presetKeys.length;\n    this.load(this.presetKeys[this.currentIndex]);\n  }\n\n  previous() {\n    this.currentIndex = (this.currentIndex - 1 + this.presetKeys.length) % this.presetKeys.length;\n    this.load(this.presetKeys[this.currentIndex]);\n  }\n\n  random() {\n    const randomIndex = Math.floor(Math.random() * this.presetKeys.length);\n    this.currentIndex = randomIndex;\n    this.load(this.presetKeys[randomIndex]);\n  }\n\n  load(presetName: string, blendTime?: number) {\n    const preset = this.presets[presetName];\n    if (preset) {\n      this.visualizer.loadPreset(preset, blendTime ?? this.blendTime);\n    }\n  }\n\n  // Auto-advance every N seconds\n  startAutoAdvance(intervalSeconds: number = 30) {\n    return setInterval(() => this.random(), intervalSeconds * 1000);\n  }\n}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"full-screen-setup",children:"Full-Screen Setup"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"function setupFullscreen(canvas: HTMLCanvasElement, visualizer: any) {\n  // Handle resize\n  function handleResize() {\n    const width = window.innerWidth;\n    const height = window.innerHeight;\n\n    canvas.width = width * devicePixelRatio;\n    canvas.height = height * devicePixelRatio;\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n\n    visualizer.setRendererSize(width, height);\n  }\n\n  window.addEventListener('resize', handleResize);\n  handleResize();\n\n  // Full-screen toggle\n  async function toggleFullscreen() {\n    if (!document.fullscreenElement) {\n      await canvas.requestFullscreen();\n    } else {\n      await document.exitFullscreen();\n    }\n  }\n\n  canvas.addEventListener('dblclick', toggleFullscreen);\n\n  // Hide cursor after inactivity\n  let cursorTimeout: number;\n  document.addEventListener('mousemove', () => {\n    document.body.style.cursor = 'default';\n    clearTimeout(cursorTimeout);\n    cursorTimeout = window.setTimeout(() => {\n      document.body.style.cursor = 'none';\n    }, 3000);\n  });\n\n  return { handleResize, toggleFullscreen };\n}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,t.jsx)(n.h3,{id:"lower-texture-ratio-for-older-gpus",children:"Lower texture ratio for older GPUs"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"const visualizer = butterchurn.createVisualizer(audioContext, canvas, {\n  width: window.innerWidth,\n  height: window.innerHeight,\n  textureRatio: 0.5,  // Half resolution for textures\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"reduce-fftsize-if-not-needed",children:"Reduce fftSize if not needed"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"analyserNode.fftSize = 512;  // 256, 512, 1024, 2048 (default)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"css-performance-hints",children:"CSS Performance Hints"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-css",children:"canvas.visualizer {\n  will-change: transform;\n  contain: strict;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"profile-with-chrome-devtools",children:"Profile with Chrome DevTools"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Open DevTools \u2192 Performance tab"}),"\n",(0,t.jsx)(n.li,{children:"Enable GPU timeline"}),"\n",(0,t.jsx)(n.li,{children:"Record during visualization"}),"\n",(0,t.jsx)(n.li,{children:"Look for dropped frames, GPU memory spikes"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"cleanup-pattern",children:"Cleanup Pattern"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"class VisualizerController {\n  private animationId: number | null = null;\n  private visualizer: any;\n  private autoAdvanceInterval: number | null = null;\n\n  start() {\n    const render = () => {\n      this.visualizer.render();\n      this.animationId = requestAnimationFrame(render);\n    };\n    render();\n  }\n\n  stop() {\n    if (this.animationId) {\n      cancelAnimationFrame(this.animationId);\n      this.animationId = null;\n    }\n    if (this.autoAdvanceInterval) {\n      clearInterval(this.autoAdvanceInterval);\n      this.autoAdvanceInterval = null;\n    }\n  }\n\n  destroy() {\n    this.stop();\n    // Additional cleanup if needed\n  }\n}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"react-hook",children:"React Hook"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { useEffect, useRef, useCallback } from 'react';\nimport butterchurn from 'butterchurn';\nimport butterchurnPresets from 'butterchurn-presets';\n\nexport function useButterchurn(audioContext: AudioContext | null, audioNode: AudioNode | null) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const visualizerRef = useRef<any>(null);\n  const animationRef = useRef<number>();\n\n  useEffect(() => {\n    if (!canvasRef.current || !audioContext || !audioNode) return;\n\n    const canvas = canvasRef.current;\n    const visualizer = butterchurn.createVisualizer(audioContext, canvas, {\n      width: canvas.width,\n      height: canvas.height,\n      pixelRatio: window.devicePixelRatio || 1,\n    });\n\n    visualizer.connectAudio(audioNode);\n    visualizerRef.current = visualizer;\n\n    // Load initial preset\n    const presets = butterchurnPresets.getPresets();\n    const keys = Object.keys(presets);\n    visualizer.loadPreset(presets[keys[0]], 0);\n\n    // Render loop\n    const render = () => {\n      visualizer.render();\n      animationRef.current = requestAnimationFrame(render);\n    };\n    render();\n\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current);\n      }\n    };\n  }, [audioContext, audioNode]);\n\n  const loadPreset = useCallback((presetName: string, blendTime = 2.0) => {\n    const presets = butterchurnPresets.getPresets();\n    if (visualizerRef.current && presets[presetName]) {\n      visualizerRef.current.loadPreset(presets[presetName], blendTime);\n    }\n  }, []);\n\n  return { canvasRef, loadPreset };\n}\n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);