"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[48843],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>t});var r=s(96540);const a={},i=r.createContext(a);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},57379:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"skills/code_necromancer/references/infrastructure-mapping","title":"Infrastructure Mapping","description":"Techniques for discovering cloud resources, services, and deployment topology.","source":"@site/docs/skills/code_necromancer/references/infrastructure-mapping.md","sourceDirName":"skills/code_necromancer/references","slug":"/skills/code_necromancer/references/infrastructure-mapping","permalink":"/docs/skills/code_necromancer/references/infrastructure-mapping","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Infrastructure Mapping","sidebar_label":"Infrastructure Mapping","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Framework Detection Patterns","permalink":"/docs/skills/code_necromancer/references/framework-detection"},"next":{"title":"Integration Test Patterns","permalink":"/docs/skills/code_necromancer/references/integration-test-patterns"}}');var a=s(74848),i=s(28453);const o={title:"Infrastructure Mapping",sidebar_label:"Infrastructure Mapping",sidebar_position:4},t="Infrastructure Mapping",c={},l=[{value:"Cloud Resource Discovery",id:"cloud-resource-discovery",level:2},{value:"AWS",id:"aws",level:3},{value:"GCP",id:"gcp",level:3},{value:"Azure",id:"azure",level:3},{value:"Infrastructure-as-Code Analysis",id:"infrastructure-as-code-analysis",level:2},{value:"Terraform State Parsing",id:"terraform-state-parsing",level:3},{value:"CloudFormation Analysis",id:"cloudformation-analysis",level:3},{value:"Docker Compose Topology",id:"docker-compose-topology",level:2},{value:"Generate Mermaid from Docker Compose",id:"generate-mermaid-from-docker-compose",level:3},{value:"Network Topology Discovery",id:"network-topology-discovery",level:2},{value:"From Code",id:"from-code",level:3},{value:"From Configuration",id:"from-configuration",level:3},{value:"Service Dependency Map Template",id:"service-dependency-map-template",level:2},{value:"Resource Inventory Template",id:"resource-inventory-template",level:2},{value:"Health Check Discovery",id:"health-check-discovery",level:2},{value:"Cost Analysis",id:"cost-analysis",level:2},{value:"Quick AWS Cost Check",id:"quick-aws-cost-check",level:3},{value:"Resource Tagging Audit",id:"resource-tagging-audit",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"infrastructure-mapping",children:"Infrastructure Mapping"})}),"\n",(0,a.jsx)(n.p,{children:"Techniques for discovering cloud resources, services, and deployment topology."}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"cloud-resource-discovery",children:"Cloud Resource Discovery"}),"\n",(0,a.jsx)(n.h3,{id:"aws",children:"AWS"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# List all resources (requires AWS CLI + credentials)\naws resourcegroupstaggingapi get-resources --output json > aws-resources.json\n\n# Common services audit\naws ec2 describe-instances --query 'Reservations[*].Instances[*].[InstanceId,State.Name,Tags]'\naws rds describe-db-instances --query 'DBInstances[*].[DBInstanceIdentifier,Engine,DBInstanceStatus]'\naws s3 ls\naws lambda list-functions --query 'Functions[*].[FunctionName,Runtime,LastModified]'\naws ecs list-clusters\naws eks list-clusters\n\n# IAM users/roles (security audit)\naws iam list-users\naws iam list-roles --query 'Roles[*].RoleName'\n"})}),"\n",(0,a.jsx)(n.h3,{id:"gcp",children:"GCP"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# List all projects\ngcloud projects list\n\n# Compute resources\ngcloud compute instances list\ngcloud container clusters list\ngcloud run services list\ngcloud functions list\n\n# Storage\ngcloud storage ls\n\n# SQL\ngcloud sql instances list\n"})}),"\n",(0,a.jsx)(n.h3,{id:"azure",children:"Azure"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# List all resources\naz resource list --output table\n\n# Specific services\naz vm list\naz webapp list\naz sql server list\naz storage account list\naz aks list\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"infrastructure-as-code-analysis",children:"Infrastructure-as-Code Analysis"}),"\n",(0,a.jsx)(n.h3,{id:"terraform-state-parsing",children:"Terraform State Parsing"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# List all resources in state\nterraform state list\n\n# Show specific resource\nterraform state show aws_instance.web\n\n# Export as JSON\nterraform show -json > tf-state.json\n\n# Parse for dependencies\njq '.values.root_module.resources[] | {type: .type, name: .name}' tf-state.json\n"})}),"\n",(0,a.jsx)(n.h3,{id:"cloudformation-analysis",children:"CloudFormation Analysis"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# List stacks\naws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE UPDATE_COMPLETE\n\n# Get stack resources\naws cloudformation list-stack-resources --stack-name MyStack\n\n# Export template\naws cloudformation get-template --stack-name MyStack > template.json\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"docker-compose-topology",children:"Docker Compose Topology"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"# Example docker-compose.yml analysis\n# Services = boxes, depends_on = arrows\n\n# Extract service map:\nservices:\n  api:\n    depends_on: [db, redis]\n  worker:\n    depends_on: [db, redis, rabbitmq]\n  web:\n    depends_on: [api]\n"})}),"\n",(0,a.jsx)(n.h3,{id:"generate-mermaid-from-docker-compose",children:"Generate Mermaid from Docker Compose"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import yaml\n\ndef compose_to_mermaid(compose_file):\n    with open(compose_file) as f:\n        data = yaml.safe_load(f)\n\n    lines = ['graph TD']\n    services = data.get('services', {})\n\n    for name, config in services.items():\n        deps = config.get('depends_on', [])\n        if isinstance(deps, dict):\n            deps = list(deps.keys())\n\n        for dep in deps:\n            lines.append(f'  {name}--\x3e{dep}')\n\n    return '\\n'.join(lines)\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"network-topology-discovery",children:"Network Topology Discovery"}),"\n",(0,a.jsx)(n.h3,{id:"from-code",children:"From Code"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Find hardcoded URLs/IPs\ngrep -rn \'http://\\|https://\\|localhost\\|127\\.0\\.0\\.1\' --include="*.js" --include="*.py"\n\n# Find port references\ngrep -rn \':[0-9]\\{4,5\\}\' --include="*.js" --include="*.py" --include="*.yml"\n\n# DNS references\ngrep -rn \'\\.com\\|\\.io\\|\\.internal\' --include="*.js" --include="*.py" --include="*.env*"\n'})}),"\n",(0,a.jsx)(n.h3,{id:"from-configuration",children:"From Configuration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Docker Compose ports\ngrep -A5 'ports:' docker-compose.yml\n\n# Kubernetes services\ngrep -A10 'kind: Service' k8s/*.yml\n\n# Environment files\ngrep -i 'HOST\\|URL\\|ENDPOINT' .env.example\n"})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"service-dependency-map-template",children:"Service Dependency Map Template"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-mermaid",children:'graph TB\n    subgraph "External"\n        EXT_API[Third-party API]\n        EXT_AUTH[Auth Provider]\n        CDN[CDN]\n    end\n\n    subgraph "Frontend"\n        WEB[Web App]\n        MOBILE[Mobile App]\n    end\n\n    subgraph "Backend"\n        API[API Gateway]\n        AUTH[Auth Service]\n        CORE[Core Service]\n        WORKER[Background Worker]\n    end\n\n    subgraph "Data"\n        PG[(PostgreSQL)]\n        REDIS[(Redis)]\n        S3[(S3)]\n        MQ[Message Queue]\n    end\n\n    WEB --\x3e CDN\n    WEB --\x3e API\n    MOBILE --\x3e API\n\n    API --\x3e AUTH\n    API --\x3e CORE\n    AUTH --\x3e PG\n    AUTH --\x3e REDIS\n    AUTH --\x3e EXT_AUTH\n\n    CORE --\x3e PG\n    CORE --\x3e REDIS\n    CORE --\x3e S3\n    CORE --\x3e MQ\n    CORE --\x3e EXT_API\n\n    MQ --\x3e WORKER\n    WORKER --\x3e PG\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"resource-inventory-template",children:"Resource Inventory Template"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "metadata": {\n    "project": "legacy-app",\n    "discovered": "2024-01-15",\n    "clouds": ["aws"]\n  },\n  "compute": [\n    {\n      "type": "ec2",\n      "id": "i-0abc123",\n      "name": "api-server",\n      "state": "running",\n      "size": "t3.medium",\n      "region": "us-east-1"\n    }\n  ],\n  "databases": [\n    {\n      "type": "rds",\n      "engine": "postgres",\n      "id": "prod-db",\n      "size": "db.t3.medium",\n      "storage_gb": 100\n    }\n  ],\n  "storage": [\n    {\n      "type": "s3",\n      "name": "app-uploads",\n      "region": "us-east-1",\n      "public": false\n    }\n  ],\n  "networking": {\n    "vpc_id": "vpc-abc123",\n    "load_balancers": ["app-lb"],\n    "dns": ["api.example.com"]\n  },\n  "secrets": {\n    "manager": "aws-secrets-manager",\n    "keys": ["db-password", "api-key-stripe"]\n  },\n  "estimated_monthly_cost": "$250"\n}\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"health-check-discovery",children:"Health Check Discovery"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Find health endpoints in code\ngrep -rn \'health\\|ready\\|alive\' --include="*.js" --include="*.py" --include="*.yml"\n\n# Common patterns\n/health\n/healthz\n/ready\n/readiness\n/liveness\n/api/health\n/api/v1/health\n\n# Kubernetes probes\ngrep -A5 \'livenessProbe\\|readinessProbe\' k8s/*.yml\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"cost-analysis",children:"Cost Analysis"}),"\n",(0,a.jsx)(n.h3,{id:"quick-aws-cost-check",children:"Quick AWS Cost Check"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Get last month's cost by service\naws ce get-cost-and-usage \\\n  --time-period Start=2024-01-01,End=2024-01-31 \\\n  --granularity MONTHLY \\\n  --metrics UnblendedCost \\\n  --group-by Type=DIMENSION,Key=SERVICE \\\n  --query 'ResultsByTime[0].Groups[*].[Keys[0],Metrics.UnblendedCost.Amount]' \\\n  --output table\n"})}),"\n",(0,a.jsx)(n.h3,{id:"resource-tagging-audit",children:"Resource Tagging Audit"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Find untagged resources\naws resourcegroupstaggingapi get-resources \\\n  --query 'ResourceTagMappingList[?length(Tags)==`0`].ResourceARN'\n"})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);