"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[76310],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var s=i(96540);const t={},c=s.createContext(t);function a(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(c.Provider,{value:n},e.children)}},61360:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"skills/hipaa_compliance/index","title":"\u2705 Hipaa Compliance","description":"Ensure HIPAA compliance when handling PHI (Protected Health Information). Use when writing code that accesses user health data, check-ins, journal entries, or any sensitive information. Activates for audit logging, data access, security events, and compliance questions.","source":"@site/docs/skills/hipaa_compliance/index.md","sourceDirName":"skills/hipaa_compliance","slug":"/skills/hipaa_compliance/","permalink":"/docs/skills/hipaa_compliance/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Hipaa Compliance","sidebar_position":1}}');var t=i(74848),c=i(28453);const a={sidebar_label:"Hipaa Compliance",sidebar_position:1},l="\u2705 Hipaa Compliance",r={},d=[{value:"Allowed Tools",id:"allowed-tools",level:2},{value:"Tags",id:"tags",level:2},{value:"What is PHI in This Application?",id:"what-is-phi-in-this-application",level:2},{value:"Audit Logging Requirements",id:"audit-logging-requirements",level:2},{value:"When to Log",id:"when-to-log",level:3},{value:"How to Log",id:"how-to-log",level:3},{value:"Data Sanitization",id:"data-sanitization",level:2},{value:"Never Log These Fields",id:"never-log-these-fields",level:3},{value:"Sanitized Fields (Auto-Redacted)",id:"sanitized-fields-auto-redacted",level:3},{value:"Session Security Requirements",id:"session-security-requirements",level:2},{value:"Code Patterns",id:"code-patterns",level:2},{value:"API Route with Audit Logging",id:"api-route-with-audit-logging",level:3},{value:"Component with PHI Access",id:"component-with-phi-access",level:3},{value:"Compliance Checklist",id:"compliance-checklist",level:2},{value:"Audit Log Retention",id:"audit-log-retention",level:2},{value:"Emergency Access (Break Glass)",id:"emergency-access-break-glass",level:2},{value:"Resources",id:"resources",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"-hipaa-compliance",children:"\u2705 Hipaa Compliance"})}),"\n",(0,t.jsx)(n.p,{children:"Ensure HIPAA compliance when handling PHI (Protected Health Information). Use when writing code that accesses user health data, check-ins, journal entries, or any sensitive information. Activates for audit logging, data access, security events, and compliance questions."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"allowed-tools",children:"Allowed Tools"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Read, Write, Edit\n"})}),"\n",(0,t.jsx)(n.h2,{id:"tags",children:"Tags"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"hipaa"})," ",(0,t.jsx)(n.code,{children:"compliance"})," ",(0,t.jsx)(n.code,{children:"security"})]}),"\n",(0,t.jsx)(n.h1,{id:"hipaa-compliance-for-recovery-coach",children:"HIPAA Compliance for Recovery Coach"}),"\n",(0,t.jsx)(n.p,{children:"This skill helps you maintain HIPAA compliance when developing features that handle Protected Health Information (PHI)."}),"\n",(0,t.jsx)(n.h2,{id:"what-is-phi-in-this-application",children:"What is PHI in This Application?"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Data Type"}),(0,t.jsx)(n.th,{children:"PHI Status"}),(0,t.jsx)(n.th,{children:"Handling"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Check-in mood/cravings"}),(0,t.jsx)(n.td,{children:"PHI"}),(0,t.jsx)(n.td,{children:"Audit all access"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Journal entries"}),(0,t.jsx)(n.td,{children:"PHI"}),(0,t.jsx)(n.td,{children:"Audit all access"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Chat conversations"}),(0,t.jsx)(n.td,{children:"PHI"}),(0,t.jsx)(n.td,{children:"Audit all access"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"User profile (name, email)"}),(0,t.jsx)(n.td,{children:"PHI"}),(0,t.jsx)(n.td,{children:"Audit modifications"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Sobriety date"}),(0,t.jsx)(n.td,{children:"PHI"}),(0,t.jsx)(n.td,{children:"Audit access"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Emergency contacts"}),(0,t.jsx)(n.td,{children:"PHI"}),(0,t.jsx)(n.td,{children:"Audit access"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Usage analytics (aggregated)"}),(0,t.jsx)(n.td,{children:"NOT PHI"}),(0,t.jsx)(n.td,{children:"No audit needed"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Page views (no content)"}),(0,t.jsx)(n.td,{children:"NOT PHI"}),(0,t.jsx)(n.td,{children:"No audit needed"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"audit-logging-requirements",children:"Audit Logging Requirements"}),"\n",(0,t.jsx)(n.h3,{id:"when-to-log",children:"When to Log"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Always log these operations:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Viewing any PHI (check-ins, journal, messages)"}),"\n",(0,t.jsx)(n.li,{children:"Creating/updating/deleting PHI"}),"\n",(0,t.jsx)(n.li,{children:"Exporting user data"}),"\n",(0,t.jsx)(n.li,{children:"Admin access to user information"}),"\n",(0,t.jsx)(n.li,{children:"Failed authentication attempts"}),"\n",(0,t.jsx)(n.li,{children:"Security events (rate limiting, unauthorized access)"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"how-to-log",children:"How to Log"}),"\n",(0,t.jsxs)(n.p,{children:["Use the audit logging utilities in ",(0,t.jsx)(n.code,{children:"src/lib/hipaa/audit.ts"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import {\n  logPHIAccess,\n  logPHIModification,\n  logSecurityEvent,\n  logAdminAction\n} from '@/lib/hipaa/audit';\n\n// Viewing PHI\nawait logPHIAccess(\n  userId,\n  'checkin',        // targetType\n  checkinId,        // targetId\n  AuditAction.PHI_VIEW\n);\n\n// Modifying PHI\nawait logPHIModification(\n  userId,\n  'journal',\n  journalId,\n  AuditAction.PHI_UPDATE,\n  { field: 'content' }  // Never include actual content!\n);\n\n// Security event\nawait logSecurityEvent(\n  userId,\n  AuditAction.RATE_LIMIT,\n  { path: '/api/chat', attempts: 60 }\n);\n\n// Admin action\nawait logAdminAction(\n  adminId,\n  AuditAction.ADMIN_USER_VIEW,\n  'user',\n  targetUserId\n);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"data-sanitization",children:"Data Sanitization"}),"\n",(0,t.jsx)(n.h3,{id:"never-log-these-fields",children:"Never Log These Fields"}),"\n",(0,t.jsx)(n.p,{children:"The audit system automatically sanitizes, but be explicit:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"// BAD - Contains PHI\nawait logPHIAccess(userId, 'journal', id, action, {\n  content: journalEntry.content  // NEVER DO THIS\n});\n\n// GOOD - Only metadata\nawait logPHIAccess(userId, 'journal', id, action, {\n  wordCount: journalEntry.content.length,\n  hasAttachments: false\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"sanitized-fields-auto-redacted",children:"Sanitized Fields (Auto-Redacted)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"password"}),", ",(0,t.jsx)(n.code,{children:"token"}),", ",(0,t.jsx)(n.code,{children:"secret"}),", ",(0,t.jsx)(n.code,{children:"key"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"authorization"}),", ",(0,t.jsx)(n.code,{children:"cookie"}),", ",(0,t.jsx)(n.code,{children:"session"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"credential"}),", ",(0,t.jsx)(n.code,{children:"content"}),", ",(0,t.jsx)(n.code,{children:"message"}),", ",(0,t.jsx)(n.code,{children:"notes"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"session-security-requirements",children:"Session Security Requirements"}),"\n",(0,t.jsxs)(n.p,{children:["From ",(0,t.jsx)(n.code,{children:"src/lib/auth.ts"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Session timeout"}),": 15 minutes of inactivity (HIPAA requirement)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Max session"}),": 8 hours absolute maximum"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Failed login lockout"}),": 5 attempts = 30 minute ban"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Password requirements"}),": 12+ chars, mixed case, numbers, special chars"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"code-patterns",children:"Code Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"api-route-with-audit-logging",children:"API Route with Audit Logging"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { getSession, requireAuth } from '@/lib/auth';\nimport { logPHIAccess } from '@/lib/hipaa/audit';\n\nexport async function GET(request: Request) {\n  const session = await getSession();\n  if (!session) {\n    return Response.json({ error: 'Unauthorized' }, { status: 401 });\n  }\n\n  // Fetch the data\n  const data = await fetchUserData(session.userId);\n\n  // Log the access\n  await logPHIAccess(\n    session.userId,\n    'userdata',\n    session.userId,\n    AuditAction.PHI_VIEW\n  );\n\n  return Response.json(data);\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"component-with-phi-access",children:"Component with PHI Access"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"'use client';\n\nimport { useEffect } from 'react';\n\nexport function JournalViewer({ entryId }: { entryId: string }) {\n  useEffect(() => {\n    // Log view on mount (server-side preferred, but client backup)\n    fetch('/api/audit/log', {\n      method: 'POST',\n      body: JSON.stringify({\n        action: 'PHI_VIEW',\n        targetType: 'journal',\n        targetId: entryId\n      })\n    });\n  }, [entryId]);\n\n  // ... render\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"compliance-checklist",children:"Compliance Checklist"}),"\n",(0,t.jsx)(n.p,{children:"Before shipping any feature that touches PHI:"}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","All PHI access is audit logged"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","No PHI content in logs (only IDs and metadata)"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Data access requires authentication"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Admin access has separate audit trail"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Failed access attempts are logged"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Data export includes audit entry"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Sensitive fields are encrypted at rest"]}),"\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Session timeout is enforced"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"audit-log-retention",children:"Audit Log Retention"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Minimum"}),": 6 years (HIPAA requirement)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Format"}),": Raw logs for 1 year, compressed thereafter"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Location"}),": ",(0,t.jsx)(n.code,{children:"audit_log"})," table in database"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Export"}),": Encrypted exports for compliance audits"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"emergency-access-break-glass",children:"Emergency Access (Break Glass)"}),"\n",(0,t.jsx)(n.p,{children:"For emergency situations, use break-glass access:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"import { requestBreakGlassAccess } from '@/lib/hipaa/break-glass';\n\n// This creates enhanced audit trail\nconst access = await requestBreakGlassAccess(\n  adminId,\n  targetUserId,\n  'Emergency support required - user reported crisis'\n);\n"})}),"\n",(0,t.jsx)(n.p,{children:"Break glass access:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Requires written justification"}),"\n",(0,t.jsx)(n.li,{children:"Creates permanent audit record"}),"\n",(0,t.jsx)(n.li,{children:"Triggers alert to compliance officer"}),"\n",(0,t.jsx)(n.li,{children:"Must be reviewed within 24 hours"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"HIPAA Security Rule: 45 C.F.R. \xa7 164.312"}),"\n",(0,t.jsx)(n.li,{children:"Audit controls standard: 45 C.F.R. \xa7 164.312(b)"}),"\n",(0,t.jsxs)(n.li,{children:["Incident response plan: ",(0,t.jsx)(n.code,{children:"docs/INCIDENT-RESPONSE-PLAN.md"})]}),"\n",(0,t.jsxs)(n.li,{children:["Security documentation: ",(0,t.jsx)(n.code,{children:"docs/SECURITY-HARDENING.md"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}}}]);