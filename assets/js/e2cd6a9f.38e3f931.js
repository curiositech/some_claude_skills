"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[63425],{7267:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"skills/chatbot_analytics/index","title":"\ud83d\udcca Chatbot Analytics","description":"Implement AI chatbot analytics and conversation monitoring. Use when adding conversation metrics, tracking AI usage, measuring user engagement with chat, or building conversation dashboards. Activates for AI analytics, token tracking, conversation categorization, and chat performance.","source":"@site/docs/skills/chatbot_analytics/index.md","sourceDirName":"skills/chatbot_analytics","slug":"/skills/chatbot_analytics/","permalink":"/docs/skills/chatbot_analytics/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Chatbot Analytics","sidebar_position":1}}');var a=t(74848),i=t(28453);const r={sidebar_label:"Chatbot Analytics",sidebar_position:1},o="\ud83d\udcca Chatbot Analytics",c={},l=[{value:"Allowed Tools",id:"allowed-tools",level:2},{value:"Tags",id:"tags",level:2},{value:"Core Metrics to Track",id:"core-metrics-to-track",level:2},{value:"HIPAA-Compliant Analytics",id:"hipaa-compliant-analytics",level:2},{value:"What to Track",id:"what-to-track",level:3},{value:"What NOT to Track",id:"what-not-to-track",level:3},{value:"Implementation Pattern",id:"implementation-pattern",level:2},{value:"Tracking Conversation Start",id:"tracking-conversation-start",level:3},{value:"Tracking Message Exchange",id:"tracking-message-exchange",level:3},{value:"Tracking Conversation End",id:"tracking-conversation-end",level:3},{value:"Category Detection (Metadata-Based)",id:"category-detection-metadata-based",level:2},{value:"Dashboard Aggregations",id:"dashboard-aggregations",level:2},{value:"Session Metrics",id:"session-metrics",level:3},{value:"Token Usage for Cost Tracking",id:"token-usage-for-cost-tracking",level:3},{value:"Category Breakdown",id:"category-breakdown",level:3},{value:"Alert Configuration",id:"alert-configuration",level:2},{value:"Database Schema",id:"database-schema",level:2},{value:"Testing Analytics",id:"testing-analytics",level:2},{value:"Resources",id:"resources",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"-chatbot-analytics",children:"\ud83d\udcca Chatbot Analytics"})}),"\n",(0,a.jsx)(e.p,{children:"Implement AI chatbot analytics and conversation monitoring. Use when adding conversation metrics, tracking AI usage, measuring user engagement with chat, or building conversation dashboards. Activates for AI analytics, token tracking, conversation categorization, and chat performance."}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"allowed-tools",children:"Allowed Tools"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"Read, Write, Edit, Bash(npm:*, npx:*)\n"})}),"\n",(0,a.jsx)(e.h2,{id:"tags",children:"Tags"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"analytics"})," ",(0,a.jsx)(e.code,{children:"chatbot"})," ",(0,a.jsx)(e.code,{children:"ai-metrics"})]}),"\n",(0,a.jsx)(e.h1,{id:"ai-chatbot-analytics",children:"AI Chatbot Analytics"}),"\n",(0,a.jsx)(e.p,{children:"This skill helps you implement analytics for the AI coaching chat feature while maintaining HIPAA compliance."}),"\n",(0,a.jsx)(e.h2,{id:"core-metrics-to-track",children:"Core Metrics to Track"}),"\n",(0,a.jsxs)(e.p,{children:["Based on ",(0,a.jsx)(e.a,{href:"https://hiverhq.com/blog/chatbot-analytics",children:"industry best practices"}),", track these 13 key metrics:"]}),"\n",(0,a.jsxs)(e.table,{children:[(0,a.jsx)(e.thead,{children:(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.th,{children:"Metric"}),(0,a.jsx)(e.th,{children:"Description"}),(0,a.jsx)(e.th,{children:"HIPAA Safe?"})]})}),(0,a.jsxs)(e.tbody,{children:[(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Total Sessions"}),(0,a.jsx)(e.td,{children:"Number of chat sessions"}),(0,a.jsx)(e.td,{children:"Yes"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Avg Messages/Session"}),(0,a.jsx)(e.td,{children:"Messages per conversation"}),(0,a.jsx)(e.td,{children:"Yes"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Avg Session Duration"}),(0,a.jsx)(e.td,{children:"Time spent in chat"}),(0,a.jsx)(e.td,{children:"Yes"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Engagement Rate"}),(0,a.jsx)(e.td,{children:"% users who use chat"}),(0,a.jsx)(e.td,{children:"Yes"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Completion Rate"}),(0,a.jsx)(e.td,{children:"Sessions ended naturally"}),(0,a.jsx)(e.td,{children:"Yes"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Abandonment Rate"}),(0,a.jsx)(e.td,{children:"Sessions ended early"}),(0,a.jsx)(e.td,{children:"Yes"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Response Time"}),(0,a.jsx)(e.td,{children:"AI response latency"}),(0,a.jsx)(e.td,{children:"Yes"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Token Usage"}),(0,a.jsx)(e.td,{children:"Total/avg tokens consumed"}),(0,a.jsx)(e.td,{children:"Yes"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Error Rate"}),(0,a.jsx)(e.td,{children:"Failed responses"}),(0,a.jsx)(e.td,{children:"Yes"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Fallback Rate"}),(0,a.jsx)(e.td,{children:'"I don\'t understand" responses'}),(0,a.jsx)(e.td,{children:"Yes"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Topic Categories"}),(0,a.jsx)(e.td,{children:"What users discuss"}),(0,a.jsx)(e.td,{children:"Metadata only"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Sentiment Trend"}),(0,a.jsx)(e.td,{children:"Emotional direction"}),(0,a.jsx)(e.td,{children:"Derived only"})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:"Crisis Triggers"}),(0,a.jsx)(e.td,{children:"Emergency detection"}),(0,a.jsx)(e.td,{children:"Metadata only"})]})]})]}),"\n",(0,a.jsx)(e.h2,{id:"hipaa-compliant-analytics",children:"HIPAA-Compliant Analytics"}),"\n",(0,a.jsx)(e.h3,{id:"what-to-track",children:"What to Track"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"// Conversation metadata (SAFE)\ninterface ConversationAnalytics {\n  id: string;\n  conversationId: string;\n  userId: string;  // For aggregation, not individual tracking\n  startedAt: Date;\n  endedAt: Date | null;\n  messageCount: number;\n  userMessageCount: number;\n  aiMessageCount: number;\n  totalTokens: number;\n  inputTokens: number;\n  outputTokens: number;\n  category: string;  // Derived from metadata flags\n  outcome: 'completed' | 'abandoned' | 'error' | 'crisis_escalated';\n  avgResponseTime: number;\n  hadFallback: boolean;\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"what-not-to-track",children:"What NOT to Track"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"// NEVER store these in analytics\ninterface PROHIBITED {\n  messageContent: string;      // PHI\n  userQuery: string;           // PHI\n  aiResponse: string;          // PHI\n  specificTopics: string[];    // Could reveal health info\n  exactSentiment: 'sad';       // Could reveal mental state\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"implementation-pattern",children:"Implementation Pattern"}),"\n",(0,a.jsx)(e.h3,{id:"tracking-conversation-start",children:"Tracking Conversation Start"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"// src/lib/ai/analytics.ts\nexport async function trackConversationStart(\n  conversationId: string,\n  userId: string\n): Promise<void> {\n  await db.insert(conversationAnalytics).values({\n    id: generateId(),\n    conversationId,\n    userId,\n    startedAt: new Date(),\n    messageCount: 0,\n    totalTokens: 0,\n    category: 'unknown',\n    outcome: 'in_progress'\n  });\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"tracking-message-exchange",children:"Tracking Message Exchange"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"export async function trackMessageExchange(\n  conversationId: string,\n  tokens: { input: number; output: number },\n  responseTimeMs: number,\n  flags: { hadFallback: boolean; hasCrisisIndicator: boolean }\n): Promise<void> {\n  await db\n    .update(conversationAnalytics)\n    .set({\n      messageCount: sql`message_count + 1`,\n      totalTokens: sql`total_tokens + ${tokens.input + tokens.output}`,\n      inputTokens: sql`input_tokens + ${tokens.input}`,\n      outputTokens: sql`output_tokens + ${tokens.output}`,\n      avgResponseTime: sql`(avg_response_time * (message_count - 1) + ${responseTimeMs}) / message_count`,\n      hadFallback: flags.hadFallback,\n      ...(flags.hasCrisisIndicator && { outcome: 'crisis_escalated' })\n    })\n    .where(eq(conversationAnalytics.conversationId, conversationId));\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"tracking-conversation-end",children:"Tracking Conversation End"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"export async function trackConversationEnd(\n  conversationId: string,\n  outcome: 'completed' | 'abandoned' | 'error'\n): Promise<void> {\n  await db\n    .update(conversationAnalytics)\n    .set({\n      endedAt: new Date(),\n      outcome\n    })\n    .where(eq(conversationAnalytics.conversationId, conversationId));\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"category-detection-metadata-based",children:"Category Detection (Metadata-Based)"}),"\n",(0,a.jsx)(e.p,{children:"Detect conversation categories WITHOUT reading content:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"// Categories based on metadata flags from AI response\ninterface AIResponseMetadata {\n  usedCopingStrategies: boolean;\n  usedCrisisProtocol: boolean;\n  usedCheckInSupport: boolean;\n  usedGeneralChat: boolean;\n  requestedClarification: boolean;\n}\n\nfunction deriveCategory(metadata: AIResponseMetadata): string {\n  if (metadata.usedCrisisProtocol) return 'crisis_support';\n  if (metadata.usedCopingStrategies) return 'coping_strategies';\n  if (metadata.usedCheckInSupport) return 'checkin_support';\n  if (metadata.requestedClarification) return 'clarification';\n  return 'general_chat';\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"dashboard-aggregations",children:"Dashboard Aggregations"}),"\n",(0,a.jsx)(e.h3,{id:"session-metrics",children:"Session Metrics"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"// Get aggregated session stats (HIPAA safe - no individual data)\nasync function getSessionStats(days: number = 30) {\n  const since = subDays(new Date(), days);\n\n  return db\n    .select({\n      totalSessions: count(),\n      avgMessages: avg(conversationAnalytics.messageCount),\n      avgDuration: avg(\n        sql`JULIANDAY(ended_at) - JULIANDAY(started_at)) * 24 * 60`\n      ),\n      completionRate: sql`\n        CAST(SUM(CASE WHEN outcome = 'completed' THEN 1 ELSE 0 END) AS FLOAT) /\n        CAST(COUNT(*) AS FLOAT)\n      `,\n      crisisEscalations: sql`\n        SUM(CASE WHEN outcome = 'crisis_escalated' THEN 1 ELSE 0 END)\n      `\n    })\n    .from(conversationAnalytics)\n    .where(gte(conversationAnalytics.startedAt, since));\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"token-usage-for-cost-tracking",children:"Token Usage for Cost Tracking"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"async function getTokenUsage(days: number = 30) {\n  const since = subDays(new Date(), days);\n\n  const result = await db\n    .select({\n      totalTokens: sum(conversationAnalytics.totalTokens),\n      inputTokens: sum(conversationAnalytics.inputTokens),\n      outputTokens: sum(conversationAnalytics.outputTokens),\n      avgTokensPerSession: avg(conversationAnalytics.totalTokens)\n    })\n    .from(conversationAnalytics)\n    .where(gte(conversationAnalytics.startedAt, since));\n\n  // Estimate cost (Claude pricing)\n  const inputCost = (result.inputTokens / 1_000_000) * 3.00;  // $3/M input\n  const outputCost = (result.outputTokens / 1_000_000) * 15.00; // $15/M output\n\n  return {\n    ...result,\n    estimatedCost: inputCost + outputCost\n  };\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"category-breakdown",children:"Category Breakdown"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"async function getCategoryBreakdown(days: number = 30) {\n  const since = subDays(new Date(), days);\n\n  return db\n    .select({\n      category: conversationAnalytics.category,\n      count: count(),\n      percentage: sql`\n        CAST(COUNT(*) AS FLOAT) * 100.0 /\n        (SELECT COUNT(*) FROM conversation_analytics WHERE started_at >= ${since})\n      `\n    })\n    .from(conversationAnalytics)\n    .where(gte(conversationAnalytics.startedAt, since))\n    .groupBy(conversationAnalytics.category)\n    .orderBy(desc(count()));\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"alert-configuration",children:"Alert Configuration"}),"\n",(0,a.jsx)(e.p,{children:"Set up alerts for concerning patterns:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"interface AnalyticsAlert {\n  type: 'crisis_spike' | 'error_spike' | 'abandonment_spike';\n  threshold: number;\n  windowHours: number;\n  action: 'log' | 'email' | 'slack';\n}\n\nconst alerts: AnalyticsAlert[] = [\n  {\n    type: 'crisis_spike',\n    threshold: 5,  // 5+ crisis escalations\n    windowHours: 24,\n    action: 'email'\n  },\n  {\n    type: 'error_spike',\n    threshold: 10, // 10+ errors\n    windowHours: 1,\n    action: 'slack'\n  },\n  {\n    type: 'abandonment_spike',\n    threshold: 0.5, // 50%+ abandonment rate\n    windowHours: 24,\n    action: 'log'\n  }\n];\n"})}),"\n",(0,a.jsx)(e.h2,{id:"database-schema",children:"Database Schema"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sql",children:"CREATE TABLE conversation_analytics (\n  id TEXT PRIMARY KEY,\n  conversation_id TEXT NOT NULL,\n  user_id TEXT NOT NULL,\n  started_at TEXT NOT NULL,\n  ended_at TEXT,\n  message_count INTEGER DEFAULT 0,\n  user_message_count INTEGER DEFAULT 0,\n  ai_message_count INTEGER DEFAULT 0,\n  total_tokens INTEGER DEFAULT 0,\n  input_tokens INTEGER DEFAULT 0,\n  output_tokens INTEGER DEFAULT 0,\n  category TEXT DEFAULT 'unknown',\n  outcome TEXT DEFAULT 'in_progress',\n  avg_response_time REAL DEFAULT 0,\n  had_fallback INTEGER DEFAULT 0,\n\n  FOREIGN KEY (conversation_id) REFERENCES conversations(id),\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n\nCREATE INDEX idx_conv_analytics_started ON conversation_analytics(started_at);\nCREATE INDEX idx_conv_analytics_user ON conversation_analytics(user_id);\nCREATE INDEX idx_conv_analytics_outcome ON conversation_analytics(outcome);\n"})}),"\n",(0,a.jsx)(e.h2,{id:"testing-analytics",children:"Testing Analytics"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"describe('Conversation Analytics', () => {\n  it('tracks session without PHI', async () => {\n    const analytics = await trackConversationStart('conv-123', 'user-456');\n\n    // Verify no PHI is stored\n    expect(analytics).not.toHaveProperty('messageContent');\n    expect(analytics).not.toHaveProperty('userQuery');\n\n    // Verify metadata is stored\n    expect(analytics.conversationId).toBe('conv-123');\n    expect(analytics.messageCount).toBe(0);\n  });\n\n  it('calculates aggregates correctly', async () => {\n    const stats = await getSessionStats(30);\n\n    expect(stats.totalSessions).toBeGreaterThanOrEqual(0);\n    expect(stats.completionRate).toBeBetween(0, 1);\n  });\n});\n"})}),"\n",(0,a.jsx)(e.h2,{id:"resources",children:"Resources"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:"https://hiverhq.com/blog/chatbot-analytics",children:"Chatbot Analytics Guide"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:"https://botpress.com/blog/chatbot-analytics",children:"Botpress Analytics"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:"https://www.tidio.com/blog/chatbot-analytics/",children:"13 Core Metrics"})}),"\n",(0,a.jsxs)(e.li,{children:["Admin Suite Design: ",(0,a.jsx)(e.code,{children:"docs/ADMIN-DEVELOPER-SUITE.md"})]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>o});var s=t(96540);const a={},i=s.createContext(a);function r(n){const e=s.useContext(i);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:r(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);